<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>web-CTFshow</title>
    <url>/2023/12/04/web-CTFshow/</url>
    <content><![CDATA[<p>è®°è½½CTFshowä¸Šçš„webé¢˜ç›®(å°‘æ•°èƒ½å¤ç° å¤§å¤šéƒ½åªèƒ½çœ‹WP&#x2F;è§†é¢‘ æ¥ç§¯ç´¯æ€è·¯)</p>
<span id="more"></span>

<h1 id="ä¿¡æ¯æœé›†æ¨¡å—"><a href="#ä¿¡æ¯æœé›†æ¨¡å—" class="headerlink" title="ä¿¡æ¯æœé›†æ¨¡å—"></a>ä¿¡æ¯æœé›†æ¨¡å—</h1><p>VIPé¢˜ç›®é™å…å‘~</p>
<h2 id="web1-æºç æ³„éœ²"><a href="#web1-æºç æ³„éœ²" class="headerlink" title="web1 æºç æ³„éœ²"></a>web1 æºç æ³„éœ²</h2><p>bpæŠ“åŒ…å¯ä»¥ç›´æ¥åœ¨responseçš„æºç çœ‹åˆ°flag</p>
<h2 id="web2-å‰å°JSç»•è¿‡"><a href="#web2-å‰å°JSç»•è¿‡" class="headerlink" title="web2 å‰å°JSç»•è¿‡"></a>web2 å‰å°JSç»•è¿‡</h2><p>az ç›´æ¥ctrl+uå°±çœ‹åˆ°flagäº†<br>æŸ¥çœ‹æºç å‘ç°ç¡®å®å°±æ˜¯jså‰ç«¯ä½œäº†å…¨éƒ¨return falseçš„å¤„ç† ä½†ä¸æ¯«ä¸å½±å“ ç¦ç”¨jsç­‰æ“ä½œéƒ½å¯ä»¥ç»•è¿‡</p>
<h2 id="web3-åè®®å¤´ä¿¡æ¯æ³„éœ²"><a href="#web3-åè®®å¤´ä¿¡æ¯æ³„éœ²" class="headerlink" title="web3 åè®®å¤´ä¿¡æ¯æ³„éœ²"></a>web3 åè®®å¤´ä¿¡æ¯æ³„éœ²</h2><p>bpæŠ“åŒ… ç„¶ååœ¨responseçœ‹åˆ°Flag:ä¸€æ ä¿¡æ¯å³ä¸ºflag</p>
<h2 id="web4-robotsåå°æ³„éœ²"><a href="#web4-robotsåå°æ³„éœ²" class="headerlink" title="web4 robotsåå°æ³„éœ²"></a>web4 robotsåå°æ³„éœ²</h2><p>ä¸€äº›å¸¸è§çš„å¤‡ä»½æ–‡ä»¶(ä»…é™äºæ‡’å¾—ç”¨dirsearchâ€¦)</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.index.php.swp</span><br><span class="line">index.php.swp</span><br><span class="line">index.php.bak</span><br><span class="line">.index.php~</span><br><span class="line">index.php.bak_Edietplus</span><br><span class="line">index.php.~</span><br><span class="line">index.php<span class="number">.1</span></span><br><span class="line">index.php</span><br><span class="line">index.php~</span><br><span class="line">index.php.rar</span><br><span class="line">index.php.zip</span><br><span class="line">index.php<span class="number">.7</span>z</span><br><span class="line">index.php.tar.gz</span><br><span class="line">www.zip</span><br><span class="line">www.rar</span><br><span class="line">www.zip</span><br><span class="line">www<span class="number">.7</span>z</span><br><span class="line">www.tar.gz</span><br><span class="line">www.tar</span><br><span class="line">web.zip</span><br><span class="line">web.rar</span><br><span class="line">web.zip</span><br><span class="line">web<span class="number">.7</span>z</span><br><span class="line">web.tar.gz</span><br><span class="line">web.tar</span><br><span class="line">wwwroot.rar</span><br><span class="line">web.rar</span><br><span class="line">robots.txt</span><br><span class="line">index.phps</span><br></pre></td></tr></table></figure>
<p>ç»“åˆé¢˜ç›®æç¤º è®¿é—® &#x2F;robots.txt å¾—åˆ°flagçš„è·¯å¾„&#x2F;flagishere.txt è®¿é—®å³å¯</p>
<h2 id="web5-phpsæºç æ³„éœ²"><a href="#web5-phpsæºç æ³„éœ²" class="headerlink" title="web5 phpsæºç æ³„éœ²"></a>web5 phpsæºç æ³„éœ²</h2><p>phpsæºç  &#x2F;index.phps<br>å¹³æ—¶ä¸€èˆ¬çŒœ&#x2F;index.php è¿™é‡Œå‘Šè¯‰æˆ‘ä»¬æœ‰æ–°çš„ä¸€ç§.phps<br>è®¿é—®ä¸‹è½½æ–‡ä»¶ é‡Œé¢å³æœ‰flag</p>
<h2 id="web6-æºç å‹ç¼©åŒ…æ³„éœ²"><a href="#web6-æºç å‹ç¼©åŒ…æ³„éœ²" class="headerlink" title="web6 æºç å‹ç¼©åŒ…æ³„éœ²"></a>web6 æºç å‹ç¼©åŒ…æ³„éœ²</h2><p>å¸¸è§çš„ &#x2F;<a href="http://www.zip/">www.zip</a><br>ä¸‹è½½åå¾—åˆ°fl000g.txt<br>çŒœæƒ³è¿™æ˜¯flagè·¯å¾„ è®¿é—® &#x2F;fl000g.txt å¾—åˆ°flag</p>
<h2 id="web7-ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç "><a href="#web7-ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç " class="headerlink" title="web7 ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç "></a>web7 ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç </h2><p>.gitæ³„éœ²(æ‰€ä»¥å¹³æ—¶ç”¨gitè¦å°å¿ƒå•Š!!!)<br>è®¿é—® &#x2F;.git å¾—åˆ°flag</p>
<h2 id="web8-ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2"><a href="#web8-ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2" class="headerlink" title="web8 ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2"></a>web8 ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2</h2><p>åˆå­¦ä¹ åˆ°äº†æ–°å§¿åŠ¿<br>.svnæ³„éœ²<br>è®¿é—® &#x2F;.svn å¾—åˆ°flag<br>æ³¨: SVNæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ(å¯å®ç°å¤šäººååŒå¼€å‘ &amp; â€¦)</p>
<h2 id="web9-vimä¸´æ—¶æ–‡ä»¶æ³„éœ²"><a href="#web9-vimä¸´æ—¶æ–‡ä»¶æ³„éœ²" class="headerlink" title="web9 vimä¸´æ—¶æ–‡ä»¶æ³„éœ²"></a>web9 vimä¸´æ—¶æ–‡ä»¶æ³„éœ²</h2><p>index.php.swp æ³„éœ²<br>vimä¸­çš„swpå³swap äº¤æ¢åˆ†åŒº åœ¨ç¼–è¾‘vimæ—¶ç”¨æ¥å¤‡ä»½ç¼“å†²åŒºå†…å®¹</p>
<h2 id="web10-cookieæ³„éœ²"><a href="#web10-cookieæ³„éœ²" class="headerlink" title="web10 cookieæ³„éœ²"></a>web10 cookieæ³„éœ²</h2><p>bpæŠ“åŒ… åœ¨requestä¸­çš„cookieæ å¾—åˆ°flag(åªæ˜¯ â€˜{â€˜å’Œâ€™}â€™è¢«urlç¼–ç äº†)</p>
<h2 id="web11-åŸŸåtxtè®°å½•æ³„éœ²"><a href="#web11-åŸŸåtxtè®°å½•æ³„éœ²" class="headerlink" title="web11 åŸŸåtxtè®°å½•æ³„éœ²"></a>web11 åŸŸåtxtè®°å½•æ³„éœ²</h2><p>é¢˜ç›®æç¤º: åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚flag.ctfshow.comå°±éšè—äº†ä¸€æ¡ä¿¡æ¯<br>è¿™é‡Œå­¦ä¹ åˆ°åˆ©ç”¨DNSæŸ¥è¯¢<br><a href="http://www.jsons.cn/nslookup/" target="_blank">åœ¨çº¿ç½‘ç«™</a>æŸ¥è¯¢å³å¯å¾—åˆ°flag</p>
<h2 id="web12-æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ"><a href="#web12-æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ" class="headerlink" title="web12 æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ"></a>web12 æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ</h2><p>å“‡ å¾ˆæœ‰è¶£çš„é¢˜~<br>åˆ©ç”¨é¢˜ç›®æç¤º åœ¨ä¸‹é¢heaplineæ‰¾åˆ° 372619038 çŒœæµ‹è¿™æ˜¯å¯†ç <br>ä½†æ˜¯æ‰¾äº†åŠå¤©æ‰¾ä¸åˆ°å“ªé‡Œç”¨å¾—ä¸Š<br>çœ‹æç¤º è¯´è¿”å› &#x2F;admin ! å­¦åˆ°äº† ç„¶åä»¥ admin 372619038 ç™»å½•å³å¯å¾—åˆ°flag~</p>
<h2 id="web13-å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²"><a href="#web13-å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²" class="headerlink" title="web13 å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²"></a>web13 å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²</h2><p>è¿™ å±å®æƒ³ä¸åˆ° orz<br>Homeæœ€ä¸‹é¢ä¼šå‘ç°documentå¯ä»¥ç‚¹ï¼ ç„¶åå°±èƒ½ä¸‹è½½å¾—åˆ°pdfâ€¦<br>é‡Œé¢<del>è´´å¿ƒçš„</del>è®°å½•äº†ç™»å½•è·¯å¾„&#x2F;ç”¨æˆ·å&#x2F;å¯†ç â€¦<br>è·Ÿç€è®¿é—®å³å¯å¾—åˆ°flag</p>
<h2 id="web14-ç¼–è¾‘å™¨é…ç½®ä¸å½“"><a href="#web14-ç¼–è¾‘å™¨é…ç½®ä¸å½“" class="headerlink" title="web14 ç¼–è¾‘å™¨é…ç½®ä¸å½“"></a>web14 ç¼–è¾‘å™¨é…ç½®ä¸å½“</h2><p>az è®¿é—® &#x2F;editor (â€¦)<br>è¿›å…¥é‡Œé¢ æ‰¾åˆ°å›¾ç‰‡ä¸Šä¼  å‘ç°å¯ä»¥è®¿é—®æ–‡ä»¶ç©ºé—´ èƒ½çœ‹åˆ°ç½‘ç«™çš„æ‰€æœ‰ä¿¡æ¯<br>ç„¶ååœ¨ &#x2F;var&#x2F;www&#x2F;nothinghereä¸‹æ‰¾åˆ°flagåœ°å€ è®¿é—®&#x2F;nothinghere&#x2F;flagâ€¦txtå³å¯<br>&#x2F;var&#x2F;wwwä¸‹æ”¾ç½®çš„æ˜¯ç«™ç‚¹é…ç½® æ‰€ä»¥ç”¨åé¢åœ°å€æ‰èƒ½è®¿é—®</p>
<h2 id="web15-å¯†ç é€»è¾‘è„†å¼±"><a href="#web15-å¯†ç é€»è¾‘è„†å¼±" class="headerlink" title="web15 å¯†ç é€»è¾‘è„†å¼±"></a>web15 å¯†ç é€»è¾‘è„†å¼±</h2><p>ç½‘ç«™æœ€ä¸‹é¢æ³„éœ²é‚®ç®±å’¯ <a href="mailto:&#x31;&#x31;&#53;&#54;&#54;&#51;&#49;&#57;&#x36;&#49;&#64;&#x71;&#113;&#46;&#x63;&#111;&#109;">&#x31;&#x31;&#53;&#54;&#54;&#51;&#49;&#57;&#x36;&#49;&#64;&#x71;&#113;&#46;&#x63;&#111;&#109;</a> (æ•²å“è­¦é’Ÿï¼ è‡ªå·±ç½‘ç«™ä¹Ÿè¦æ³¨æ„ï¼)<br>è®¿é—® &#x2F;admin å¯†ç å°è¯• 1156631961å‘ç°ä¸å¯¹åŠ² æ€ä¹ˆéƒ½ç™»ä¸è¿›å»<br>åˆå­¦åˆ°éªšæ“ä½œäº† å¿˜è®°å¯†ç  å¯†ä¿æ˜¯åŸå¸‚ é‚£ä¹ˆåˆ©ç”¨QQå·æœç´¢ï¼ï¼ï¼<br>åœ¨è¥¿å®‰ å°±è¡Œäº† orz<br>å¯†ç è¢«é‡ç½®ä¸º admin7789</p>
<h2 id="web16-æ¢é’ˆæ³„éœ²"><a href="#web16-æ¢é’ˆæ³„éœ²" class="headerlink" title="web16 æ¢é’ˆæ³„éœ²"></a>web16 æ¢é’ˆæ³„éœ²</h2><p>ä½ åˆ«è¯´è¿™ç½‘ç«™è¿˜æŒºç‚«çš„ orz<br>?? ä»€ä¹ˆæ˜¯æ¢é’ˆ??? </p>
<p><a href="https://xz.aliyun.com/t/2222#:~:text=%E7%BD%91%E7%AB%99%E6%8E%A2%E9%92%88%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8F%AF,%E5%9C%A8%E5%90%84%E6%96%B0%E5%BB%BA%E7%BD%91%E7%AB%99%E4%B8%8A%E3%80%82">https://xz.aliyun.com/t/2222#:~:text=%E7%BD%91%E7%AB%99%E6%8E%A2%E9%92%88%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8F%AF,%E5%9C%A8%E5%90%84%E6%96%B0%E5%BB%BA%E7%BD%91%E7%AB%99%E4%B8%8A%E3%80%82</a></p>
<p>ä½†æ˜¯è¿™é“é¢˜ è®¿é—® &#x2F;tz.php<br>å‘ç°phpinfo()å¯ä»¥ç‚¹å‡»æŸ¥çœ‹(ä¹Ÿç¬¦åˆä¸Šé¢é“¾æ¥çš„ä»‹ç»)<br>æœç´¢flagå³å¾—</p>
<h2 id="web17-CDNç©¿é€"><a href="#web17-CDNç©¿é€" class="headerlink" title="web17 CDNç©¿é€"></a>web17 CDNç©¿é€</h2><p>é€è¿‡é‡é‡ç¼“å­˜ï¼ŒæŸ¥æ‰¾åˆ°ctfer.comçš„çœŸå®IP<br><a href="https://www.cnblogs.com/qiudabai/p/9763739.html">https://www.cnblogs.com/qiudabai/p/9763739.html</a><br>è¿™é‡Œç›´æ¥pingå³å¯ (åšé¢˜å½’åšé¢˜ è¿˜æ˜¯è¦å¤šå­¦ç‚¹ç›¸å…³çŸ¥è¯†)<br>ä½†æ˜¯è²Œä¼¼ç°åœ¨çš„ipå˜äº†â€¦ æ¯”å¦‚æˆ‘Ping&#x2F;æŸ¥è¯¢ éƒ½å¾—åˆ°çš„æ˜¯ 124.222.110.176 â€¦</p>
<h2 id="web18-jsæ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#web18-jsæ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="web18 jsæ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>web18 jsæ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><p>ä¸€ä¸ªå°æ¸¸æˆç•Œé¢ æŸ¥çœ‹æºç  å‘ç°score&gt;101ä¼šå¼¹å‡º <code>\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b</code><br>è§£ç : ä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹<br>å±® çš®çˆ±åƒçš®æ˜¯â€™phpâ€™çš„æ„æ€ â€¦ (æƒ³æƒ³ä¹Ÿæ˜¯ é€šå…³åè‚¯å®šå¼¹å‡ºä¸€ä¸ªphpç•Œé¢~)<br>è¡Œå§ è®¿é—® 110.phpå³å¯</p>
<h2 id="web19-å‰ç«¯å¯†é’¥æ³„éœ²"><a href="#web19-å‰ç«¯å¯†é’¥æ³„éœ²" class="headerlink" title="web19 å‰ç«¯å¯†é’¥æ³„éœ²"></a>web19 å‰ç«¯å¯†é’¥æ³„éœ²</h2><p>ä¸€ä¸ªç™»å½•ç•Œé¢ å‰ç«¯æºç ä¸€çœ‹ everthing is hereâ€¦<br>ç»™äº†CBCåŠ å¯†çš„IV KEY å’Œæœ€åçš„passwdåŠ å¯†å€¼ ç›´æ¥decryptå³å¯(å†™çš„æ—¶å€™åˆæŠŠå‚æ•°ä½ç½®å†™åäº†â€¦ key MODE iv)<br>passwd : i_want_a_36d_girl</p>
<h2 id="web20-æ•°æ®åº“æ¶æ„ä¸‹è½½"><a href="#web20-æ•°æ®åº“æ¶æ„ä¸‹è½½" class="headerlink" title="web20 æ•°æ®åº“æ¶æ„ä¸‹è½½"></a>web20 æ•°æ®åº“æ¶æ„ä¸‹è½½</h2><p>é¢˜ç›®æç¤º : mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†<br>æ—©æœŸçš„asp+accessæ˜¯.mdbå½¢å¼ è®¿é—® &#x2F;db&#x2F;db.mdb(è¿™dbå’‹æƒ³åˆ°çš„å•Š orz)<br>ä¸‹è½½å¾—åˆ°æ•°æ®åº“ ğŸ”å³å¯æ‰¾åˆ°flag</p>
<hr>
<hr>
<p>æ€»ç»“: è¿™äº›ç»†ææœ«èŠ‚çš„è€ƒç‚¹æœ‰æ—¶å€™çœŸçš„ä¼šæˆä¸ºå…³é”®ï¼ å½“æºç æ‰¾ä¸åˆ°æ€è·¯ å°è¯•è®¸ä¹…æ— æœæ—¶ è¯•è¯•æ‰¾æ³„éœ²ï¼</p>
<h1 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h1><p>è¿™éƒ¨åˆ†æ²¡ç¯å¢ƒçˆ†ä¸ªé¬¼ğŸ¤£</p>
<h1 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h1><h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><p>åªè¿‡æ»¤äº† flag æ‰€ä»¥å¯ä»¥ç”¨?,* æ¥åŒ¹é…<br>è§†é¢‘æœ‰ä¸ªå¾ˆç§€çš„åšæ³• <code>system(&quot;cp flag.php 1.txt&quot;)</code> ç„¶åç›´æ¥è®¿é—® &#x2F;1.txt !</p>
<h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><p>è¿‡æ»¤äº† flag system php<br>ç”¨ä¸Šé¢çš„æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">`cp fla?.??? <span class="number">1.</span>txt`</span><br></pre></td></tr></table></figure>
<p>ç„¶åè®¿é—® &#x2F;1.txt</p>
<h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><p>è¿‡æ»¤äº† flag system php cat sort shell ç‚¹ ç©ºæ ¼ å•å¼•å·<br>è§†é¢‘è¿™æ ·æ‰§è¡Œ:  <code>/?c=eval($_GET[1]);&amp;1=phpinfo();</code> æ³¨æ„phpinfo()ç»“å°¾åˆ†å·!<br>è¿™é‡Œæ˜¯å‚æ•°é€ƒé€¸(è·³æ¿) å­¦åˆ°äº† orz<br>è¿™æ ·çš„è¯ &amp;1&#x3D;åé¢å°±å¯ä»¥ä¼ ä»»æ„å€¼äº†(è„±ç¦»äº†å‚æ•°cçš„çº¦æŸ æ‰€ä»¥ä¸ä¼šè¢«åŒ¹é…åˆ°)<br>è¿™æ · <code>cat flag.php</code>éœ€è¦åœ¨æºä»£ç ä¸­æŸ¥çœ‹<br>è€Œè§†é¢‘åˆç»™äº†ä¸€ç§åšæ³• <code>tac flag.php</code> catåè¿‡æ¥å†™ å°±å¯ä»¥ç›´æ¥çœ‹åˆ°äº†</p>
<h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><p>è¿‡æ»¤äº† flag system php cat sort shell ç‚¹ ç©ºæ ¼ å•å¼•å· åå¼•å· åˆ†å· æ‹¬å·<br>é¦–å…ˆè¿˜æ˜¯å¯ä»¥ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³• <code>/?c=eval($_GET[1]);&amp;1=phpinfo();</code><br>ç©ºæ ¼è¢«è¿‡æ»¤äº†å¯ä»¥ç”¨urlç¼–ç (ç©ºæ ¼ æ¢è¡Œ éƒ½å¯ä»¥)<br>è¿˜æœ‰ä¸€ä¸ªç‚¹ è¿™é‡Œåˆ†å·è¢«è¿‡æ»¤äº† å¯ä»¥ç”¨ ?&gt;å½¢å¼  (phpæœ€åä¸€æ¡è¯­å¥ä¸éœ€è¦åˆ†å·)<br>è§†é¢‘é‡‡ç”¨äº†include<br><code>/?c=include%0a$_GET[1]?&gt;&amp;1=/etc/passwd</code><br>&#x2F;etc&#x2F;passwd ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„ç‚¹ å¯ä»¥å¾—åˆ°ä¸€äº›åŸºæœ¬ä¿¡æ¯<br>ç”šè‡³è¿˜å¯ä»¥åŒ…æ‹¬ &#x2F;bin&#x2F;ls äºŒè¿›åˆ¶æ–‡ä»¶ orz<br>æ¥ä¸‹æ¥çš„è·å–flag è§†é¢‘é‡‡ç”¨çš„æ˜¯æ–‡ä»¶åŒ…å«çš„å½¢å¼ (å› ä¸ºæˆ‘ä»¬è¿™é‡Œç”¨çš„include æ— æ³•ç›´æ¥è¾“å‡º)<br><code>/...?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p>
<h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><p>è¿‡æ»¤äº† flag system php cat sort shell ç‚¹ ç©ºæ ¼ å•å¼•å· echo åå¼•å· åˆ†å· æ‹¬å· åŒå¼•å·<br>ç»§ç»­å­¦ä¹ æ–°å§¿åŠ¿ ç”¨require<br><code>/?c=require%0a$_GET[1]?&gt;&amp;1=/etc/passwd</code><br>æ‰€ä»¥&amp;1&#x3D;åé¢æ¥ä¼ªåè®®å³å¯è¯»å–flag</p>
]]></content>
      <categories>
        <category>CTF-Web</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-Other</title>
    <url>/2023/12/04/Crypto-Other/</url>
    <content><![CDATA[<p>ä¸€äº›æ‚é¢˜(å¯†ç )&#x2F; (ä»¥å‰)æ¯”èµ›çš„å¯†ç é¢˜</p>
<span id="more"></span>

<h1 id="tsgctf2020"><a href="#tsgctf2020" class="headerlink" title="tsgctf2020"></a>tsgctf2020</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()) &lt;= <span class="number">50</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">str</span>(<span class="built_in">int</span>.from_bytes(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read(), byteorder=<span class="string">&#x27;big&#x27;</span>) &lt;&lt; <span class="number">10000</span>).endswith(<span class="string">&#x27;1002773875431658367671665822006771085816631054109509173556585546508965236428620487083647585179992085437922318783218149808537210712780660412301729655917441546549321914516504576&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æç€å¼€å§‹æ²¡ææ‡‚é¢˜ç›®æ„æ€â€¦<br>è¿™å…¶å®å°±ç­‰ä»·äº ç»™å‡º <code>m*2**10000 = s (mod 10**175)</code>â€¦<br>ç”±äºä¸äº’ç´  ä¸èƒ½ç›´æ¥å°†é€†å…ƒä¹˜è¿‡å»<br>ä¸¤ç§æ–¹æ³•:</p>
<h2 id="Solution1"><a href="#Solution1" class="headerlink" title="Solution1"></a>Solution1</h2><p>è§‚å¯Ÿä»–ä»¬çš„gcdå‘ç°å¯ä»¥å…¨éƒ¨é™¤æ‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x =  (<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">10000</span>,<span class="number">10</span>**<span class="number">175</span>))</span><br><span class="line">n = <span class="number">10</span>**<span class="number">175</span></span><br><span class="line"><span class="built_in">print</span>(gcd(x,n))</span><br><span class="line"><span class="built_in">print</span>(gcd(s,n))</span><br><span class="line">GCD = gcd(s,n)</span><br><span class="line">s //= GCD</span><br><span class="line">x //= GCD</span><br><span class="line">n //= GCD</span><br><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> *</span><br><span class="line">m = modinv(x,n)*s%n</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<h2 id="Solution2"><a href="#Solution2" class="headerlink" title="Solution2"></a>Solution2</h2><p>å¯ä»¥æ”¹å˜æ¨¡æ•° æ¯”å¦‚<code>10**175 -&gt; 5**175</code>è¿™ç§<br>ä¹Ÿå°±æ˜¯é€‰æ‹©æ–°æ¨¡æ•°ä¸ºåŸæ¥æ¨¡æ•°çš„å› å­ ä¸”æ»¡è¶³å¤§äºmçš„æ¯”ç‰¹æ•°å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">5</span>**<span class="number">175</span></span><br><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> *</span><br><span class="line">m = modinv(<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">10000</span>,n),n)*s%n</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<p>flag: TSGCTF{0K4y_Y0U_are_r3aDy_t0_Go_aNd_dO_M0r3_CryPt}</p>
]]></content>
      <categories>
        <category>CTF-Crypto</category>
      </categories>
  </entry>
  <entry>
    <title>GroebneråŸº</title>
    <url>/2023/12/04/Groebner%E5%9F%BA/</url>
    <content><![CDATA[<p>ç›®å‰è¿˜å®Œå…¨ç†è§£ä¸äº†åŸç† å…ˆè®°å½•ä¸€äº›ä¸GroebneråŸºæœ‰å…³çš„é¢˜ç›®</p>
<span id="more"></span>

<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="2019çº¢å¸½æ¯related"><a href="#2019çº¢å¸½æ¯related" class="headerlink" title="2019çº¢å¸½æ¯related"></a>2019çº¢å¸½æ¯related</h2><p>é¢˜ç›®ç»™å®š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n</span><br><span class="line">s = s0+s1+s2</span><br><span class="line">c0 = s0^<span class="number">17</span> (mod n)</span><br><span class="line">c1 = s1^<span class="number">17</span> (mod n)</span><br><span class="line">c2 = s2^<span class="number">17</span> (mod n)</span><br><span class="line">c3 = s3^<span class="number">17</span> (mod n)</span><br><span class="line">s3 = <span class="number">65537</span>*s0 - <span class="number">66666</span>*s1 + <span class="number">12345</span>*s2</span><br></pre></td></tr></table></figure>
<p>æ±‚s0,s1,s2</p>
<p>é¢˜ç›®å¤§è‡´å¯ä»¥çœ‹æˆä¸€ç§ç›¸å…³æ¶ˆæ¯æ”»å‡»çš„å˜å½¢ wikiæä¾›äº†ä»¥ä¸‹æ–¹æ³•</p>
<p><img src="https://s2.loli.net/2023/12/04/arkovT57ScK42Zj.png" alt="img"></p>
<p>sageæ‰“å°ä¸€ä¸‹ä¸­é—´æ±‚å¾—çš„groebneråŸº æ˜¯è¿™ç§å½¢å¼:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[x + <span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498137656000537211565616276407165730632699</span>, y + <span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498129910188939072517737868873227804201884</span>, z + <span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498069823870958439283760172034252636423374</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498205967870181640370981402627360812251649</span></span><br><span class="line">s = <span class="number">280513550110197745829890567436265496990</span></span><br><span class="line">c1 = <span class="number">10607235400098586699994392584841806592000660816191315008947917773605476365884572056544621466807636237415893192966935651590312237598366247520986667580174438232591692369894702423377081613821241343307094343575042030793564118302488401888197517625333923710172738913771484628557310164974384462856047065486913046647133386246976457961265115349103039946802386897315176633274295410371986422039106745216230401123542863714301114753239888820442112538285194875243192862692290859625788686421276234445677411280606266052059579743874849594812733193363406594409214632722438592376518310171297234081555028727538951934761726878443311071990</span></span><br><span class="line">c2 = <span class="number">2665348075952836665455323350891842781938471372943896177948046901127648217780657532963063228780230203325378931053293617434754585479452556620021360669764370971665619743473463613391689402725053682169256850873752706252379747752552015341379702582040497607180172854652311649467878714425698676142212588380080361100526614423533767196749274741380258842904968147508033091819979042560336703564128279527380969385330845759998657540777339113519036552454829323666242269607225156846084705957131127720351868483375138773025602253783595007177712673092409157674720974653789039702431795168654387038080256838321255342848782705785524911705</span></span><br><span class="line">c3 = <span class="number">4881225713895414151830685259288740981424662400248897086365166643853409947818654509692299250960938511400178276416929668757746679501254041354795468626916196040017280791985239849062273782179873724736552198083211250561192059448730545500442981534768431023858984817288359193663144417753847196868565476919041282010484259630583394963580424358743754334956833598351424515229883148081492471874232555456362089023976929766530371320876651940855297249474438564801349160584279330339012464716197806221216765180154233949297999618011342678854874769762792918534509941727751433687189532019000334342211838299512315478903418642056097679717</span></span><br><span class="line"></span><br><span class="line">R.&lt;x,y,z&gt; = Zmod(n)[]</span><br><span class="line">I = ideal(x+y+z-s,x^<span class="number">17</span>-c1,y^<span class="number">17</span>-c2,z^<span class="number">17</span>-c3)</span><br><span class="line">res = I.groebner_basis()</span><br><span class="line">m1 = -<span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498137656000537211565616276407165730632699</span></span><br><span class="line">m2 = -<span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498129910188939072517737868873227804201884</span></span><br><span class="line">m3 = -<span class="number">16084923760264169099484353317952979348361855860935256157402027983349457021767614332173154044206967015252105109115289920685657394517879177103414348487477378025259589760996270909325371731433876289897874303733424115117776042592359041482059737708721396118254756778152435821692154824236881182156000806958403005506732891823555324800528934757672719379501318525189471726279397236710401497352477683714139039769105043411654493442696289499967521222951945823233371845110807469944602345293068346574630273539870116158817556523565199093874587097230314166365220290730937380983228599414137341498069823870958439283760172034252636423374</span></span><br><span class="line"></span><br><span class="line">m1 = m1%n</span><br><span class="line">m2 = m2%n</span><br><span class="line">m3 = m3%n</span><br><span class="line"></span><br><span class="line">m = (m3&lt;&lt;<span class="number">256</span>)+(m2&lt;&lt;<span class="number">128</span>)+m1</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;bf684fc7-5398-4bf3-ad5f-cfe3dc53a202&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å…ˆè®°ç€å§ å®Œå…¨æ²¡ææ‡‚groebneråŸºçš„ç¥å¥‡ä½œç”¨</p>
<h2 id="DASCTF-Apr-2023-ECC"><a href="#DASCTF-Apr-2023-ECC" class="headerlink" title="DASCTF Apr.2023 ECC"></a>DASCTF Apr.2023 ECC</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, p, q, a, b, e1, e2, e3</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q)</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&quot;DASCTF&#123;&quot;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECC</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b, p, q, e</span>):</span><br><span class="line">        self.p, self.q = p, q</span><br><span class="line">        self.a, self.b = a, b</span><br><span class="line">        self.N         = p * q</span><br><span class="line">        self.e         = e</span><br><span class="line">        self.Kbits     = <span class="number">8</span></span><br><span class="line">        self.Ep        = EllipticCurve(IntegerModRing(p), [a, b])</span><br><span class="line">        self.Eq        = EllipticCurve(IntegerModRing(q), [a, b])</span><br><span class="line"></span><br><span class="line">        N1 = self.Ep.order()</span><br><span class="line">        N2 = <span class="number">2</span> * p + <span class="number">2</span> - N1</span><br><span class="line">        N3 = self.Eq.order()</span><br><span class="line">        N4 = <span class="number">2</span> * q + <span class="number">2</span> - N3</span><br><span class="line"></span><br><span class="line">        self.d = &#123;</span><br><span class="line">            ( <span class="number">1</span>,  <span class="number">1</span>): inverse_mod(e, lcm(N1, N3)),</span><br><span class="line">            ( <span class="number">1</span>, -<span class="number">1</span>): inverse_mod(e, lcm(N1, N4)),</span><br><span class="line">            (-<span class="number">1</span>,  <span class="number">1</span>): inverse_mod(e, lcm(N2, N3)),</span><br><span class="line">            (-<span class="number">1</span>, -<span class="number">1</span>): inverse_mod(e, lcm(N2, N4))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        self.E = EllipticCurve(IntegerModRing(self.N), [a, b])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        msg_point = self.msg_to_point(plaintext, <span class="literal">True</span>)</span><br><span class="line">        mp = self.Ep(msg_point)</span><br><span class="line">        mq = self.Eq(msg_point)</span><br><span class="line">        cp = (self.e * mp).xy()</span><br><span class="line">        cq = (self.e * mq).xy()</span><br><span class="line">        cp = (<span class="built_in">int</span>(cp[<span class="number">0</span>]), <span class="built_in">int</span>(cp[<span class="number">1</span>]))</span><br><span class="line">        cq = (<span class="built_in">int</span>(cq[<span class="number">0</span>]), <span class="built_in">int</span>(cq[<span class="number">1</span>]))</span><br><span class="line">        c  = (<span class="built_in">int</span>(crt([cp[<span class="number">0</span>], cq[<span class="number">0</span>]], [self.p, self.q])), \</span><br><span class="line">              <span class="built_in">int</span>(crt([cp[<span class="number">1</span>], cq[<span class="number">1</span>]], [self.p, self.q])))</span><br><span class="line">        c = self.E(c)</span><br><span class="line">        <span class="keyword">return</span> c.xy()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        x = ciphertext</span><br><span class="line">        w = x^<span class="number">3</span> + self.a*x + self.b % self.N</span><br><span class="line"></span><br><span class="line">        P.&lt;Yp&gt; = PolynomialRing(Zmod(self.p))</span><br><span class="line">        fp = x^<span class="number">3</span> + self.a*x + self.b -Yp^<span class="number">2</span></span><br><span class="line">        yp = fp.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        P.&lt;Yq&gt; = PolynomialRing(Zmod(self.q))</span><br><span class="line">        fq = x^<span class="number">3</span> + self.a*x + self.b -Yq^<span class="number">2</span></span><br><span class="line">        yq = fq.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        y = crt([<span class="built_in">int</span>(yp), <span class="built_in">int</span>(yq)], [self.p, self.q])</span><br><span class="line"></span><br><span class="line">        cp, cq = self.Ep((x, y)), self.Eq((x, y))</span><br><span class="line">        legendre_symbol_p = legendre_symbol(w, self.p)</span><br><span class="line">        legendre_symbol_q = legendre_symbol(w, self.q)</span><br><span class="line"></span><br><span class="line">        mp = (self.d[(legendre_symbol_p, legendre_symbol_q)] * cp).xy()</span><br><span class="line">        mq = (self.d[(legendre_symbol_p, legendre_symbol_q)] * cq).xy()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> crt([<span class="built_in">int</span>(mp[<span class="number">0</span>]), <span class="built_in">int</span>(mq[<span class="number">0</span>])], [self.p, self.q]) &gt;&gt; self.Kbits</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">msg_to_point</span>(<span class="params">self, x, shift=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="keyword">if</span> shift:</span><br><span class="line">            x &lt;&lt;= self.Kbits</span><br><span class="line">        res_point = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> &lt;&lt; self.Kbits):</span><br><span class="line">            P.&lt;Yp&gt; = PolynomialRing(Zmod(self.p))</span><br><span class="line">            fp = x^<span class="number">3</span> + self.a*x + self.b - Yp^<span class="number">2</span></span><br><span class="line">            P.&lt;Yq&gt; = PolynomialRing(Zmod(self.q))</span><br><span class="line">            fq = x^<span class="number">3</span> + self.a*x + self.b - Yq^<span class="number">2</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                yp, yq = <span class="built_in">int</span>(fp.roots()[<span class="number">0</span>][<span class="number">0</span>]), <span class="built_in">int</span>(fq.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">                y = crt([yp, yq], [self.p, self.q])</span><br><span class="line">                E = EllipticCurve(IntegerModRing(self.p*self.q), [self.a, self.b])</span><br><span class="line">                res_point = E.point((x, y))</span><br><span class="line">                <span class="keyword">return</span> res_point</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                x += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res_point</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ecc1 = ECC(a, b, p, q, e1)</span><br><span class="line">ecc2 = ECC(a, b, p, q, e2)</span><br><span class="line">ecc3 = ECC(a, b ,p, q, e3)</span><br><span class="line">gift = p * q * getPrime(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">secret = bytes_to_long(flag[<span class="number">7</span>:-<span class="number">1</span>].encode())</span><br><span class="line">ciphertext1 = ecc1.enc(secret)</span><br><span class="line">ciphertext2 = ecc2.enc(secret)</span><br><span class="line">ciphertext3 = ecc3.enc(secret)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    </span><br><span class="line">    f.write(<span class="string">f&quot;e1 = <span class="subst">&#123;e1&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;e2 = <span class="subst">&#123;e2&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;e3 = <span class="subst">&#123;e3&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;gift = <span class="subst">&#123;gift&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;C1 = <span class="subst">&#123;ciphertext1&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;C2 = <span class="subst">&#123;ciphertext2&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;C3 = <span class="subst">&#123;ciphertext3&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é™„ä»¶:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e1 = <span class="number">516257683822598401</span></span><br><span class="line">e2 = <span class="number">391427904712695553</span></span><br><span class="line">e3 = <span class="number">431785901506020973</span></span><br><span class="line">gift = <span class="number">10954621221812651197619957228527372749810730943802288293715079353550311138677754821746522832935330138708418986232770630995550582619687239759917418738050269898943719822278514605075330569827210725314869039623167495140328454254640051293396463956732280673238182897228775094614386379902845973838934549168736103799539422716766688822243954145073458283746306858717624769112552867126607212724068484647333634548047278790589999183913</span></span><br><span class="line">C1 = (<span class="number">1206929895217993244310816423179846824808172528120308055773133254871707902120929022352908110998765937447485028662679732041</span>, <span class="number">652060368795242052052268674691241294013033011634464089331399905627588366001436638328894634036437584845563026979258880828</span>)</span><br><span class="line">C2 = (<span class="number">1819289899794579183151870678118089723240127083264590266958711858768481876209114055565064148870164568925012329554392844153</span>, <span class="number">1110245535005295568283994217305072930348872582935452177061131445872842458573911993488746144360725164302010081437373324551</span>)</span><br><span class="line">C3 = (<span class="number">1112175463080774353628562547288706975571507012326470665917118873336738873653792420189391867408691423887642725415133046354</span>, <span class="number">1820636035485820691083758790204536675748006232767111209985774382700260408550258280489088658228739971137550264759084468620</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ECCå­¦çš„è¿˜æ˜¯å¤ªè‚¤æµ…äº† æ¶è¡¥ä¸€ä¸‹ECCå†æ¥çœ‹å§ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>CTF-Crypto</category>
      </categories>
  </entry>
  <entry>
    <title>osu</title>
    <url>/2023/12/03/osu/</url>
    <content><![CDATA[<p><strong>Welcome to osu!</strong></p>
<span id="more"></span>

<h1 id="OWC2023-Korea-VS-USA"><a href="#OWC2023-Korea-VS-USA" class="headerlink" title="OWC2023 Korea VS USA"></a>OWC2023 Korea VS USA</h1><p>å¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆè¦è¿ç€æ‰“ä¸¤åœºï¼Ÿ<br>masakaç¬¬ä¸€åœºç®—æ˜¯èƒœè€…ç»„å†³èµ› ç„¶åbracket resetå†æ¥æ‰“çœŸæ­£çš„grandfinalï¼ŸğŸ¤–</p>
<p><img src="https://s2.loli.net/2023/12/03/QslebCr415jmOwY.png" alt="img"></p>
<p><img src="https://s2.loli.net/2023/12/03/Yuv79oQjWOH6npJ.png" alt="img"></p>
<p>How Could He make it!!!WTF!!! MY GOD WORST_HR_PLAYER!!!!</p>
<p>FMçš„strategyï¼š</p>
<p><img src="https://s2.loli.net/2023/12/03/URiJLec6dNvSklo.png" alt="img"></p>
<p>flyingtunaä¸€äººæ‰¿æ‹…æ‰€æœ‰ ç„¶åè®©Karcheræ‰“NM(other than HR)FC<br>what  a textbook strategyï¼ï¼ï¼ wow !!!</p>
<p>Are you kidding me ??? lolğŸ˜‚</p>
<p><img src="https://s2.loli.net/2023/12/03/ny1Cz9uobixJlaF.png" alt="img"></p>
<p>How can you hit without anything? lol.O(âˆ©_âˆ©)O</p>
<p>Finally, we have TieBreakerâ€¦<br>WTF TB: 8.60â­ length:6:43 WTF</p>
<p><img src="https://s2.loli.net/2023/12/04/hXvoSkIZlO2yu8L.png" alt="img"></p>
<p>å“ USAå‡ è¿å† äº†å•Šâ€¦ Koreaå¤ªå¯æƒœäº†å•Šå•Šï¼ ä¸ºä»€ä¹ˆæœ€åTBä¸ä¸Šworst_hr_player å•Šï¼ï¼ï¼ï¼ï¼ï¼ï¼ å¤ªå¯æƒœäº†å§~</p>
]]></content>
      <categories>
        <category>osu</category>
      </categories>
  </entry>
  <entry>
    <title>é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†-C13-PEæ–‡ä»¶æ ¼å¼-ç¬”è®°</title>
    <url>/2023/12/03/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86-C13-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F-%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†-C13-PEæ–‡ä»¶æ ¼å¼-ç¬”è®°</p>
<span id="more"></span>
<p>å‰å‡ å‘¨ç²—æµ…çœ‹äº†ä¸€é ç”±äºæ˜¯ç”µå­ç‰ˆ ä¹Ÿæ²¡ç•™ä¸‹å¤šå¤§å°è±¡<br>æœ€è¿‘CTFçš„reé¢˜çœ‹ç€å¤ªç´¯äº† åšä¸€ä¸ªé¢˜æŒºè€—æ—¶é—´çš„ æƒ³ç€æ˜¯åŸºç¡€è¿˜æ˜¯ä¸å¤Ÿæ‰å®<br>å†è€…å­¦é€†å‘çš„ç›®çš„ä¹Ÿä¸å…¨æ˜¯CTF æŒæ¡äº›ç†è®ºè¿˜æ˜¯å¾ˆé‡è¦çš„<br>å†æ¥é‡æ–°å­¦ä¸€å­¦ å†™ç¯‡ç¬”è®°è®°å½•ä¸€ä¸‹å…³é”®ç‚¹ ä¹Ÿå¯å‘è‡ªå·±æ€è€ƒ</p>
<h1 id="13-1-ä»‹ç»"><a href="#13-1-ä»‹ç»" class="headerlink" title="13.1 ä»‹ç»"></a>13.1 ä»‹ç»</h1><p>PE32 &amp; PE+&#x2F;PE32+ åˆ«å†™PE64 :(é—¹ç¬‘è¯</p>
<h1 id="13-2-PEæ–‡ä»¶æ ¼å¼"><a href="#13-2-PEæ–‡ä»¶æ ¼å¼" class="headerlink" title="13.2 PEæ–‡ä»¶æ ¼å¼"></a>13.2 PEæ–‡ä»¶æ ¼å¼</h1><p>å­¦ä¹ PEæ–‡ä»¶æ ¼å¼å°±æ˜¯å­¦ä¹ PEå¤´ä¸­çš„ç»“æ„ä½“<br><strong>ååˆ†é‡è¦ï¼ï¼ï¼</strong></p>
<h2 id="13-2-1-åŸºæœ¬ç»“æ„"><a href="#13-2-1-åŸºæœ¬ç»“æ„" class="headerlink" title="13.2.1 åŸºæœ¬ç»“æ„"></a>13.2.1 åŸºæœ¬ç»“æ„</h2><p>DOSå¤´åˆ°èŠ‚åŒºå¤´æ˜¯PEå¤´éƒ¨åˆ†(4D 5A â€¦ 50 45)<br>æ–‡ä»¶ä¸­ä½¿ç”¨åç§»(offset) å†…å­˜ä¸­ä½¿ç”¨VA(è™šæ‹Ÿåœ°å€)æ¥è¡¨ç¤ºä½ç½® å½“æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­æ—¶æƒ…å†µä¼šæ”¹å˜ å†…å®¹åˆ†ä¸º .text .data .rsrcåˆ†åˆ«ä¿å­˜</p>
<h2 id="13-2-2-VA-RVA"><a href="#13-2-2-VA-RVA" class="headerlink" title="13.2.2 VA&amp;RVA"></a>13.2.2 VA&amp;RVA</h2><p>RVA(ç›¸å¯¹è™šæ‹Ÿåœ°å€) + ImageBase(åŸºå‡†ä½ç½®) &#x3D; VA<br>PEå¤´å†…éƒ¨ä¿¡æ¯å¤§å¤šä»¥RVAå½¢å¼ å› ä¸ºPE(å°¤å…¶æ˜¯DLL)åŠ è½½åˆ°è¿›ç¨‹è™šæ‹Ÿå†…å­˜æ—¶ç”±äºè¯¥ä½ç½®å·²ç»åŠ è½½å…¶ä»–PE(DLL) è¦é€šè¿‡é‡å®šä½åŠ è½½åˆ°å…¶ä»–ç©ºç™½çš„ä½ç½®<br>ç”¨RVAå°±åªéœ€è¦è®°å½•ImageBaseå°±å¯ä»¥å¾—åˆ°VA</p>
<h1 id="13-3-PEå¤´"><a href="#13-3-PEå¤´" class="headerlink" title="13.3 PEå¤´"></a>13.3 PEå¤´</h1><h2 id="13-3-1-DOSå¤´"><a href="#13-3-1-DOSå¤´" class="headerlink" title="13.3.1 DOSå¤´"></a>13.3.1 DOSå¤´</h2><p>é‡ç‚¹å…³æ³¨ä¸¤ä¸ªæˆå‘˜</p>
<ul>
<li>e_magic: DOSç­¾å (4D5A &#x3D;&gt; â€œMZâ€)</li>
<li>e_lfanew: æŒ‡ç¤ºNTå¤´çš„åç§» (ä¸åŒæ–‡ä»¶å€¼å¯å˜)</li>
</ul>
<p>åœ¨ä¹¦ç»™çš„exeä¸­ e_lfanewçš„å€¼ä¸º 000000E0(å°ç«¯åº!)</p>
<h2 id="13-3-2-DOSå­˜æ ¹"><a href="#13-3-2-DOSå­˜æ ¹" class="headerlink" title="13.3.2 DOSå­˜æ ¹"></a>13.3.2 DOSå­˜æ ¹</h2><p>40~4Dä¸ºæ±‡ç¼–æŒ‡ä»¤(æœ‰å…´è¶£æŠŠå®ƒå†™å…¥æ–‡ä»¶IDAåº·åº·)<br>ä¸»è¦å°±æ˜¯ç”¨æ¥è¾“å‡ºä¸€ä¸‹â€This program â€¦ DOS modeâ€å°±é€€å‡ºäº† ç®—æ˜¯ä¸€ç§å¯¹äºMS-DOSçš„å…¼å®¹</p>
<h2 id="13-3-3-NTå¤´"><a href="#13-3-3-NTå¤´" class="headerlink" title="13.3.3 NTå¤´"></a>13.3.3 NTå¤´</h2><p>NTå¤´çš„IMAGE_NT_HEADERS</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_NT_HEADERS64</span> &#123;</span></span><br><span class="line">  DWORD                   Signature;    <span class="comment">//ç­¾å</span></span><br><span class="line">  IMAGE_FILE_HEADER       FileHeader;   <span class="comment">//æ–‡ä»¶å¤´</span></span><br><span class="line">  IMAGE_OPTIONAL_HEADER64 OptionalHeader; <span class="comment">//å¯é€‰å¤´</span></span><br><span class="line">&#125; IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;</span><br></pre></td></tr></table></figure>
<p>signatureå³ä¸º50450000(â€œPEâ€00)<br>IMAGE_NT_HEADERSç»“æ„ä½“æ€»å¤§å°ä¸ºF8 å¾ˆå¤§</p>
<h2 id="13-3-4-NTå¤´-æ–‡ä»¶å¤´"><a href="#13-3-4-NTå¤´-æ–‡ä»¶å¤´" class="headerlink" title="13.3.4 NTå¤´: æ–‡ä»¶å¤´"></a>13.3.4 NTå¤´: æ–‡ä»¶å¤´</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_FILE_HEADER</span> &#123;</span></span><br><span class="line">  WORD  Machine;</span><br><span class="line">  WORD  NumberOfSections;</span><br><span class="line">  DWORD TimeDateStamp;</span><br><span class="line">  DWORD PointerToSymbolTable;</span><br><span class="line">  DWORD NumberOfSymbols;</span><br><span class="line">  WORD  SizeOfOptionalHeader;</span><br><span class="line">  WORD  Characteristics;</span><br><span class="line">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</span><br></pre></td></tr></table></figure>
<ul>
<li>Machine: æ¯ä¸ªCPUéƒ½æœ‰å”¯ä¸€çš„machineç </li>
<li>NumberOfSections: æ–‡ä»¶ä¸­å­˜åœ¨çš„èŠ‚åŒºæ•°é‡</li>
<li>SizeOfOptionalHeader: IMAGE_OPTIONAL_HEADER64ç»“æ„ä½“å¤§å°</li>
<li>Characteristics: æ ‡è¯†æ–‡ä»¶å±æ€§ æ˜¯å¦å¯è¿è¡Œ æ˜¯å¦ä¸ºDLLç­‰</li>
<li>TimeDateStamp: è¯¥æˆå‘˜çš„å€¼ä¸å½±å“è¿è¡Œ ç”¨æ¥è®°å½•æ—¶é—´è€Œå·²</li>
</ul>
<h2 id="13-3-5-NTå¤´-å¯é€‰å¤´"><a href="#13-3-5-NTå¤´-å¯é€‰å¤´" class="headerlink" title="13.3.5 NTå¤´: å¯é€‰å¤´"></a>13.3.5 NTå¤´: å¯é€‰å¤´</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_OPTIONAL_HEADER</span> &#123;</span></span><br><span class="line">  WORD                 Magic;</span><br><span class="line">  BYTE                 MajorLinkerVersion;</span><br><span class="line">  BYTE                 MinorLinkerVersion;</span><br><span class="line">  DWORD                SizeOfCode;</span><br><span class="line">  DWORD                SizeOfInitializedData;</span><br><span class="line">  DWORD                SizeOfUninitializedData;</span><br><span class="line">  DWORD                AddressOfEntryPoint;</span><br><span class="line">  DWORD                BaseOfCode;</span><br><span class="line">  DWORD                BaseOfData;</span><br><span class="line">  DWORD                ImageBase;</span><br><span class="line">  DWORD                SectionAlignment;</span><br><span class="line">  DWORD                FileAlignment;</span><br><span class="line">  WORD                 MajorOperatingSystemVersion;</span><br><span class="line">  WORD                 MinorOperatingSystemVersion;</span><br><span class="line">  WORD                 MajorImageVersion;</span><br><span class="line">  WORD                 MinorImageVersion;</span><br><span class="line">  WORD                 MajorSubsystemVersion;</span><br><span class="line">  WORD                 MinorSubsystemVersion;</span><br><span class="line">  DWORD                Win32VersionValue;</span><br><span class="line">  DWORD                SizeOfImage;</span><br><span class="line">  DWORD                SizeOfHeaders;</span><br><span class="line">  DWORD                CheckSum;</span><br><span class="line">  WORD                 Subsystem;</span><br><span class="line">  WORD                 DllCharacteristics;</span><br><span class="line">  DWORD                SizeOfStackReserve;</span><br><span class="line">  DWORD                SizeOfStackCommit;</span><br><span class="line">  DWORD                SizeOfHeapReserve;</span><br><span class="line">  DWORD                SizeOfHeapCommit;</span><br><span class="line">  DWORD                LoaderFlags;</span><br><span class="line">  DWORD                NumberOfRvaAndSizes;</span><br><span class="line">  IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure>
<p>é‡ç‚¹å…³æ³¨ä»¥ä¸‹æˆå‘˜</p>
<ul>
<li>Magic: IMAGE_OPTIONAL_HEADERä¸º32ä½-10B 64ä½-20B</li>
<li><strong>AddressOfEntryPoint</strong>: æŒæœ‰EPçš„RVAå€¼ï¼ï¼ï¼ æŒ‡å‡ºç¨‹åºæœ€å…ˆæ‰§è¡Œä»£ç èµ·å§‹åœ°å€ï¼ï¼ï¼</li>
<li>ImageBase: åœ¨PEæ–‡ä»¶è¢«åŠ è½½åˆ°å†…å­˜æ—¶ æŒ‡å‡ºæœ‰é™è£…è½½çš„åœ°å€<br>EXE DLLè¢«è£…è½½åˆ°ç”¨æˆ·å†…å­˜çš„0 ~ 7FFFFFFF    SYSè¢«è£…è½½åˆ°å†…æ ¸å†…å­˜çš„80000000 ~ FFFFFFFF<br>ä¸€èˆ¬è€Œè¨€ ç”¨å¼€å‘å·¥å…·åˆ›å»ºEXEå ImageBaseå€¼ä¸º00400000 DLLæ–‡ä»¶çš„ImageBaseå€¼ä¸º10000000(ä¹Ÿå¯ä¸ºå…¶ä»–å€¼)<br>æ‰§è¡ŒPEæ–‡ä»¶æ—¶ PEè£…è½½å™¨å…ˆåˆ›å»ºè¿›ç¨‹ å†å°†æ–‡ä»¶è½½å…¥å†…å­˜ ç„¶åæŠŠEIPè®¾ç½®ä¸ºImageBase+AddressOfEntryPoint</li>
<li>SectionAlignment FileAlignment: PEæ–‡ä»¶çš„bodyéƒ¨åˆ†è¢«åˆ’åˆ†ä¸ºèŠ‚åŒº<br>FileAlignmentæŒ‡å®šäº†èŠ‚åŒºåœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„æœ€å°å•ä½<br>SectionAlignmentåˆ™æŒ‡å®šäº†èŠ‚åŒºåœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½</li>
<li>SizeOfImage: åŠ è½½PEæ–‡ä»¶åˆ°å†…å­˜æ—¶ SizeOfImageæŒ‡å®šäº†PE Imageåœ¨è™šå­˜ä¸­æ‰€å ç©ºé—´å¤§å°</li>
<li>SizeOfHeaders: æŒ‡å‡ºæ•´ä¸ªPEå¤´çš„å¤§å°<br>ç¬¬ä¸€èŠ‚åŒºæ‰€åœ¨ä½ç½®ä¸SizeOfHeadersè·æ–‡ä»¶å¼€å§‹çš„offsetç›¸åŒ</li>
<li>Subsystem: åŒºåˆ†é©±åŠ¨æ–‡ä»¶(.sys)å’Œæ™®é€šçš„å¯æ‰§è¡Œæ–‡ä»¶(.exe .dll)</li>
<li>NumberOfRvaAndSizes: æŒ‡å®šæœ€åä¸€ä¸ªæˆå‘˜DataDirectoryæ•°ç»„çš„ä¸ªæ•°(å¤§å°ä¸ä¸€å®šä¸º16)</li>
<li>DataDirectory:<br><img src="https://s2.loli.net/2023/12/03/IVkU3uvCy9dxPJZ.png" alt="img"><br>é‡ç‚¹å…³æ³¨0,1,9 EXPORT IMPORT TLS</li>
</ul>
<h2 id="13-3-6-èŠ‚åŒºå¤´"><a href="#13-3-6-èŠ‚åŒºå¤´" class="headerlink" title="13.3.6 èŠ‚åŒºå¤´"></a>13.3.6 èŠ‚åŒºå¤´</h2><p>PEæ–‡ä»¶è¢«åˆ›å»ºä¸ºå¤šä¸ªèŠ‚åŒºç»“æ„(æ›´åŠ å®‰å…¨ eg.ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢ç¼“å†²åŒºæº¢å‡º)</p>
<ul>
<li>code: æ‰§è¡Œ å¯è¯»å–</li>
<li>data: éæ‰§è¡Œ å¯è¯»å†™</li>
<li>resource: éæ‰§è¡Œ å¯è¯»å–</li>
</ul>
<p>å„ä¸ªèŠ‚åŒºçš„å±æ€§è¢«è®°å½•åœ¨èŠ‚åŒºå¤´ä¸­</p>
<p>IMAGE_SECTION_HEADER</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_SECTION_HEADER</span> &#123;</span></span><br><span class="line">  BYTE  Name[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    DWORD PhysicalAddress;</span><br><span class="line">    DWORD VirtualSize;</span><br><span class="line">  &#125; Misc;</span><br><span class="line">  DWORD VirtualAddress;</span><br><span class="line">  DWORD SizeOfRawData;</span><br><span class="line">  DWORD PointerToRawData;</span><br><span class="line">  DWORD PointerToRelocations;</span><br><span class="line">  DWORD PointerToLinenumbers;</span><br><span class="line">  WORD  NumberOfRelocations;</span><br><span class="line">  WORD  NumberOfLinenumbers;</span><br><span class="line">  DWORD Characteristics;</span><br><span class="line">&#125; IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure>
<ul>
<li>VirtualSize: å†…å­˜ä¸­èŠ‚åŒºæ‰€å å¤§å°</li>
<li>VirtualAddress: å†…å­˜ä¸­èŠ‚åŒºèµ·å§‹ä½ç½®(RVA)</li>
<li>SizeOfRawData: ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºæ‰€å å¤§å°</li>
<li>PointerToRawData: ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºèµ·å§‹ä½ç½®</li>
<li>Characteristics: èŠ‚åŒºå±æ€§(bit OR)</li>
</ul>
<p>å…¶ä¸­VirtualAddresså’ŒPointerToRawDataä¸å¸¦æœ‰ä»»ä½•å€¼ ç”±å¯é€‰å¤´ä¸­çš„SectionAlignmentå’ŒFileAlignmentç¡®å®š<br>VirtualSizeå’ŒSizeOfRawDataå€¼ä¸€èˆ¬ä¸åŒ!<br>æœ€åçœ‹çœ‹Nameå­—æ®µ å¯ä»¥å‘å…¶ä¸­æ”¾å…¥ä»»ä½•å€¼(ç”šè‡³å¯ä»¥NULLå¡«å……)</p>
<p><img src="https://s2.loli.net/2023/12/03/VcswHEPriI5SOgB.png" alt="img"></p>
<h1 id="13-4-RVA-to-RAW"><a href="#13-4-RVA-to-RAW" class="headerlink" title="13.4 RVA to RAW"></a>13.4 RVA to RAW</h1><p><img src="https://s2.loli.net/2023/12/03/bVn7942XuTZ18OY.png" alt="img"><br>å³ç£ç›˜åˆ°å†…å­˜çš„æ˜ å°„<br>æ–¹æ³•:</p>
<ol>
<li>æŸ¥æ‰¾RVAæ‰€åœ¨èŠ‚åŒº</li>
<li>å…¬å¼è®¡ç®—åç§»(RAW)<br><code>offset = RAW - PointerToRawData = RVA - VitrualAddress </code></li>
</ol>
<p>å‡ ä¸ªç»ƒä¹ :<br><img src="https://s2.loli.net/2023/12/03/VcswHEPriI5SOgB.png" alt="img"></p>
<p>Q1. RVA &#x3D; 5000æ—¶ FileOffset &#x3D; ?<br>A1. RVA:ç¬¬ä¸€èŠ‚åŒº PTR&#x3D;RawAddress &#x3D; 400 VA &#x3D; 1000 &#x3D;&gt; RAW &#x3D; 4400</p>
<p>Q2. RVA &#x3D; 13314<br>A2. ç¬¬ä¸‰èŠ‚åŒº VA &#x3D; B000 PTR &#x3D; 8400 &#x3D;&gt; RAW &#x3D; 10714</p>
<p>Q3. RVA &#x3D; ABA8<br>A3. ç¬¬äºŒèŠ‚åŒº VA&#x3D;9000 PTR &#x3D; 7C00 &#x3D;&gt; RAW &#x3D; 97A8<br>å‘ç°ç®—å‡ºæ¥åç§»åœ¨ç¬¬ä¸‰èŠ‚åŒº è¯´æ˜â€æ— æ³•å®šä¹‰RVA(ABA8)ç›¸å¯¹åº”çš„RAWå€¼â€<br>åŸå› : ç¬¬äºŒèŠ‚åŒºçš„ VirtualSizeæ¯”RawSizeå¤§!</p>
<h1 id="13-5-IAT"><a href="#13-5-IAT" class="headerlink" title="13.5 IAT"></a>13.5 IAT</h1><p><strong>éš¾ç‚¹æ¥äº†</strong><br>IAT: å¯¼å…¥åœ°å€è¡¨(Import Address Table)<br>IATä¿å­˜çš„å†…å®¹ä¸Windowsæ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒè¿›ç¨‹ å†…å­˜ DLLç»“æ„ç­‰æœ‰å…³<br>ç®€è¨€ä¹‹ IATæ˜¯ä¸€ç§è¡¨æ ¼ ç”¨æ¥è®°å½•ç¨‹åºæ­£åœ¨ä½¿ç”¨å“ªäº›åº“ä¸­çš„å“ªäº›å‡½æ•°</p>
<h2 id="13-5-1-DLL"><a href="#13-5-1-DLL" class="headerlink" title="13.5.1 DLL"></a>13.5.1 DLL</h2><p>ç›¸æ¯”æ—©æœŸåªæœ‰åº“(library) DLL</p>
<ul>
<li>ä¸éœ€è¦æŠŠåº“åŒ…å«åœ¨ç¨‹åºä¸­ å•ç‹¬ç»„æˆDLLæ–‡ä»¶ éœ€è¦æ—¶è°ƒç”¨å³å¯</li>
<li>å†…å­˜æ˜ å°„æŠ€æœ¯ä½¿åŠ è½½åçš„DLLä»£ç  èµ„æº èƒ½åœ¨å¤šä¸ªè¿›ç¨‹ä¸­å®ç°å…±äº«</li>
<li>æ›´æ–°åº“æ—¶åªéœ€è¦æ›¿æ¢ç›¸å…³DLLæ–‡ä»¶å³å¯</li>
</ul>
<p>åŠ è½½DLLçš„ä¸¤ç§æ–¹å¼</p>
<ul>
<li>æ˜¾ç¤ºé“¾æ¥: ç¨‹åºä½¿ç”¨DLLæ—¶åŠ è½½ ä½¿ç”¨å®Œæ¯•åé‡Šæ”¾å†…å­˜</li>
<li>éšå¼é“¾æ¥: ç¨‹åºä¸€å¼€å§‹å°±ä¸€åŒåŠ è½½DLL ç¨‹åºç»ˆæ­¢æ—¶å†é‡Šæ”¾å ç”¨çš„å†…å­˜  IATæœºåˆ¶ä¸è¿™ç§é“¾æ¥æ–¹å¼æœ‰å…³</li>
</ul>
<p>OllyDbgæŸ¥çœ‹notepad.exe</p>
<p><img src="https://s2.loli.net/2023/12/03/3XKFV2lzoc18G7j.png" alt="img"></p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°<br>è°ƒç”¨CreateFileW()æ—¶å¹¶éç›´æ¥è°ƒç”¨è€Œæ˜¯è·å–01001104å¤„çš„åœ°å€æ¥å®ç°(æ‰€æœ‰APIè°ƒç”¨å‡å¦‚æ­¤)<br>åœ°å€01001104æ˜¯.textèŠ‚åŒºçš„å†…å­˜åŒºåŸŸ(IATå†…å­˜åŒºåŸŸ) åœ°å€çš„å€¼7645EA70å³ä¸ºåŠ è½½åˆ°exeè¿›ç¨‹å†…å­˜ä¸­CreateFileW()å‡½æ•°(ä½äºkernel32.dllåº“)çš„åœ°å€<br>æ¯”è¾ƒä¹¦å’Œæœ¬åœ°å¯ä»¥å‘ç° 01001104åœ°å€çš„å€¼æœ‰å·®å¼‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆé€šè¿‡01001104è€Œä¸æ˜¯é€šè¿‡å®ƒæŒ‡å‘çš„åœ°å€çš„å€¼æ¥è°ƒç”¨<br>åŒæ—¶ç”±äºDLLçš„é‡å®šä½ å¯¼è‡´æ— æ³•å¯¹å®é™…åœ°å€ç¡¬ç¼–ç  åŒæ—¶PEå¤´ä¸­è¡¨ç¤ºåœ°å€æ—¶ä½¿ç”¨çš„æ˜¯RVAè€Œä¸æ˜¯VA</p>
<h2 id="13-5-2-IMAGE-IMPORT-DECRIPTOR"><a href="#13-5-2-IMAGE-IMPORT-DECRIPTOR" class="headerlink" title="13.5.2 IMAGE_IMPORT_DECRIPTOR"></a>13.5.2 IMAGE_IMPORT_DECRIPTOR</h2><p>IMAGE_IMPORT_DECRIPTORç»“æ„ä½“è®°å½•ç€PEæ–‡ä»¶è¦å¯¼å…¥å“ªäº›åº“æ–‡ä»¶<br>IMAGE_IMPORT_DECRIPTORç»“æ„ä½“æ•°ç»„ä¹Ÿè¢«ç§°ä¸ºIMPORT Directory Table (å¯¼å…¥ç›®å½•)<br>å¯¼å…¥å¤šå°‘ä¸ªåº“å°±æ„å‘³ç€æœ‰å¤šå°‘ä¸ªIMAGE_IMPORT_DECRIPTORç»“æ„ä½“</p>
<p><img src="https://s2.loli.net/2023/12/03/au16VZ8spBbtfmH.png" alt="img"></p>
<ul>
<li>OriginalFirstThunk(OFT): INTçš„åœ°å€(RVA)</li>
<li>Name: åº“åç§°å­—ç¬¦ä¸²çš„åœ°å€(RVA)</li>
<li>FirstThunk(FT): IATçš„åœ°å€(RVA)</li>
</ul>
<p>æç¤º:</p>
<ul>
<li>PEå¤´ä¸­æåˆ°çš„tableå‡æŒ‡æ•°ç»„</li>
<li>INTå’ŒIATæ˜¯é•¿æ•´å‹ ä»¥NULLç»“æŸ</li>
<li>INTä¸­å„å…ƒç´ çš„å€¼ä¸ºIMAGE_IMPORT_BY_NAMEç»“æ„ä½“æŒ‡é’ˆ</li>
<li>INTä¸IATå¤§å°åº”ç›¸åŒ</li>
</ul>
<p><img src="https://s2.loli.net/2023/12/03/XWDsoRfdbH8ZJFx.png" alt="img"></p>
<p>è¿™å¼ å›¾ä¸­ INTå’ŒIATå„å…ƒç´ åŒæ—¶æŒ‡å‘ç›¸åŒåœ°å€ ä½†å¾ˆå¤šæƒ…å†µä¸‹ä»–ä»¬æ˜¯ä¸ä¸€è‡´çš„ è¦æ³¨æ„</p>
<p>ç®€å•äº†è§£ä¸‹PEè£…è½½å™¨æŠŠå¯¼å…¥å‡½æ•°è¾“å…¥IATçš„é¡ºåº:</p>
<ol>
<li>è¯»å–IIDçš„Nameæˆå‘˜ è·å–åº“åç§°å­—ç¬¦ä¸²(â€œkernel32.dllâ€)</li>
<li>è£…è½½ç›¸åº”åº“ -&gt; LoadLibrary(â€œkernel32.dllâ€)</li>
<li>è¯»å–IIDä¸­OFTæˆå‘˜ è·å–INTåœ°å€</li>
<li>é€ä¸€è¯»å–INTæ•°ç»„ä¸­çš„å€¼ è·å–ç›¸åº”IMAGE_IMPORT_BY_NAMEåœ°å€(RVA)</li>
<li>ä½¿ç”¨IIBNçš„Hint(ordinal)æˆ–Nameé¡¹ è·å¾—ç›¸åº”å‡½æ•°çš„èµ·å§‹åœ°å€</li>
<li>è¯»å–IIDçš„FT(IAT)æˆå‘˜ è·å¾—IATåœ°å€</li>
<li>å°†ä¸Šé¢è·å–çš„å‡½æ•°åœ°å€è¾“å…¥ç›¸åº”çš„IATæ•°ç»„å€¼</li>
<li>é‡å¤4-7 ç›´è‡³INTç»“æŸ(é‡åˆ°NULL)</li>
</ol>
<h2 id="13-5-3-ä½¿ç”¨notepad-exeç»ƒä¹ "><a href="#13-5-3-ä½¿ç”¨notepad-exeç»ƒä¹ " class="headerlink" title="13.5.3 ä½¿ç”¨notepad.exeç»ƒä¹ "></a>13.5.3 ä½¿ç”¨notepad.exeç»ƒä¹ </h2><p>é¦–å…ˆè¦æ˜ç¡® IMAGE_IMPORT_DECRIPTORç»“æ„ä½“ä¸åœ¨PEå¤´è€Œåœ¨PEä½“ä¸­ ä½†æŸ¥æ‰¾å…¶ä½ç½®çš„ä¿¡æ¯åœ¨PEå¤´ä¸­<br>å‰é¢æåˆ°è¿‡ NTå¤´ä¸­å¯é€‰å¤´æœ€åä¸€ä¸ªæˆå‘˜DataDirectoryçš„ [1]è®°å½•çš„å°±æ˜¯IMAGE_IMPORT_DECRIPTORç»“æ„ä½“çš„èµ·å§‹ä½ç½®(RVA)<br>å€¼ä¸º7604<br>RVA-&gt;RAW: ç¬¬ä¸€èŠ‚åŒº RAW&#x3D;0x7604-0x1000+0x400 &#x3D; 6A04<br>WinHEXä¸­æ‰¾åˆ° å¯ä»¥çœ‹åˆ°OFT(INT)çš„RVAå€¼ä¸º7990 -&gt; RAW: 6D90   Name RVA:7AAC -&gt; RAW:6EAC  FT(IAT) RVA:12C4-&gt; RAW:6C4<br>è·Ÿè¸ªNameå¯ä»¥çœ‹åˆ° comdlg.dllå­—ç¬¦ä¸²<br>è·Ÿè¸ªINT ç¬¬ä¸€ä¸ªå€¼ä¸º7A7A(RVA) -&gt; RAW:6E7A<br>INTæ˜¯IMAGE_IMPORT_BY_NAMEç»“æ„ä½“æŒ‡é’ˆæ•°ç»„ æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å‘å‡½æ•°çš„Ordinalå€¼000F å‡½æ•°çš„åç§°ä¸ºPageSetupDlgW<br>è·Ÿè¸ªIAT(RAW:6C4) æ‰¾åˆ°å¯¹åº”comdlg32.dllåº“</p>
<p>åœ¨OllyDbgä¸­æŸ¥çœ‹<br>è¯¥exeçš„ImageBaseæ˜¯01000000æ‰€ä»¥PageSetupDlgWå‡½æ•°çš„IATåœ°å€ä¸º010012C4 å…¶å€¼ä¸º75B83F20 æ˜¯APIçš„å‡†ç¡®èµ·å§‹åœ°å€<br>åœ¨ODä¸­è½¬åˆ°75B83F20å¯¹åº”çš„åæ±‡ç¼–å¯ä»¥çœ‹åˆ°æ­£æ˜¯å‡½æ•°å¼€å§‹çš„åœ°å€</p>
<p>IATçœŸçš„å¾ˆé‡è¦ï¼ è¿™äº›æ“ä½œè¦è‡ªå·±å¤šç»ƒæ‰èƒ½å¤Ÿç†Ÿæ‚‰<br>å°¤å…¶æ˜¯æ³¨æ„åˆ°IATçš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«ç¡¬ç¼–ç æˆ76324906 ä½†æ˜¯ODä¸­å®é™…åœ°å€åº”è¯¥æ˜¯75B83F20ï¼ï¼ æ‰€ä»¥è¦åˆ©ç”¨ImageBase+dllâ€™sIAT(RVA)æ¥æ‰¾!</p>
<h1 id="13-6-EAT"><a href="#13-6-EAT" class="headerlink" title="13.6 EAT"></a>13.6 EAT</h1><p>ç»§ç»­å­¦ä¹ EAT<br>EATä½¿å¾—ä¸åŒçš„åº”ç”¨ç¨‹åºå¯ä»¥è°ƒç”¨åº“æ–‡ä»¶ä¸­æä¾›çš„å‡½æ•° å¯¹åº”äºDLL&#x2F;SYS (IATå¯¹åº”äºexe)<br>åªæœ‰é€šè¿‡EATæ‰èƒ½å‡†ç¡®æ±‚å¾—ä»ç›¸åº”åº“ä¸­å¯¼å‡ºå‡½æ•°çš„èµ·å§‹åœ°å€<br>å¯¹åº” IMAGE_EXPORT_DIRECTORY PEæ–‡ä»¶ä¸­ä»…æœ‰ä¸€ä¸ªIMAGE_EXPORT_DIRECTORYç»“æ„ä½“</p>
<p>NTå¯é€‰å¤´çš„DataDirectory[0].VitrualAdddressçš„å€¼å³ä¸ºIEDç»“æ„ä½“æ•°ç»„çš„èµ·å§‹åœ°å€(RVA)<br>å†å¤ä¹ ä¸‹: DataDirectoryæœ‰ä¸¤ä¸ªDWORDæˆå‘˜ VitrualAddresså’ŒSize<br>ç”¨CFFå’ŒWinHexæŸ¥çœ‹<br>ExportDirectoryçš„RVAåç§»ä¸º168 å€¼ä¸º262C &#x3D;&gt; RAW:1A2C<br>EDçš„sizeåç§»ä¸º16C å€¼ä¸º6CFD</p>
<h2 id="13-6-1-IMAGE-EXPORT-DIRECTORY"><a href="#13-6-1-IMAGE-EXPORT-DIRECTORY" class="headerlink" title="13.6.1 IMAGE_EXPORT_DIRECTORY"></a>13.6.1 IMAGE_EXPORT_DIRECTORY</h2><p>ä¸‹é¢ä»‹ç»IMAGE_EXPORT_DIRECTORYç»“æ„ä½“ä¸­çš„é‡è¦æˆå‘˜</p>
<ul>
<li>NumberOfFunctions: å®é™…Exportå‡½æ•°çš„ä¸ªæ•°</li>
<li>NumberOfNames: Exportå‡½æ•°ä¸­å…·æœ‰åå­—çš„å‡½æ•°ä¸ªæ•°</li>
<li>AddressOfFunctions: Exportå‡½æ•°åœ°å€æ•°ç»„</li>
<li>AddressOfNames: å‡½æ•°åç§°åœ°å€æ•°ç»„</li>
<li>AddressOfNameOrdinals: Ordinalåœ°å€æ•°ç»„</li>
</ul>
<p>kernel32.dll:</p>
<p><img src="https://s2.loli.net/2023/12/04/qanN2eP5TIwLRBv.png" alt="img"></p>
<p>ä»åº“ä¸­è·å–å‡½æ•°åœ°å€çš„APIä¸ºGetProcAddress()å‡½æ•° è¯¥APIé€šè¿‡å¼•ç”¨EATæ¥è·å–æŒ‡å®šAPIçš„åœ°å€<br>GetProcAddress()æ“ä½œåŸç†:</p>
<ol>
<li>åˆ©ç”¨AddressOfNamesæˆå‘˜è½¬åˆ°å‡½æ•°åç§°æ•°ç»„</li>
<li>å‡½æ•°åç§°æ•°ç»„ä¸­å­˜å‚¨ç€å­—ç¬¦ä¸²çš„åœ°å€ é€šè¿‡strcmpæ¯”è¾ƒå­—ç¬¦ä¸² æŸ¥æ‰¾æŒ‡å®šå‡½æ•°çš„åç§°(æ­¤æ—¶æ•°ç»„ç´¢å¼•è®°ä¸ºname_index)</li>
<li>åˆ©ç”¨AddressOfNameOrdinalsæˆå‘˜ è½¬åˆ°ordinalæ•°ç»„</li>
<li>åœ¨ordinalæ•°ç»„ä¸­é€šè¿‡name_indexæŸ¥æ‰¾ç›¸åº”ordinalçš„å€¼</li>
<li>åˆ©ç”¨AddressOfFunctionsæˆå‘˜è½¬åˆ°å‡½æ•°åœ°å€æ•°ç»„(EAT)</li>
<li>åˆ©ç”¨4ä¸­æ±‚åˆ°çš„ordinalå€¼ä½œä¸ºæ•°ç»„ç´¢å¼• åœ¨EATä¸­è·å¾—æŒ‡å®šå‡½æ•°çš„èµ·å§‹åœ°å€</li>
</ol>
<h2 id="13-6-2-ä½¿ç”¨kernel32-dllç»ƒä¹ "><a href="#13-6-2-ä½¿ç”¨kernel32-dllç»ƒä¹ " class="headerlink" title="13.6.2 ä½¿ç”¨kernel32.dllç»ƒä¹ "></a>13.6.2 ä½¿ç”¨kernel32.dllç»ƒä¹ </h2><p>ç»ƒä¹ ä»kernel32.dllæ–‡ä»¶çš„EATä¸­æŸ¥æ‰¾AddAtomWå‡½æ•°<br>å‰é¢è®¡ç®—è¿‡IMAGE_EXPORT_DIRECTORYçš„RAWåç§»ä¸º1A2C(CFFå¥½åƒè½¬åˆ°è¾“å‡ºç›®å½•ç›´æ¥å°±èƒ½çœ‹)<br>WinHexä¸­æ‰¾åˆ°<br>AddressOfName: offset:1A4C å€¼:3538(RVA) -&gt; RAW:2938<br>æ‰¾æ‰“ç¬¬ä¸‰ä¸ªåœ°å€: 4BB3(RVA) -&gt; RAW:3FB3<br>æ‰¾åˆ°æŸ¥çœ‹ ç¡®å®æ˜¯AddAtomwçš„å­—ç¬¦ä¸²!</p>
<p>åŒæ ·å¯ä»¥æŸ¥åˆ°AddAtomWå¯¹åº”çš„ordinal&#x3D;2(å¯¹åº”æ•°ç»„ç¬¬3ä¸ªå…ƒç´ )<br>æœ€åæŸ¥æ‰¾AddAtomWçš„å®é™…å‡½æ•°åœ°å€<br>AddressOfFunctions: RAW:1A48 å€¼ 2654(RVA) -&gt; RAW:1A54<br>è¿™æ˜¯æ•°ç»„èµ·å§‹ä½ç½® æˆ‘ä»¬å·²çŸ¥ordinalä¸º2 æ‰€ä»¥æ‰¾ç¬¬ä¸‰ä¸ª å¯¹åº”åœ°å€1A5C å¾—åˆ°çš„å€¼:0326D9(RVA)<br>è¿™é‡Œçš„RVAæ˜¯ç›¸å¯¹kernel32.dllçš„ImageBaseçš„<br>åœ¨NTå¯é€‰å¤´æŸ¥çœ‹ImageBaseçš„å€¼: 7C800000 æ‰€ä»¥ AddAtomWå‡½æ•°çš„VAå€¼ä¸ºRVA+IB &#x3D; 7C8326D9<br>åœ¨ODä¸­æŸ¥çœ‹éªŒè¯(ç„¶è€Œæˆ‘ç”¨ODæ‰“å¼€çœ‹ä¸åˆ°è¿™æ®µçš„å†…å­˜â€¦)<br>ç”¨IDAæ‰“å¼€ä¸€æ · æ‰¾åˆ°è¿™ä¸ªåœ°å€<br><img src="https://s2.loli.net/2023/12/04/sgUdRnqeV8HJ9Ic.png" alt="img"></p>
<p>å¯ä»¥çœ‹åˆ°ç¡®å®å°±æ˜¯AddAtomwå‡½æ•°çš„åœ°å€ï¼ï¼ï¼</p>
<hr>
<p>ç¬¬ä¸€éçœ‹çš„æ—¶å€™åªæ˜¯è¿‡äº†ä¸€éæ¦‚å¿µ æ²¡æœ‰è·Ÿç€ä¹¦ä¸Šä¸€èµ·ç®—RVA-&gt;RAWåœ¨winhexä¸­æ¥æ‰¾å¯¹åº”å€¼ ä¹Ÿæ²¡æœ‰å¼€ODæ¥çœ‹<br>å®æ“ä¸€éæ”¶è·è¿˜æ˜¯æŒºå¤šçš„ PEæ–‡ä»¶æ ¼å¼æ˜¯é‡ä¸­ä¹‹é‡ï¼ä¸€å®šè¦åå¤çœ‹~ï¼</p>
]]></content>
      <categories>
        <category>ReverseEngineering</category>
      </categories>
  </entry>
  <entry>
    <title>Complex RSA</title>
    <url>/2023/12/03/Complex-RSA/</url>
    <content><![CDATA[<p>å¤æ•°RSA</p>
<span id="more"></span>
<p>åœ¨GeekGame2023é‡åˆ°äº†å¤æ•°RSAçš„æ¦‚å¿µ æŒºæœ‰æ„æ€çš„(orz) è®°å½•ä¸€ä¸‹</p>
<h2 id="å¤æ•°åŸŸä¸Šçš„rsa-demo"><a href="#å¤æ•°åŸŸä¸Šçš„rsa-demo" class="headerlink" title="å¤æ•°åŸŸä¸Šçš„rsa demo"></a>å¤æ•°åŸŸä¸Šçš„rsa demo</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,lcm,is_prime</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">2047</span>)</span><br><span class="line"></span><br><span class="line">f = (<span class="number">378122348642214690905411683807377396279362526734068034297186493255873563264253248095197659138069664908850853277799239471404715546747080714581633876343291058815268009173602365587463522797812239900814474973941995698621021680129530453282192603316731832323767320307650941745085796583822798379896337325L</span>, <span class="number">205549984221850341303682190742446959375043769671555741781145106776498798455293849755553794941345135675348633855787880355726112506553703853175271830126908219803257875131387292937296039523359975622001865593227631119497003599166091642640101746534401068507972834895023584843991641629874709898672559632L</span>)</span><br><span class="line">e = <span class="number">59107</span></span><br><span class="line">p = <span class="number">228517792080140341</span></span><br><span class="line">q = <span class="number">1675909164550923263854591345270445396052847869117231939809062226222204253885693425526434134321712288675268468398852452684029376569327518089966506865838909486699078280423099271324646863671350838232140981094611254627738568184261530942469845202934677427234062382272736609418198352717</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cadd</span>(<span class="params">a,b,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (a[<span class="number">0</span>]+b[<span class="number">0</span>]%n,a[<span class="number">1</span>]+b[<span class="number">1</span>]%n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmul</span>(<span class="params">a,b,n</span>):</span><br><span class="line">    <span class="keyword">return</span> ((a[<span class="number">0</span>]*b[<span class="number">0</span>]-a[<span class="number">1</span>]*b[<span class="number">1</span>])%n,(a[<span class="number">0</span>]*b[<span class="number">1</span>]+a[<span class="number">1</span>]*b[<span class="number">0</span>])%n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cpow</span>(<span class="params">a,k,n</span>):</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">if</span>(k%<span class="number">2</span>==<span class="number">0</span>):</span><br><span class="line">        a=cmul(a,a,n)</span><br><span class="line">        <span class="keyword">return</span> cpow(a,k/<span class="number">2</span>,n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> cmul(a,cpow(cmul(a,a,n),(k-<span class="number">1</span>)/<span class="number">2</span>,n),n)</span><br><span class="line"></span><br><span class="line">o=lcm((p*p-<span class="number">1</span>),(q*q-<span class="number">1</span>))</span><br><span class="line">fm=cpow(f,invert(e,o),n)</span><br><span class="line"><span class="built_in">print</span>(fm)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¤æ•°ä¸­çš„æ¬§æ‹‰å‡½æ•°</p>
<ul>
<li>phi(p) &#x3D; p^2 - 1</li>
<li>phi(q) &#x3D; q^2 - 1</li>
<li>phi(n) &#x3D; phi(p) * phi(q)</li>
</ul>
<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="2023æå®¢å¤§æŒ‘æˆ˜-EzComplex"><a href="#2023æå®¢å¤§æŒ‘æˆ˜-EzComplex" class="headerlink" title="2023æå®¢å¤§æŒ‘æˆ˜-EzComplex"></a>2023æå®¢å¤§æŒ‘æˆ˜-EzComplex</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage9.3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;FAKE&#123;Do_You_know_Complex_numbers&#125;&#x27;</span></span><br><span class="line">p = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">384</span>)</span><br><span class="line">q = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">384</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">2</span>) + <span class="built_in">pow</span>(q, <span class="number">2</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line"><span class="string">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>N &#x3D; p^2 + q^2 &#x3D; (p+qi) * (p-qi)<br>åœ¨å¤æ•°åŸŸä¸Šåˆ†è§£N éå†å…¶å› å­å°±èƒ½å¾—åˆ°p,q<br>ä¸€äº›sageç”¨æ³•è¯´æ˜:</p>
<ul>
<li>ZZ(i)[N]: åˆ›å»ºäº†ä¸€ä¸ªæ•´æ•°é«˜æ–¯ç¯</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">N = <span class="number">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line">zn = ZZ[i](N)</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> divisors(zn):</span><br><span class="line">    p, q = <span class="built_in">int</span>(d[<span class="number">0</span>]), <span class="built_in">int</span>(d[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> is_prime(p) <span class="keyword">and</span> is_prime(q) <span class="keyword">and</span> p.bit_length()&gt;<span class="number">300</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;p= <span class="subst">&#123;p&#125;</span>\nq= <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line">p= <span class="number">8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707</span></span><br><span class="line">q= <span class="number">29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> *</span><br><span class="line">d = modinv(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D0_you_like_r41n?_i_pref3r_R1_ng&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="æœªçŸ¥æ¥æº"><a href="#æœªçŸ¥æ¥æº" class="headerlink" title="æœªçŸ¥æ¥æº"></a>æœªçŸ¥æ¥æº</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, totient</span><br><span class="line"><span class="comment"># where totient is a function used to calculate phi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, re, im</span>):</span><br><span class="line">        self.re = re</span><br><span class="line">        self.im = im</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, c</span>):</span><br><span class="line">        re_ = self.re * c.re - self.im * c.im</span><br><span class="line">        im_ = self.re * c.im + self.im * c.re</span><br><span class="line">        <span class="keyword">return</span> Complex(re_, im_)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>([self.re, self.im])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">complex_pow</span>(<span class="params">c, exp, n</span>):</span><br><span class="line">    result = Complex(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> exp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> exp &amp; <span class="number">1</span>:</span><br><span class="line">            result = result * c</span><br><span class="line">            result.re = result.re % n</span><br><span class="line">            result.im = result.im % n</span><br><span class="line">        c = c * c</span><br><span class="line">        c.re = c.re % n</span><br><span class="line">        c.im = c.im % n</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, length</span>):</span><br><span class="line">    pad_length = length - <span class="built_in">len</span>(msg) - <span class="number">1</span></span><br><span class="line">    pad_data = os.urandom(pad_length)</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> + pad_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unpad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg.split(<span class="string">b&quot;\x00&quot;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">bits = <span class="number">512</span></span><br><span class="line">p = getPrime(bits)</span><br><span class="line">q = getPrime(bits)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">sha_flag = hashlib.sha256(flag).digest()</span><br><span class="line"></span><br><span class="line">m1 = Complex(</span><br><span class="line">        <span class="built_in">int</span>.from_bytes(sha_flag[:<span class="built_in">len</span>(sha_flag)//<span class="number">2</span>], <span class="string">&quot;big&quot;</span>),</span><br><span class="line">        <span class="built_in">int</span>.from_bytes(sha_flag[<span class="built_in">len</span>(sha_flag)//<span class="number">2</span>:], <span class="string">&quot;big&quot;</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">m2 = Complex(</span><br><span class="line">        <span class="built_in">int</span>.from_bytes(pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>], bits//<span class="number">4</span>-<span class="number">1</span>), <span class="string">&quot;big&quot;</span>),</span><br><span class="line">        <span class="built_in">int</span>.from_bytes(pad(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:], bits//<span class="number">4</span>-<span class="number">1</span>), <span class="string">&quot;big&quot;</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">phi = totient(p, q)</span><br><span class="line">e = q * inverse(p, phi)</span><br><span class="line">c1 = complex_pow(m1, e, n)</span><br><span class="line">c2 = complex_pow(m2, e, n)</span><br><span class="line"></span><br><span class="line">c1.show()</span><br><span class="line">c2.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[90554536599623574119664951128649936419332926063696768860765928746438458550068553748440108394673303800443215316190882880737918820592384729010491685487061658710808286341751196450604089438847354206384322610922839055308138101241906861635339635907663440043442187064090630207952625897567214431195621589834131462698, 9144096375153318849308858335764188418198064372272913164911615933938183103747900881824918069830188301084043148828961577193063557255905230182831945580084452509300200269659063051152684191139872067872645370760797859584822240361290678189844670289832298393156571913616456958845361092243648857334156534377833472900]</span></span><br><span class="line"><span class="string">[62925714576233017213228404230949787334346543378320798964656732359587152905032848271156799538355748406136742979043729040728123730886381468564779041856310262770766050213464073568850702827835472680885186487027698395099598698463717279017013124488699475168052581476224742146967412904416266652605031934025266540003, 62818668456104375760667670741457826560706388018921820295286033114468271151921637926389738844622672202424650967678199715932465104135980734708459543588178208672956785650944371545080965650112025782049517299538052360417245732776384089052839997333049599655001615752078742624898059780909287845495731050387891926520]</span></span><br><span class="line"><span class="string">n = 94040393367054633265453751757391098049234338193258976478647369399924701067077628840760704857546243644552533845934146003988635403227234096447871132283820920489003286967145732739404245319615714787916756200564828237043658350145929927911058782352154997346295194977765305107634012698472977467843980475009837261877</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè®¡ç®—p,qçš„phiæ˜¯å¤æ•°åŸŸä¸Šçš„è®¡ç®—æ–¹å¼:</p>
<ul>
<li>phi(p) &#x3D; p^2 - 1</li>
<li>phi(q) &#x3D; q^2 - 1</li>
<li>phi(n) &#x3D; phi(p) * phi(q)</li>
</ul>
<p><img src="https://s2.loli.net/2023/12/03/SetLslk9bdAMVp4.png" alt="img"></p>
<p>è¦æ—¶åˆ»è®°ä½phi(x) &#x3D; x^2 - 1</p>
<p>ç„¶å c1^n - m &#x3D; k1 * q<br>ç”±äºmä¸º128bits å®Œå…¨å¯ä»¥åœ¨modnä¸‹copperæ±‚å‡ºm!(æ›´æ–°äº†cooperçš„ç”¨æ³• ä»¥å‰åªä¼šç”¨æ¥å•ç‹¬æ±‚p,q å…¶å®å®ƒæ‰¾çš„æ˜¯æ¨¡nçš„ä¸€ä¸ªå› å­çš„æ„ä¹‰ä¸‹ä¸º0çš„æ ¹ å®Œå…¨å¯ä»¥ç”¨æ¥è§£kp,kqçš„æƒ…å†µ)</p>
<p>è¿™é‡Œæˆ‘ä»¬è¦è‡ªå·±åŠ ä¸€ä¸ªè¿”å›å®éƒ¨è™šéƒ¨çš„å‡½æ•° ä¸ç„¶è¿”å›çš„æ˜¯ä¸€ä¸ªComplexå¯¹è±¡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, re, im</span>):</span><br><span class="line">        self.re = re</span><br><span class="line">        self.im = im</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, c</span>):</span><br><span class="line">        re_ = self.re * c.re - self.im * c.im</span><br><span class="line">        im_ = self.re * c.im + self.im * c.re</span><br><span class="line">        <span class="keyword">return</span> Complex(re_, im_)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>([self.re, self.im])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_value</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.re,self.im</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">complex_pow</span>(<span class="params">c, exp, n</span>):</span><br><span class="line">    result = Complex(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> exp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> exp &amp; <span class="number">1</span>:</span><br><span class="line">            result = result * c</span><br><span class="line">            result.re = result.re % n</span><br><span class="line">            result.im = result.im % n</span><br><span class="line">        c = c * c</span><br><span class="line">        c.re = c.re % n</span><br><span class="line">        c.im = c.im % n</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1 = [<span class="number">90554536599623574119664951128649936419332926063696768860765928746438458550068553748440108394673303800443215316190882880737918820592384729010491685487061658710808286341751196450604089438847354206384322610922839055308138101241906861635339635907663440043442187064090630207952625897567214431195621589834131462698</span>, <span class="number">9144096375153318849308858335764188418198064372272913164911615933938183103747900881824918069830188301084043148828961577193063557255905230182831945580084452509300200269659063051152684191139872067872645370760797859584822240361290678189844670289832298393156571913616456958845361092243648857334156534377833472900</span>]</span><br><span class="line">c2 = [<span class="number">62925714576233017213228404230949787334346543378320798964656732359587152905032848271156799538355748406136742979043729040728123730886381468564779041856310262770766050213464073568850702827835472680885186487027698395099598698463717279017013124488699475168052581476224742146967412904416266652605031934025266540003</span>, <span class="number">62818668456104375760667670741457826560706388018921820295286033114468271151921637926389738844622672202424650967678199715932465104135980734708459543588178208672956785650944371545080965650112025782049517299538052360417245732776384089052839997333049599655001615752078742624898059780909287845495731050387891926520</span>]</span><br><span class="line">n = <span class="number">94040393367054633265453751757391098049234338193258976478647369399924701067077628840760704857546243644552533845934146003988635403227234096447871132283820920489003286967145732739404245319615714787916756200564828237043658350145929927911058782352154997346295194977765305107634012698472977467843980475009837261877</span></span><br><span class="line"></span><br><span class="line">c1 = Complex(c1[<span class="number">0</span>],c1[<span class="number">1</span>])</span><br><span class="line">c2 = Complex(c2[<span class="number">0</span>],c2[<span class="number">1</span>])</span><br><span class="line">c1n = complex_pow(c1,n,n).get_value()</span><br><span class="line"></span><br><span class="line"><span class="comment"># PR.&lt;m1&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="comment"># f = c1n - m1</span></span><br><span class="line"><span class="comment"># f = f.monic()</span></span><br><span class="line"><span class="comment"># m_1 = f.small_roots(X=2^128,beta=0.4)[0]</span></span><br><span class="line"><span class="comment"># q = gcd(c1n-m_1,n)</span></span><br><span class="line"><span class="comment"># p = n//q</span></span><br><span class="line"><span class="comment"># assert p*q == n</span></span><br><span class="line"><span class="comment"># print(f&#x27;p= &#123;p&#125;\nq= &#123;q&#125;&#x27;)</span></span><br><span class="line">q = <span class="number">7323077971059291689707065981399299595305255699400528762823657455799263529156562060157257164843406722707105788120169666250562251092133204672454047510142903</span></span><br><span class="line">p = <span class="number">12841648517017166445551091061211185386388830485650207877732791165106786665791893519935905079260599145467726270747052676462914579177741552378246815211750259</span></span><br><span class="line">phi = (p**<span class="number">2</span>-<span class="number">1</span>)*(q**<span class="number">2</span>-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line">e = modinv(p,phi)*q%phi</span><br><span class="line">d = modinv(e,phi)</span><br><span class="line">m = complex_pow(c2,d,n).get_value()</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m[<span class="number">0</span>])),n2s(<span class="built_in">int</span>(m[<span class="number">1</span>])))</span><br></pre></td></tr></table></figure>
<p>æœ€å<strong>flag</strong>: flag{3ef6db06-b837-11ed-9825-00155dfcdef9}</p>
<p>æ€»ç»“ä¸€ä¸‹:<br>å…³é”®çŸ¥è¯†ç‚¹: å¤æ•°åŸŸä¸‹phiçš„ä¸åŒ<br>ä¸å¸¸è§„RSAçš„ç»“åˆ: éƒ½æœ‰ de&#x3D;kphi+1 éƒ½æœ‰coopersmithç­‰æ”»å‡»æ–¹æ³•<br>é€šè¿‡è¿™é“é¢˜å­¦ä¹ åˆ°å¤æ•°RSAçš„åŒæ—¶ è¿˜æ›´æ–°äº†cooperæ±‚kp,kqï¼</p>
]]></content>
      <categories>
        <category>CTF-Crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023æå®¢å¤§æŒ‘æˆ˜ Crpyto</title>
    <url>/2023/12/03/2023%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Crpyto/</url>
    <content><![CDATA[<p>æ²¡å‚åŠ æ¯”èµ› è·Ÿç€å…¶ä»–å¸ˆå‚…çš„åšå®¢å¤ç°ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›é¢˜ç›®</p>
<span id="more"></span>

<h2 id="OTPTwice"><a href="#OTPTwice" class="headerlink" title="OTPTwice"></a>OTPTwice</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># step0: key generation &amp; distribution</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s0</span>(<span class="params">msg</span>): </span><br><span class="line">    k1,k2 = [urandom(<span class="built_in">len</span>(msg)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">    <span class="keyword">return</span> k1,k2 </span><br><span class="line"></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step1: Alice encrypt M, and send it to Bob</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s1</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c1 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step2: Bob encrypt c1, and send it to Alice </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    c2 = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> c2 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step3: Alice decrypt c2, and send it to Bob.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s3</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c3 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c3 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step4: Bob decrypt c3, get M.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s4</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    m_ = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> m_ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg,k1,k2</span>): </span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">assert</span> msg == m_</span><br><span class="line"></span><br><span class="line"><span class="comment"># Here&#x27;s what hacker Eve got:</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_</span>(<span class="params">msg,k1,k2</span>):</span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">if</span> HACK == <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(c1) </span><br><span class="line">        <span class="built_in">print</span>(c2) </span><br><span class="line">        <span class="built_in">print</span>(c3) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k1,k2 = s0(flag) </span><br><span class="line">encrypt_(flag,k1,k2) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line"><span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>emmm çœ‹ç€OTPæˆ‘å°±è®°ä¸‹æ¥äº† â€¦<br>åˆ†æä¸€ä¸‹<br><code>c1 = msg xor k1</code><br><code>c2 = c1 xor k2</code><br><code>c3 = c2 xor k1</code><br>é¢˜ç›®è¿˜è´´å¿ƒåœ°å‘Šè¯‰äº†æˆ‘ä»¬ <code>_m = c3 xor k2 = msg</code><br>ç›´æ¥è§£:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c1 = <span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line">c2 = <span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line">c3 = <span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"></span><br><span class="line">k2 = xor(c1,c2)</span><br><span class="line">flag = xor(c3,k2)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># SYC&#123;I_l0v3_Crypt0&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="OldAlgorithm"><a href="#OldAlgorithm" class="headerlink" title="OldAlgorithm"></a>OldAlgorithm</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+os.urandom(padlen-<span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = pad(flag,<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">p = [getPrime(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)] </span><br><span class="line">c = [bytes_to_long(flag)%i <span class="keyword">for</span> i <span class="keyword">in</span> p] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</span></span><br><span class="line"><span class="string">c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯CRT å°±å½“å¤ä¹ ä¸‹sageç”¨æ³•äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p= [<span class="number">58657</span>, <span class="number">47093</span>, <span class="number">47963</span>, <span class="number">41213</span>, <span class="number">57653</span>, <span class="number">56923</span>, <span class="number">41809</span>, <span class="number">49639</span>, <span class="number">44417</span>, <span class="number">38639</span>, <span class="number">39857</span>, <span class="number">53609</span>, <span class="number">55621</span>, <span class="number">41729</span>, <span class="number">60497</span>, <span class="number">44647</span>, <span class="number">39703</span>, <span class="number">55117</span>, <span class="number">44111</span>, <span class="number">57131</span>, <span class="number">37747</span>, <span class="number">63419</span>, <span class="number">63703</span>, <span class="number">64007</span>, <span class="number">46349</span>, <span class="number">39241</span>, <span class="number">39313</span>, <span class="number">44909</span>, <span class="number">40763</span>, <span class="number">46727</span>, <span class="number">34057</span>, <span class="number">56333</span>]</span><br><span class="line">c= [<span class="number">36086</span>, <span class="number">4005</span>, <span class="number">3350</span>, <span class="number">23179</span>, <span class="number">34246</span>, <span class="number">5145</span>, <span class="number">32490</span>, <span class="number">16348</span>, <span class="number">13001</span>, <span class="number">13628</span>, <span class="number">7742</span>, <span class="number">46317</span>, <span class="number">50824</span>, <span class="number">23718</span>, <span class="number">32995</span>, <span class="number">7640</span>, <span class="number">10590</span>, <span class="number">46897</span>, <span class="number">39245</span>, <span class="number">16633</span>, <span class="number">31488</span>, <span class="number">36547</span>, <span class="number">42136</span>, <span class="number">52782</span>, <span class="number">31929</span>, <span class="number">34747</span>, <span class="number">29026</span>, <span class="number">18748</span>, <span class="number">6634</span>, <span class="number">9700</span>, <span class="number">8126</span>, <span class="number">5197</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(CRT_list[c,p])</span></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="number">37699681561344853433172597523387281471904607566697320008840601281159457436694</span></span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(flag)))</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;CRT_1s_s0_ju1cy!&#125;]mC\x9c\xf9C/\xfc\xb8t\x16&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e1,e2 = [getPrime(<span class="number">17</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q </span><br><span class="line">c1 = gmpy2.powmod(<span class="number">2</span>*p + <span class="number">3</span>*q,e1,n)</span><br><span class="line">c2 = gmpy2.powmod(<span class="number">5</span>*p + <span class="number">7</span>*q,e2,n) </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1=&quot;</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2=&quot;</span>,e2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#e1= 113717</span></span><br><span class="line"><span class="comment">#e2= 80737</span></span><br><span class="line"><span class="comment">#c1= 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line"><span class="comment">#c2= 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line"><span class="comment">#c= 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line"><span class="comment">#n= 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è§‚å¯Ÿé¢˜ç›®ç»™çš„ä¸¤ä¸ªå¤šé¡¹å¼ éƒ½æ˜¯p,qçº¿æ€§ç»„åˆçš„å½¢å¼ é‚£ä¹ˆmodnçš„è¯å°±å¯ä»¥æŠŠäº¤å‰é¡¹æ¶ˆæ‰<br>è¿™ç§è·Ÿç¾ŠåŸæ¯æœ‰ä¸€é“ä¸€æ¨¡ä¸€æ ·<br>å±•æˆåªæœ‰p,qå¹‚æ¬¡çš„ä¸¤ä¸ªå¼å­åˆ†åˆ«e2,e1æ¬¡æ–¹<br>ç„¶åä¹˜å¯¹åº”ç³»æ•°æ¶ˆå…ƒ æ±‚ä¸ªgcdå³å¯åˆ†è§£n</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e1= <span class="number">113717</span></span><br><span class="line">e2= <span class="number">80737</span></span><br><span class="line">c1= </span><br><span class="line">c2= </span><br><span class="line">c= </span><br><span class="line">n= </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">kq = (<span class="built_in">pow</span>(c1,e2,n)*<span class="built_in">pow</span>(<span class="number">5</span>,e1*e2,n)-<span class="built_in">pow</span>(c2,e1,n)*<span class="built_in">pow</span>(<span class="number">2</span>,e1*e2,n))</span><br><span class="line">q = gcd(kq,n)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">p = n//q</span><br><span class="line"><span class="keyword">assert</span> p*q == n</span><br><span class="line">d = modinv(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;poly_rsa_Just_need5_s1mple_gcd&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Simple3DES"><a href="#Simple3DES" class="headerlink" title="Simple3DES"></a>Simple3DES</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+<span class="built_in">chr</span>((padlen-(<span class="built_in">len</span>(msg)%padlen))).encode()*(padlen-(<span class="built_in">len</span>(msg)%padlen))</span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">sec = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg,key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = long_to_bytes(key)</span><br><span class="line">        msg = xor(long_to_bytes(msg),sec)</span><br><span class="line">        des = DES3.new(key,DES3.MODE_ECB)</span><br><span class="line">        ct = xor(des.encrypt(pad(msg,<span class="number">8</span>)),sec)</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(ct)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">return</span> Exception</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">service</span>():</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit()</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Simple DES Encryption Service&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="keyword">while</span> cnt&lt;<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;1. Encrypt\n2. Get encrypted flag.&#x27;</span>)</span><br><span class="line">        choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input msg:&#x27;</span>)</span><br><span class="line">            msg = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(msg,key))</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(bytes_to_long(flag),key))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exit()</span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bye!&#x27;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    service()</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure>

<p>æ²¡é¶æœº å°±å•çº¯å­¦ä¹ ä¸€ä¸‹å§~ (æœ€è¿‘è¦æ¶è¡¥äº¤äº’é¢˜ :(  ğŸ«¥qaq )<br>é¢˜ç›®ç»™äº†ä¸ª<a href="https://blog.csdn.net/Mr_wzc/article/details/121713518" target = "_blank">å­¦ä¹ é“¾æ¥ </a><br>é¢˜ç›®ä¸­åœ¨3DESåŠ å¯†ç»“æŸåè¿˜æœ‰ä¸ª <code>ct = xor(des.encrypt(pad(msg,8)),sec)</code> å†xoräº†ä¸€æ¬¡</p>
<h3 id="Solution1"><a href="#Solution1" class="headerlink" title="Solution1"></a>Solution1</h3><p>å­¦ä¹ åˆ°äº†ä¸€ä¸ªæ–°çŸ¥è¯†:DESå¼±å¯†é’¥ <a href="https://lightless.me/archives/DES-Weak-Keys.html">https://lightless.me/archives/DES-Weak-Keys.html</a><br>ç”¨è¿™äº›å¼±å¯†é’¥åŠ å¯†ä¼šå¯¼è‡´</p>
<ul>
<li>æ˜æ–‡è¿ç»­åŠ å¯†ä¸¤æ¬¡ä»ç„¶æ˜¯æ˜æ–‡</li>
<li>å¯†æ–‡è¿ç»­è§£å¯†ä¸¤æ¬¡ä»ç„¶æ˜¯å¯†æ–‡</li>
</ul>
<p>é‚£ä¹ˆåˆ©ç”¨3DESä¸€ä¸ªä¸‰æ¬¡æ“ä½œ åŠ å¯†-è§£å¯†-åŠ å¯†   è§£å¯†-åŠ å¯†-è§£å¯†<br>åªè¦æ„é€  <code>key1=key3</code><br>ç¬¬ä¸€æ¬¡äº¤äº’é€‰æ‹© 2:</p>
<ul>
<li>enc(flag,k1)</li>
<li>dec(flag,k2)</li>
<li>enc(flag,k3)</li>
<li>xor(flag,sec)</li>
</ul>
<p>è¿™æ ·ç›¸å½“äºå¾—åˆ°çš„æ˜¯ encflag &#x3D; dec(flag,k2)^sec çš„å€¼</p>
<p>ç¬¬äºŒæ¬¡äº¤äº’é€‰æ‹© 1:</p>
<ul>
<li>enc(encflag,k1)</li>
<li>dec(encflag,k2)</li>
<li>enc(encflag,k3)</li>
<li>xor(encflag,sec)</li>
</ul>
<p>è¿™æ ·å°±å¾—åˆ° dec(dec(flag,k2),k2)^sec^sec &#x3D; flag</p>
<p>è¿™é‡Œé€‰æ‹© å¼±å¯†é’¥æ‹¼æ¥æˆkey (å…¶å®æˆ‘æœ€å¼€å§‹æƒ³çš„ä¸‰ä¸ªkeyå…¨å–ä¸€æ ·ä¹Ÿè¡Œ åªæ˜¯è¦é€‰æ‹©å¼±å¯†é’¥æ¥æ‹¼æ¥)<br><code>key = b&quot;\x01\x01\x01\x01\x01\x01\x01\x01&quot;+b&quot;\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE&quot;+b&quot;\x01\x01\x01\x01\x01\x01\x01\x01&quot;</code></p>
<h3 id="Solution2"><a href="#Solution2" class="headerlink" title="Solution2"></a>Solution2</h3><p>æ³¨æ„åˆ°åŠ å¯†çš„æ—¶å€™å¯¹msgè¿›è¡Œäº†padå¡«å……<br>æˆ‘ä»¬å‘é€ä¸€ä¸ªç©ºå­—ç¬¦ä¸²è¿‡å»æ—¶</p>
<ul>
<li>sec + bâ€™\x08â€™*8</li>
<li>3DES</li>
<li>xor sec</li>
</ul>
<p>åˆ©ç”¨<code>enc[-8:]</code>æ˜¯3DES(bâ€™\x08â€™*8) xor sec è¿™ä¸€ç‚¹ä¾¿å¯ä»¥åè§£å‡º sec</p>
<p>æ€»ç»“ä¸€ä¸‹å…¶å®å¥½å¤šä¸DES&#x2F;AESç›¸å…³çš„äº¤äº’é¢˜ç ´é¢˜ç‚¹å¸¸å¸¸åœ¨paddingä¸Š (Do not leak your padding status !)</p>
<h2 id="Energetic-Carcano"><a href="#Energetic-Carcano" class="headerlink" title="Energetic_Carcano"></a>Energetic_Carcano</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># from sage.all import *</span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span> </span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">pbits = <span class="number">120</span></span><br><span class="line">abp = <span class="string">&quot;abp&quot;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">a,b,p,turn,ans</span>):</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;a&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(a) == ans </span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;b&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(b) == ans</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;p&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(p) == ans  </span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nHi Crypto-ers! AL3XEI here. I know you are excellent at math, so I prepared a game for u.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;In the equation y^2 = x^3+ a*x + b (mod p), 4 points are given. Plz give me the right a, b or p to contine the game.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Good Luck!\n&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        turn = random.choice(abp) </span><br><span class="line">        p = getPrime(pbits) </span><br><span class="line">        a,b = [next_prime(random.randint(<span class="number">2</span>,p)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>] </span><br><span class="line">        curve = EllipticCurve(GF(p),[a,b]) </span><br><span class="line">        pts = [curve.random_point() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        pts = [(_[<span class="number">0</span>], _[<span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> pts] </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> pts:</span><br><span class="line">            <span class="built_in">print</span>(_,end=<span class="string">&quot; &quot;</span>) </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\nGive me &#x27;</span>+turn+<span class="string">&quot; :&quot;</span>) </span><br><span class="line">        ans = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)) </span><br><span class="line">        <span class="keyword">if</span> check(a,b,p,turn,ans):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Good! Next challenge-&gt;\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            pbits+=<span class="number">5</span>  </span><br><span class="line">            <span class="keyword">continue</span> </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">            exit() </span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®å¤§æ„ï¼š10è½® æ¯æ¬¡ç»™ä¸€æ¡æœªçŸ¥å‚æ•°æ¤­åœ†æ›²çº¿ä¸Šçš„4ä¸ªç‚¹ è¦æ±‚è¿˜åŸå‚æ•°</p>
<p>æˆ‘çš„ç¬¬ä¸€æ€è·¯æ˜¯sageèƒ½ç›´æ¥æ±‚å—? æŠŠåŒä½™å†™æˆç­‰å¼åˆšå¥½å››ä¸ªæ–¹ç¨‹å››ä¸ªæœªçŸ¥æ•° è‚¯å®šæ˜¯èƒ½è§£çš„ :(<br>ç”±äºæ²¡æœ‰ç¯å¢ƒä¹Ÿä¸çŸ¥é“èƒ½ä¸èƒ½æˆ ç„äº†çœ¼å¸ˆå‚…çš„WP æç¤ºç”¨ç±»ä¼¼LCGçš„æ–¹æ³•<br>é‚£ä¹ˆé¦–å…ˆè¿˜åŸp<br>åˆ†åˆ«å–1,2 1,3 1,4 2,3 å››ç»„ç­‰å¼<br>æ¯ç»„å†…ä½œå·®æ¶ˆå»b ç§»é¡¹å¾—åˆ°açš„è¡¨è¾¾å¼<br>å†ä¸¤ç»„è”ç«‹æ¶ˆæ‰a è¿™æ ·å¾—åˆ°ä¸¤ç»„åŒä½™0 modpçš„æ–¹ç¨‹<br>æ±‚gcdå³å¯å¾—åˆ°p<br>ç„¶åè¿˜åŸa,bå°±ç®€å•äº†</p>
<h2 id="Just-need-One"><a href="#Just-need-One" class="headerlink" title="Just need One"></a>Just need One</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>)</span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==DEBUG MODE==&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    parms = [random.getrandbits(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)] </span><br><span class="line">    res = res = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Give me x calculating f(x) :\n&gt; &#x27;</span>))  </span><br><span class="line">    <span class="keyword">if</span> res &gt;= <span class="number">2</span>**<span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Give me something smaller.\n&quot;</span>)  </span><br><span class="line">        <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">        exit() </span><br><span class="line"></span><br><span class="line">    cnt = <span class="number">0</span>  </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>): </span><br><span class="line">        cnt += <span class="built_in">pow</span>(res,_)*parms[_]  </span><br><span class="line">    <span class="built_in">print</span>(cnt) </span><br><span class="line">    ans = <span class="built_in">input</span>(<span class="string">&#x27;Give me Coefficients :\n&gt; &#x27;</span>) </span><br><span class="line">    ans = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ans.split(<span class="string">&quot;,&quot;</span>)] </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ans == parms:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)  </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®çš„æ„æ€æ˜¯ç”Ÿæˆäº†ä¸€ä¸ª127æ¬¡å¤šé¡¹å¼ æˆ‘ä»¬å¯ä»¥ç»™ä¸€ä¸ª<code>&lt;=2^32</code>çš„æ•°ä½œä¸ºx<br>èƒ½çŸ¥é“f(x)çš„å€¼ åæ¨æ‰€æœ‰ç³»æ•°</p>
<p>å…¶å®é¢˜ç›®é‚£ä¸ªcheckå¤§å°çš„é™åˆ¶å·²ç»å¾ˆæ˜ç¡®çš„æç¤ºæ€è·¯äº† æˆ‘ä»¬é€‰æ‹©-2^32ä¹Ÿå¯ä»¥è¿˜åŸ<br>ä»æœ€é«˜ä½å¼€å§‹ é™¤ä»¥å¯¹åº”å¹‚æ¬¡åç»å¯¹å€¼å‘ä¸Šå–æ•´å³å¯è¿˜åŸ</p>
<h2 id="Fi1nd-th3-xâ€™"><a href="#Fi1nd-th3-xâ€™" class="headerlink" title="Fi1nd_th3_xâ€™"></a>Fi1nd_th3_xâ€™</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span>* </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">32</span>)</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">dP = d%((q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dQ = d%((p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dR = d%((p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = s2n(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>,r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dP=&#x27;</span>,dP)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dQ=&#x27;</span>,dQ)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dR=&#x27;</span>,dR)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line"><span class="string">q= 12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line"><span class="string">r= 12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line"><span class="string">dP= 116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line"><span class="string">dQ= 44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line"><span class="string">dR= 60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line"><span class="string">c= 93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>emmm æ€ä¹ˆè¯´å‘¢ æˆ‘å°±éšä¾¿è¯•äº†è¯• (æƒ³åˆ°flagä¸ç»è¿‡paddingè¿˜æ˜¯æŒºå°çš„)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,dP,q*r)))</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å‡ºäº†â€¦<br><code>SYC&#123;CRT_1s_f3n_but_Gen3hi_im9act_is_a_balabalaba&#125;</code></p>
<p>å›åˆ°é¢˜ç›®æœ¬èº«çš„è€ƒç‚¹: ä¸äº’ç´ æƒ…å†µä¸‹çš„CRT<br>dP,dQ,dR åˆ†åˆ«å¯ä»¥å¾—åˆ°</p>
<p><img src="https://s2.loli.net/2023/12/03/dTgqRexIQvDsPkJ.png" alt="H~7~A___X_G80H_J7CW_K1L.png"></p>
<p><code>from sympy.ntheory.modular import crt</code> è¿™ä¸ªcrtå¯ä»¥è§£å†³ä¸äº’ç´ çš„æƒ…å†µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(crt([q*r,p*r,p*q],[<span class="built_in">pow</span>(c,dP,n),<span class="built_in">pow</span>(c,dQ,n),<span class="built_in">pow</span>(c,dR,n)])[<span class="number">0</span>]%n))</span><br></pre></td></tr></table></figure>

<h2 id="Diligent-Liszt"><a href="#Diligent-Liszt" class="headerlink" title="Diligent_Liszt"></a>Diligent_Liszt</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&quot;SYC&quot;</span>)</span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_p_1</span>(<span class="params">digit</span>):</span><br><span class="line">    primes = []</span><br><span class="line">    pri = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(primes)&lt;<span class="number">100</span>):</span><br><span class="line">        pri = gp.next_prime(pri)</span><br><span class="line">        primes.append(<span class="built_in">int</span>(pri))</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        count = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; <span class="number">2</span>**digit:</span><br><span class="line">            count *= random.choice(primes)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(gp.is_prime(count)):</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">p,q,r = [gen_p_1(nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pqr&quot;</span>] </span><br><span class="line"></span><br><span class="line">n = p*q*r </span><br><span class="line">x = bytes_to_long(flag) </span><br><span class="line">y = gp.powmod(g,x,n) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r))   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(y)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x)) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line"><span class="string">q = 1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line"><span class="string">r = 132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line"><span class="string">y = 5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ç”±é¢˜ç›®p,q,rçš„ç”Ÿæˆæ–¹å¼çŸ¥: p-1,q-1,r-1å‡å…‰æ»‘<br>æ³¨æ„åˆ°p,q,rå‡ä¸ºç´ æ•° é‚£ä¹ˆæˆ‘ä»¬åˆ†åˆ«å¯¹mod p,q,ræ±‚dlpåcrtç»„åˆèµ·æ¥å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">g = <span class="number">3</span></span><br><span class="line">p = <span class="number">1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line">q = <span class="number">1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line">r = <span class="number">132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line">y = <span class="number">5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line">n = p*q*r</span><br><span class="line"></span><br><span class="line">mp = discrete_log(mod(y,p),mod(g,p))</span><br><span class="line">mq = discrete_log(mod(y,q),mod(g,q))</span><br><span class="line">mr = discrete_log(mod(y,r),mod(g,r))</span><br><span class="line"><span class="built_in">print</span>(CRT_list([mp,mq,mr],[p,q,r]))</span><br><span class="line">m = <span class="number">10611516989504525712597368786937786671609696614143113241754963687897074368833799765059908989</span></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D1scr3te_L0g_W1th_Mult1pl3_pr1m35&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="EzComplex"><a href="#EzComplex" class="headerlink" title="EzComplex"></a>EzComplex</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage9.3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;FAKE&#123;Do_You_know_Complex_numbers&#125;&#x27;</span></span><br><span class="line">p = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">384</span>)</span><br><span class="line">q = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">384</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">2</span>) + <span class="built_in">pow</span>(q, <span class="number">2</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line"><span class="string">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>azâ€¦ å­¦åˆ°äº† (<a href="/2023/12/03/Complex-RSA/" title="Complex RSA">Complex-RSA</a>)<br>N &#x3D; p^2 + q^2 &#x3D; (p+qi) * (p-qi)<br>åœ¨å¤æ•°åŸŸä¸Šåˆ†è§£N éå†å…¶å› å­å°±èƒ½å¾—åˆ°p,q</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">N = <span class="number">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line">zn = ZZ[i](N)</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> divisors(zn):</span><br><span class="line">    p, q = <span class="built_in">int</span>(d[<span class="number">0</span>]), <span class="built_in">int</span>(d[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> is_prime(p) <span class="keyword">and</span> is_prime(q) <span class="keyword">and</span> p.bit_length()&gt;<span class="number">300</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;p= <span class="subst">&#123;p&#125;</span>\nq= <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line">p= <span class="number">8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707</span></span><br><span class="line">q= <span class="number">29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> *</span><br><span class="line">d = modinv(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D0_you_like_r41n?_i_pref3r_R1_ng&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Algebra"><a href="#Algebra" class="headerlink" title="Algebra"></a>Algebra</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,e</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[i^<span class="number">3</span> - <span class="number">10</span>*i^<span class="number">2</span> + <span class="number">31</span>*i - <span class="number">30</span>==<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> e])</span><br><span class="line"></span><br><span class="line">LEN = <span class="number">32</span></span><br><span class="line">flag = pad(flag,<span class="number">36</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LongArray</span>(<span class="params">t:<span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [bytes_to_long(t[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BytesArray</span>(<span class="params">t:<span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [long_to_bytes(t[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ArrayXor</span>(<span class="params">a:<span class="built_in">list</span>,b:<span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [xor(a[i],b) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scissors</span>(<span class="params">flag:<span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [flag[i:i+<span class="built_in">len</span>(flag)//<span class="number">3</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="built_in">len</span>(flag)//<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">m: <span class="built_in">bytes</span>, bits: <span class="built_in">int</span>, level: <span class="built_in">int</span></span>):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    M = random_matrix(Zmod(p), LEN).matrix_from_rows_and_columns(<span class="built_in">range</span>(LEN), <span class="built_in">range</span>(LEN-level))</span><br><span class="line">    c = vector(GF(p), m) * M</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">groebner_challenge</span>(<span class="params">m,e</span>):</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    s = <span class="built_in">sum</span>(m)</span><br><span class="line">    c = [<span class="built_in">pow</span>(m[i],e[i],p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    c.insert(<span class="number">0</span>,s)</span><br><span class="line">    c.insert(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">key = os.urandom(LEN)</span><br><span class="line">Get_key = challenge(key,<span class="number">256</span>,<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">S_bytes = scissors(flag)</span><br><span class="line">C_bytes = ArrayXor(S_bytes,key)</span><br><span class="line">C_long  = LongArray(C_bytes)</span><br><span class="line"></span><br><span class="line">groebner_challenge = groebner_challenge(C_long,e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;keyTask.chall&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;Get_key&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;groebnerTask.chall&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;groebner_challenge&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å…ˆå­¦ä¹ ä¸‹groeberåŸºå†å›æ¥è¡¥</p>
]]></content>
      <categories>
        <category>CTF-Crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023 - 12 - Diary~</title>
    <url>/2023/12/03/2023-12-Diary/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="16506962007ed0509e3cfa0aad93e9beec7ecda9c5e046fa758d37b2ff2a70d6">84ddd93a2d570b3707d5ad36f450649bd9089ff895aa022e66c86996c1b8d12f26a776805ca63152fc06b8f8245079bb338a7a943efc7fdd92f3bc6a120d5b9f4bcfbf7e4f4a50dbe29e6c7de56d1c471680fe22143b75feeed6216317535a680b76be7d22f6a670a4e4e2afc97b3b74530fd2abe982b3faf2281601a62ac07f28f2cc8f9ea94e99b5c41ecb8b2e72900dfa68f63f8a587387d77e50cc18da47246b03d27332279b3bede1beef93d058b07a8513ae12ab397e909db7febec92aea3929e435cb5334ec34df806d1d309cf1e080769002d39984be475e7ec063d53b88bf16a22172958cdcf2bf19ac9a28d388bdb014db2be9dbe551b08a07db8c69daabd8d36b08b2e95e481e19e9519dc51b3849de6d3999af534e55dee82624b66b806c9deaa603642ba8735da648cfdffb625720a758c3e35e120078c9589b1804f0de89b23ef8ee64f671c4ee3078b05fcea49dca9ed5b3415df1d663342263d5c05efb2c850365903d3ab557fbd4068c78fd0219f10aaafb764666e1d635efbaae3c407711fcac02ab94c0484907a11656c54f3f351aa5c4fd116ffe5b062181a18457d02740a0192b9a21ea4f444a9c0aece7b28b955613f3074bf99d3eab4150ab3b1d661cfe993434116f043e6cca7f73144cdd8ac3c2206400a72121149e201524a12c91105d88efca512dd19f94d81fcaac89105d73894d835d8427d9b2463b53c5b7d80475172be8cbfcdfc9e975c03da4accd2549c125725b5fb5f379e3660937200c0c1ec915dfe49cf93675bf8af23ff6886fdb58b78387b55b924f1292f29fb8bd951d077341631e8e7914c0af4afb9d57069c3ef6c6bd414b350fa6ff8f7e818dc5136fa94260a8bbb8b8fdc66f43e52c5af21acd801cc9eb551440423bc0decc153490c9273b54dbd95fcd87f631d740e67c5bddaf6e813aa4b2447dc34004ee21cfe291c8cd43c4be79d6a3c769786ffcf52077ef5655d0411df5d17c5ec58b40ae0085aead7a3e1d9102e19830e953bb9cce6194f677ad8296f41dafca75f33e7e48f05be8a376145d9e192bb24081b45f28c971830852b3fd57283a1fbab1fca66595e26a771441654f1e8e0269e71e8bcc7fc6ef99b21fcdf11abf0ee704f9df73cd871431e308fce0cc52b228fdc903489eb8b869a5541fd9dc417c8ee4f5a4bb5f410afff5d24ceb05d06ee1d8f53d3a89931ce5226c14077ca2ded7f8344d4702b1bc93078573a351fe3b9b0d3862126a20d02ba6391a921b68ab595bb0dca61f24d3cdb268aa772038adc694d2bae317ea2f5f4537cc8da0e9e31ce7fcf0f17c5ed4eb834517db278d6cca0ec3d27c08b8e1c11ff3d69eb4351fafffe6d791e45f6a628930e41cedcbb00a0e2a17572518ffd46dffdb5c73ad0415864a76318eaa516ac37c41f31c8ecb9d18439956dbef61d5ee1a8a7dcbffd768b69048fa3d1a7967cd7b817063109eb21defa7bced37c76b070b72ee6350b446a369367c0f0764683acfbd3d160985c47aa793e8abbbe65618d285e860b72dc6db7c5a11f9d2ef9157ef6445204f276fafd8fa1ccf4661d54ca2c5591c10d49b2ccf91073fede3f7ee697fcc9739fc9461f726ab387ca73fc410fcb44f8173c63da743913ad92ccad9c0b97c21989364c670c3ef00dde556754ee7267601438385b679e7a9fb3b5b62d27ce9dbffeb21c93c77446353efa0e159aa545a061c596115d03cbe4ce076a81f178ade1be0ee2ddc97c15a5d6a96eebf99e17e4b517ec3f69712e0fab308004880f7e0d67797ef5bd13b7d3f5deebf2b5a10b93011655b54aa739bbd8fa7f3b8a03a2415e6232105b9c47c70b27f7ed323f0f707b5b8fc482d85e5647ecd060712c9d0b7aa2dcf813ad91407236d476c35033a42453bad417e064f528ca353b35df63f34810c2af34a37dbbc016d87392e100b697499b1826b2f073b615adedfdba2184477fb21e5439d2cfb2630eb145d40d53de80f206a056893770a87fbb0792125a51d03cbc23a5ce70aa716c455f44cb0e155ee2bd42a4c3f3ba0d95cb3fc0ba1d6086ef24059ed5cbde67f59037785b1e604c473c24b5224dffdc17277c1bf00bacf8d0d1d7c60dbcb6c7a068a4b0881b3b5b6041231a155135e5ef1713637903820a6427bb4cf7dcce8f6a7e2a0796854e00226e53bf0e228e16d0d7bd141566079e4314334a6f463dcddf5ffe92be01cf074425eb47a6db22c272df4e9c6330f378ccb5df062b5c92c8ddb2ea863086e6ca1e266aa8bc371ff642b85e5cb83476f3213ed0c368256592ed5473277b78dfa33bd99eb693cb553bcf05cb5fa95228cb0eef3dd3bc8cd2ab3436ec13014d14aac0078b2c66a0f3a5fc56fe7a51f807a2e67997fe247a3c7b9dfba364bfc5c25ecee851cd907f769c062c131803531ad43368265d4b113d88418d1fc0229d2fbf12ca695cc735c5751636232181136a610a32b53351b3ded8c30d53337a928bbc534de3ec9722f047794dfad62cf5cb7ea1193af75347bea3eb784f994e2524ad17abe9e29c9578cffd5f71764a68aa41be406834b9c5e7b62ee5c809bb98c208332b14dd080a5ff83b5694a0301630cf97825853f142944e9132d8736c0163795aa9e0da00f0f12353f11a11e0f85bbc8d71bc3b738d50592591edadce7c6db19974de5da256f97be4bdec65cc81b2f817597020dbc02f65efb12047cca44799ee3ee8905297ba14a6b7a2718d66ccb01ecc3229d808df4ddf308d7f89e97bbf007b78d818e57a4263ce938b5963d96bd589f6ef10813b3c4c0ae855e2fb60f1b4ef3e38abe3f3c39517d062d76747790d70fdc0d9f9eba9f13ba24f389881360b0e9d3d6a71843ff565a194765f442f58c6c61ed3beb9d1fd51584a4af12731c9ab7de3a0f7e52fe91e959b9536d3fb2eaaef62a697ea60f469ae1d73b0f5a605c2c7925867785e77df04818fa6d2e793b54efcf1a1484b6833b7b4f32987f31c08c6154dc54fd2e3637f984289a9ee24c83811b65ef132e2f2fb0f8a291209349963206ec03f738692b606fa3e2be921c8ce9d06060067d75fd503a6d3459a600886b36a4b86d95caa5000427a62dd90e2fc847122f37cd69b67bef624b94e58023566f4709193ab5caee0cfc9b2a8f6fc6c2bed2a806863b7d39fe5065e292b65e354676754d7aab2a043396d59e971e2500157e0e8705ffe9de3e28e235abaff5691b3cd3132aa6eada4179413526b0b44fad2abe5062a865c332cae2cb4b3da8bf8a2cec738124d393db64267b89383716a84c71178823ea9ea9ce9d29205fcd82eefd4cd24522a0b136ab7e6aef00856e318e80ef896d9b38f35ee55ab986483a4033b12079c7</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>DailyPlan</title>
    <url>/2023/12/03/DailyPlan/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="ce06a5b01d00320bacdb6ed585933b0cac2f209156924c8962b1d063421a651d">84ddd93a2d570b3707d5ad36f450649bd9089ff895aa022e66c86996c1b8d12f6b1a2e7545af9b92c954a9c981a69d03a814e0546808b15197565aa84da9fbdffd598111d62bb2b7441cb3a89a15939735e51debcd048bdf92fa3d4808693b555698723a51925ca7c3cb074886fa27b29df42402ae14b060aed6ca26281572fb5b6410022c9bc099074fd77ad46550242a4de171854d9edd59a42fe8b9c64bbb9037dd899199a5d80f8b49437d87fa7b44bcfd1f9f0bb13a64547677eceac1f00ab0e66d16f93e837cc352e1e12a30816ef6dbe1dafc9a1a3a30a4b0446912140de0b104b19b0cae993bc3843fd8a7626074290dc866897c59c83033f4a914b84adf61a0b652ee9005c9c0e46ec8035da88b7514b8335cf410e083e26cd3df83c0d4d001382f93aea62358d0fcf35f1a6f3b6bae9996a437ec32253cebdf305c3e329570809b8f7a28a09b49975678b89274f18141514680f49c4128f711953db14da40068bd88e0200718bd980a7ee026a69cf621106b0682cf6627680ebf57b04cc4f9e127c7fed5763a148ee9485de6b248fb417ea46b340f6c061cf68154e334ae92e5489047677e82470a6bdc307e885cf4c969385b221542e1b9d6fe8e61d0942f9a6128b32d71d4908f9b32e95aaf3b35ae26896ce276f84a0971e9aed34d2acd1da953faf8638e491d4c5d08f58f93fedf1a7f69a204a7dce0137a87570054e96048b267c3b89e6af05d8f1ebbb1b55bc56c20c2fa5e58417baee2b24b9520d607602bc17861cc9988759c4404e8dc46a24ee0f250d3daa8c7705f5ce5516f2ad0c5fd6b050882d9375a3621f7ab08dbcf9c8d4003055943e34ae372bcc61440ca50b0ea9bdfb152b11fa29675c2cbe7276220c0831c178df4236c885b0dbd1a8d8b5370239728085b44419d68147958db6a604a11d45af091949b2827c261d8d43f9c4501a74f43d51cf574697493715fdd6ad49de46d9c0f6f33bcc269413870fd53893f9ebc4ba7f97d62b83c9fb9c029e5c57a9d07d34f1a06d4ab9c19b5f851d6d67212ee82bb86e5ac933fc2af0e55fcc77b1232fc5b32cff5358c85e58f390cd7dae22bb7a63333d2f259d1aff04db186a2aaafa83a2ccae66de7e22b84d9a1d119be6ee23be7f6f2a8684db3eb846cac6f79de614b227f1a2d8e4c72d026b1db34ba28a4d8b47ca5f3d490a19a1d4f73eaf7b8cf175749193b34cc68d011f353c0501b05b4f995f2f2a70038523f0bd404c3d12c6221b2f97d607b35c4f41842430a9b05ce1b25aad3dd8ebb79ea81808f1cc74497f397b8ee165b199555483cc95d0dc0855b4acc75ec7b43e68883193a61be81a3d7a7f6c8befadb4f6c9a66f071837054c6c08c08dab9e05603201ebc99ca41379abb7d8a20e00892ecc9f05a4a6b32700c9d43ad1823ea1eae901d7f3442ae3e6279b343748c1481e3d0560619ab1ab04fbcf4c760f48f7d533b15cdada84bae85ea794187c80f576d9f6cfadfdcacab901a412ab790925bd8b23f6d76f5aebf9e633bc790198d64b7315a16fd4e6b25296830e1434de71f71c8f3b8460ff431f7cc76</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>è®°å½•ç¬¬ä¸€æ¬¡jadx APKåŠ¨è°ƒ</title>
    <url>/2023/12/03/%E8%AE%B0%E5%BD%95%E7%AC%AC%E4%B8%80%E6%AC%A1jadx-APK%E5%8A%A8%E8%B0%83/</url>
    <content><![CDATA[<p>è¿™é‡Œä»¥NestarCTF2023 WEEK2çš„AndroDbgme ä¸ºä¾‹<br>è¯¦ç»†è®°å½•äº†å…³äºè§£åŒ…apk ä¿®æ”¹manifest åé‡ç­¾åæ‰“åŒ…åŠæœ€åjadxè°ƒè¯•çš„è¿‡ç¨‹</p>
<span id="more"></span>
<p>é¦–å…ˆåœ¨ç½‘ä¸Šä¸‹è½½apktool(æœ‰.jar å’Œ .bat)<br>ç„¶åæ”¾åœ¨ C&#x2F;Windowsä¸‹ é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡<br>ä½¿ç”¨å‘½ä»¤: apktool  d  xxx.apk å…ˆè§£åŒ…<br>ç„¶ååœ¨manifesté‡Œçš„è¿™é‡ŒåŠ ä¸Šä¸€å¥ ä½¿å¾—å…è®¸è°ƒè¯•</p>
<p><img src="https://s2.loli.net/2023/12/03/5N24EkviRs3Dbyn.png" alt="1AP~68`_X45`O17@M8SOR_R.png"></p>
<p>apktool  b  xxx é‡æ–°æ‰“åŒ…æˆapk</p>
<p>ç”±äºè¦é‡ç­¾å æ‰€ä»¥è¦ç”Ÿæˆkeystore<br><code>keytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</code></p>
<p>ç”Ÿæˆkeystoreåç­¾å</p>
<p><code>jarsigner -verbose -keystore abc.keystore -signedjar des.apk src.APK abc.keystore</code></p>
<p>ç­¾åå®Œæ¯•å°±å¯ä»¥å¾—åˆ°æ”¹è¿‡manifestçš„apkäº†</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åŠ¨æ€è°ƒè¯• æˆ‘è¿™é‡Œç”¨çš„æ˜¯ jadx+é›·ç”µæ¨¡æ‹Ÿå™¨</p>
<p>åœ¨æ¨¡æ‹Ÿå™¨å¯åŠ¨apk</p>
<p>jadxæ‰“å¼€ ç‚¹å‡»debug</p>
<p><img src="https://s2.loli.net/2023/12/03/thwLBGubS9EMWp4.png" alt="img"></p>
<p>éšä¾¿ä¸‹ä¸ªæ–­ç‚¹ ç‚¹å‡»è¿è¡Œ å°±å¯ä»¥åœ¨apkçœ‹åˆ°flagäº†</p>
<p><img src="https://s2.loli.net/2023/12/03/4ERAbnhmViyXkzw.png" alt="img"></p>
]]></content>
      <categories>
        <category>CTF-Re</category>
      </categories>
  </entry>
  <entry>
    <title>DASCTF X CBCTF 2023 10</title>
    <url>/2023/12/03/DASCTF-X-CBCTF-2023-10/</url>
    <content><![CDATA[<p>èƒ½åŠ›æœ‰é™ åªèƒ½å¤ç°èƒ½åšçš„ä¸€äº›é¢˜ å…¶ä»–çš„æ…¢æ…¢è¡¥</p>
<span id="more"></span>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>chall.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">f</span>):</span><br><span class="line">    random_chars = <span class="built_in">bytes</span>([random.randint(<span class="number">0</span>, <span class="number">255</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])</span><br><span class="line">    f = f + random_chars</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_p</span>(<span class="params">p</span>):</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    </span><br><span class="line">    P = p</span><br><span class="line">    n1 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">while</span> jacobi(<span class="number">2</span>,n1) == <span class="number">1</span>:</span><br><span class="line">            n1 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">while</span> P:</span><br><span class="line">            pad = random.randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">2023</span>)**<span class="number">2</span> </span><br><span class="line">            message = pad &lt;&lt; <span class="number">1</span> + P % <span class="number">2</span></span><br><span class="line">            cipher = <span class="built_in">pow</span>(message, e, n1)</span><br><span class="line">            f.write(<span class="built_in">str</span>(cipher)+<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">            P //= <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n1 = &quot;</span>+ <span class="built_in">str</span>(n1) )    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_q</span>(<span class="params">q</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">q, n</span>):</span><br><span class="line">        e = random.randint(<span class="number">1000</span>,<span class="number">2000</span>)</span><br><span class="line">        noise = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</span><br><span class="line">        c = <span class="built_in">pow</span>(q+noise,e,n)</span><br><span class="line">        <span class="keyword">return</span> e, noise,c </span><br><span class="line">    </span><br><span class="line">    n2 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">    e1, noise1, c1 = encrypt(q, n2)</span><br><span class="line">    e2, noise2, c2 = encrypt(q, n2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n2 = &quot;</span>+ <span class="built_in">str</span>(n2) ) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;(e1, noise1, c1) =&#x27;</span>, (e1,noise1,c1))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;(e2, noise2, c2) =&#x27;</span>, (e2,noise2,c2))</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">guess_p(p)</span><br><span class="line">guess_q(q)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">flag = padding(flag)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 65634094430927080732256164808833233563732628654160389042977689628512527168256899310662239009610512772020503283842588142453533499954947692968978190310627721338357432052800695091789711809256924541784954080619073213358228083200846540676931341013554634493581962527475555869292091755676130810562421465063412235309</span></span><br><span class="line"><span class="string">n2 = 103670293685965841863872863719573676572683187403862749665555450164387906552249974071743238931253290278574192713467491802940810851806104430306195931179902098180199167945649526235613636163362672777298968943319216325949503045377100235181706964846408396946496139224344270391027205106691880999410424150216806861393</span></span><br><span class="line"><span class="string">(e1, noise1, c1) = (1743, 44560588075773853612820227436439937514195680734214431948441190347878274184937952381785302837541202705212687700521129385632776241537669208088777729355349833215443048466316517110778502508209433792603420158786772339233397583637570006255153020675167597396958251208681121668808253767520416175569161674463861719776, 65643009354198075182587766550521107063140340983433852821580802983736094225036497335607400197479623208915379722646955329855681601551282788854644359967909570360251550766970054185510197999091645907461580987639650262519866292285164258262387411847857812391136042309550813795587776534035784065962779853621152905983)</span></span><br><span class="line"><span class="string">(e2, noise2, c2) = (1325, 35282006599813744140721262875292395887558561517759721467291789696459426702600397172655624765281531167221787036009507833425145071265739486735993631460189629709591456017092661028839951392247601628468621576100035700437892164435424035004463142959219067199451575338270613300215815894328788753564798153516122567683, 50327632090778183759544755226710110702046850880299488259739672542025916422119065179822210884622225945376465802069464782311211031263046593145733701591371950349735709553105217501410716570601397725812709771348772095131473415552527749452347866778401205442409443726952960806789526845194216490544108773715759733714)</span></span><br><span class="line"><span class="string">c = 124349762993424531697403299350944207725577290992189948388824124986066269514204313888980321088629462472088631052329128042837153718129149149661961926557818023704330462282009415874674794190206220980118413541269327644472633791532767765585035518183177197863522573410860341245613331398610013697803459403446614221369</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ¯”èµ›çš„æ—¶å€™å¤§æ¦‚æ˜ç™½è¿™é‡Œçš„Jacobiçš„ç„æœº ä½†æ˜¯åªæ˜¯å‚¨å¤‡å®Œå…¨ä¸å¤Ÿ ççŒœçš„å‡ ä¸ªç»“è®ºä¹Ÿæ±‚ä¸å‡ºp<br>æ±‚qçš„éƒ¨åˆ†å½“æ—¶ä¹Ÿä»¥ä¸ºeä¸åŒä¸èƒ½sageè·‘(è™½è¯´å†™äº†ä¸€ä¸ªcopperä½†å¥½åƒå†™å‡äº†ã€‚ã€‚ã€‚ è¦å†è®¤çœŸå¼„æ‡‚copperçš„åŸç†)<br>å…ˆè·‘q:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">    g1 = (x+noise1)^e1-c1</span><br><span class="line">    g2 = (x+noise2)^e2-c2</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1,g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2,g1%g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1,g2)[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># print(attack())</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæ±‚p<br>é¦–å…ˆäº†è§£kroneckerç¬¦å·<br><img src="https://s2.loli.net/2023/12/03/VSfdpxDN2AtmHkJ.png" alt="_KE8ATP818UNXM_L6_9A_P2.png"><br>ç”±äºJacobiåªæ˜¯å°†å‹’è®©å¾·çš„å¥‡ç´ æ•°æ¨å¹¿åˆ°äº†å¥‡æ•°<br>è€Œkroneckerç¬¦å·æ˜¯æ¨å¹¿åˆ°äº†ä¸€èˆ¬çš„æ•´æ•° æ›´å…·æ™®é€‚æ„ä¹‰</p>
<p>ä¸¤ç§æƒ…å†µ</p>
<ul>
<li><code>(2x^2)^e</code> </li>
<li><code>(2x^2+1)^e</code></li>
</ul>
<p><img src="https://s2.loli.net/2023/12/03/m9Br3gGlnudUvAO.png" alt="AHYCN6UYNIUKOMT____HZPE.png"><br><font color=red size=5>ä¸è¦å¿˜äº†æ¬§æ‹‰å‡†åˆ™ï¼ï¼ï¼äºŒæ¬¡å‰©ä½™æœ€åˆçš„åˆ¤æ–­æ–¹å¼ï¼ï¼ï¼</font></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    i = <span class="built_in">int</span>(i)</span><br><span class="line">    <span class="keyword">if</span>(kronecker(i,n1)==<span class="number">1</span>):</span><br><span class="line">        p = <span class="string">&#x27;1&#x27;</span>+p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = <span class="string">&#x27;0&#x27;</span>+p</span><br><span class="line"><span class="comment"># print(int(p,2))</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…è¿™ç§</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(kronecker(i,n1)==-<span class="number">1</span>):</span><br><span class="line">        p = <span class="string">&#x27;0&#x27;</span>+p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = <span class="string">&#x27;1&#x27;</span>+p</span><br></pre></td></tr></table></figure>
<p>æœ€åçš„flag<br><img src="https://s2.loli.net/2023/12/03/4bwU5vxHVqXTBIs.png" alt="6R1Y1YM9VKF78ACQ__@FXF0.png"></p>
<h2 id="backpack"><a href="#backpack" class="headerlink" title="backpack"></a>backpack</h2><p>ç²—æµ…å­¦äº†ä¸‹æ ¼å¯†ç  çœ‹äº†çœ‹èƒŒåŒ…å¯†ç LLLç ´è§£çš„æœ¬è´¨<br>è¿˜æ˜¯è¦å­¦ä¼šè‡ªå·±é€ æ ¼å­<br>è¿™é¢˜è·Ÿæ™®é€šçš„èƒŒåŒ…ä¸åŒåœ¨äº æ¯6ä¸ªä¸­å¿…æœ‰3ä¸ª1<br>æ‰€ä»¥è¦å†åŠ ä¸Šä¸€åˆ—çš„çº¦æŸ å³ Î£xi &#x3D; 24<br>å€Ÿå¤§ä½¬çš„å›¾<br><img src="https://s2.loli.net/2023/12/03/7WanPqKwBNDe2gX.png" alt="Y@V1GI@_GOC3F_LV8V_LY_H.png"><br>æœ€ååˆ¤æ–­å°±æ˜¯åœ¨å¸¸è§„çš„-Sé‚£åˆ—ä¸º0ååŠ ä¸Šæœ€åä¸€åˆ—ä¸º0<br>solution.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = [<span class="number">65651991706497</span>, <span class="number">247831871690373</span>, <span class="number">120247087605020</span>, <span class="number">236854536567393</span>, <span class="number">38795708921144</span>, <span class="number">256334857906663</span>, <span class="number">120089773523233</span>, <span class="number">165349388120302</span>, <span class="number">123968326805899</span>, <span class="number">79638234559694</span>, <span class="number">259559389823590</span>, <span class="number">256776519514651</span>, <span class="number">107733244474073</span>, <span class="number">216508566448440</span>, <span class="number">39327578905012</span>, <span class="number">118682486932022</span>, <span class="number">263357223061004</span>, <span class="number">132872609024098</span>, <span class="number">44605761726563</span>, <span class="number">24908360451602</span>, <span class="number">237906955893793</span>, <span class="number">204469770496199</span>, <span class="number">7055254513808</span>, <span class="number">221802659519968</span>, <span class="number">169686619990988</span>, <span class="number">23128789035141</span>, <span class="number">208847144870760</span>, <span class="number">272339624469135</span>, <span class="number">269511404473473</span>, <span class="number">112830627321371</span>, <span class="number">73203551744776</span>, <span class="number">42843503010671</span>, <span class="number">118193938825623</span>, <span class="number">49625220390324</span>, <span class="number">230439888723036</span>, <span class="number">241486656550572</span>, <span class="number">107149406378865</span>, <span class="number">233503862264755</span>, <span class="number">269502011971514</span>, <span class="number">181805192674559</span>, <span class="number">152612003195556</span>, <span class="number">184127512098087</span>, <span class="number">165959151027513</span>, <span class="number">188723045133473</span>, <span class="number">241615906682300</span>, <span class="number">216101484550038</span>, <span class="number">81190147709444</span>, <span class="number">124498742419309</span>]</span><br><span class="line">re = <span class="number">4051501228761632</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(a)</span><br><span class="line">K = <span class="number">2</span>^<span class="number">10</span></span><br><span class="line">M = Matrix(ZZ,n+<span class="number">1</span>,n+<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M[i,i] = <span class="number">1</span></span><br><span class="line">    M[i,n] = K*a[i]</span><br><span class="line">    M[i,n+<span class="number">1</span>] = K*<span class="number">1</span></span><br><span class="line">M[n,n] = -K*re</span><br><span class="line">M[n,n+<span class="number">1</span>] = -<span class="number">24</span>*K</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> M.LLL():</span><br><span class="line">    <span class="keyword">if</span>(line[-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> line[-<span class="number">2</span>]==<span class="number">0</span>):</span><br><span class="line">        x = [<span class="built_in">abs</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> line[:-<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">set</span>(x).issubset([<span class="number">0</span>, <span class="number">1</span>]):</span><br><span class="line">            <span class="built_in">print</span>(x)</span><br><span class="line">            flag = <span class="string">&#x27;DASCTF&#123;&#x27;</span>+sha256(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]).encode()).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/12/03/YjdHfbD6wquvmnB.png" alt="image.png"></p>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="auuuu3"><a href="#auuuu3" class="headerlink" title="auuuu3"></a>auuuu3</h2><p>ç»™çš„æ˜¯ä¸€ä¸ªautoitæ ¼å¼çš„exe<br>å¦‚æœç”¨IDAæŸ¥çœ‹ åŸºæœ¬ä¸Šæ˜¯åšä¸å‡ºæ¥çš„<br>ä¸‡å¹¸çš„æ˜¯æœ‰ä¸ªè„šæœ¬å¯ä»¥å¸®æˆ‘ä»¬extract<br><a href="https://github.com/nazywam/AutoIt-Ripper">https://github.com/nazywam/AutoIt-Ripper</a><br>ç„¶åè¿™ä¹ˆç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> autoit_ripper <span class="keyword">import</span> extract, AutoItVersion</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\æµè§ˆå™¨ä¸‹è½½\auuuu3.exe&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file_content = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># EA05 for v3.00+, EA06 for v3.26+</span></span><br><span class="line"><span class="comment"># Omitting `version` or passing None will try both versions</span></span><br><span class="line">content_list = extract(data=file_content, version=AutoItVersion.EA06)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;D:\æµè§ˆå™¨ä¸‹è½½\auuuu3.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> content <span class="keyword">in</span> content_list:</span><br><span class="line">        s = <span class="built_in">str</span>(content)</span><br><span class="line">        f.write(s)</span><br></pre></td></tr></table></figure>
<p>WPç”¨çš„exeæˆ‘æ²¡æ‰¾åˆ°â€¦ ä½†æ˜¯è¿™æ ·æå–å‡ºæ¥å¤§è‡´ä¹Ÿèƒ½çœ‹<br>å¾ˆå®¹æ˜“å®šä½åˆ°æœ€åä¸€éƒ¨åˆ†<br><img src="https://s2.loli.net/2023/12/03/GAH385FJgWbe4xw.png" alt="image-1.png"><br>è¿™é‡Œç›¸å½“äºloadäº†ä¸€ä¸ªdll åªæ˜¯æ˜¯ç”¨hexå†™çš„ æˆ‘ä»¬å°†è¿™æ®µopcodeå¯¼å…¥dllç”¨IDAæ¥åˆ†æ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">OPCODE = <span class="string">&quot;83EC14B83400000099538B5C2420558B6C242056578B7C9DFCF7FB89C683C606C74424180000000085F68D76FF0F8EEA000000896C24288D4BFF8D549D00894C2410895424148974242081442418B979379E8B4C2418C1E90281E103000000894C241C31F6397424107E568B5424288BCF8B6CB204C1E9058D14AD0000000033CA8BD58BC7C1EA03C1E00433D003CA8B5424188BDE81E303000000335C241C8B4424308B1C9833D533DF03D333CA8B542428010CB28B0CB2463974241089CF7FAA8B5424288BCF8B2AC1E9058D14AD0000000033CA8BD58BC7C1EA03C1E00433D003CA8B5424188BDE81E303000000335C241C8B4424308B1C9833D533DF03D3FF4C242033CA8B542414014AFC8B4AFC8B54242089CF420F8F2DFFFFFF5F31C05E5D5B83C414C21000&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\æµè§ˆå™¨ä¸‹è½½\enc.dll&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(binascii.unhexlify(OPCODE))</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/12/03/o6lqvjngdYhQsIW.png" alt="ZZ_QD_HMMKFJ94TSU_~VHPT.png"><br>æ ‡å‡†çš„xxteaåŠ å¯†</p>
<p>æˆ‘ä»¬å·²çŸ¥ ciphertext<code>7218181A02F79F4B5773E8FFE83FE732DF96259FF2B86AAB945468A132A83D83CF9D750E316C8675</code></p>
<p>key<code>Wowww111auUu3</code><br>å°ç«¯åºè½¬ä¸€ä¸‹ è§£å¯†</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">10</span>]= &#123;<span class="number">0x1A181872</span>,<span class="number">0x4B9FF702</span>,<span class="number">0xFFE87357</span>,<span class="number">0x32E73FE8</span>,<span class="number">0x9F2596DF</span>,<span class="number">0xAB6AB8F2</span>,<span class="number">0xA1685494</span>,<span class="number">0x833DA832</span>,<span class="number">0x0E759DCF</span>,<span class="number">0x75866C31</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">0x77776f57</span>,<span class="number">0x31313177</span>,<span class="number">0x75557561</span>,<span class="number">0x33</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n= <span class="number">10</span>; </span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">3</span>;j++)</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(v[i]&gt;&gt;(<span class="number">8</span>*j))&amp;<span class="number">0xff</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>flag : <strong>DASCTF{Oh1_autO1t_iS_so_Co0oL_aNd_Fun}</strong><br>å¯ä»¥çœ‹åˆ° è¿™é¢˜ä¸»è¦è€ƒçš„å…¶å®æ˜¯åˆç†åˆ©ç”¨å·¥å…·è¿›è¡Œåˆ†æ(æ‰¾åˆ°autoit-ripperåçš„åˆ†æå…¶å®å¹¶ä¸éš¾ <del>ä½†å¦‚æœåªä¼šIDAå°±Gäº†â€¦</del>)</p>
<h2 id="marshal"><a href="#marshal" class="headerlink" title="marshal"></a>marshal</h2><p>é¢˜ç›®ç»™çš„ä¸€ä¸ªåµŒå¥—marshalçš„py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line">code = <span class="string">b&#x27;c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\x00\x00\x00@\x00\x00\x00s\xe2\x00\x00\x00d\x00d\x01d\x02d\x03d\x04d\x05d\x06d\x07d\x08d\td\nd\x0bd\x0cd\rd\x0ed\x0fg\x10Z\x00d\x10d\x11\x84\x00e\x01d\x12\x83\x01D\x00\x83\x01Z\x02d\x05d\x12d\x13d\x14d\x0ed\x15d\x16d\x17d\x0fd\x18d\x19d\x1ad\x08d\x1bd\x1cd\x1dd\x0cd\x1ed\x1fd d\x01d!d&quot;d#d\x02d$d%d&amp;d\rd\&#x27;d(d)d\x0bd*d+d,d\x04d-d.d/d\x06d0d1d2d\x03d3d4d5d\x00d6d7d8d\x07d9d:d;d\td&lt;d=d&gt;d\nd?d@dAg@Z\x03dBd\x11\x84\x00e\x01dC\x83\x01D\x00\x83\x01Z\x04e\x05\xa0\x06dD\xa1\x01Z\x07e\x08e\x07\x83\x01\x01\x00dES\x00)F\xe9\x0c\x00\x00\x00\xe9\x05\x00\x00\x00\xe9\x06\x00\x00\x00\xe9\x0b\x00\x00\x00\xe9\t\x00\x00\x00\xe9\x00\x00\x00\x00\xe9\n\x00\x00\x00\xe9\r\x00\x00\x00\xe9\x03\x00\x00\x00\xe9\x0e\x00\x00\x00\xe9\x0f\x00\x00\x00\xe9\x08\x00\x00\x00\xe9\x04\x00\x00\x00\xe9\x07\x00\x00\x00\xe9\x01\x00\x00\x00\xe9\x02\x00\x00\x00c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s\x16\x00\x00\x00g\x00|\x00]\x0e&#125;\x01t\x00\xa0\x01|\x01\xa1\x01\x91\x02q\x04S\x00\xa9\x00)\x02\xda\x04Sbox\xda\x05index\xa9\x02\xda\x02.0\xda\x01xr\x10\x00\x00\x00r\x10\x00\x00\x00\xda\x00\xda\n&lt;listcomp&gt;\x04\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00r\x17\x00\x00\x00\xe9\x10\x00\x00\x00\xe9 \x00\x00\x00\xe90\x00\x00\x00\xe9\x11\x00\x00\x00\xe9!\x00\x00\x00\xe91\x00\x00\x00\xe9\x12\x00\x00\x00\xe9&quot;\x00\x00\x00\xe92\x00\x00\x00\xe9\x13\x00\x00\x00\xe9#\x00\x00\x00\xe93\x00\x00\x00\xe9\x14\x00\x00\x00\xe9$\x00\x00\x00\xe94\x00\x00\x00\xe9\x15\x00\x00\x00\xe9%\x00\x00\x00\xe95\x00\x00\x00\xe9\x16\x00\x00\x00\xe9&amp;\x00\x00\x00\xe96\x00\x00\x00\xe9\x17\x00\x00\x00\xe9\&#x27;\x00\x00\x00\xe97\x00\x00\x00\xe9\x18\x00\x00\x00\xe9(\x00\x00\x00\xe98\x00\x00\x00\xe9\x19\x00\x00\x00\xe9)\x00\x00\x00\xe99\x00\x00\x00\xe9\x1a\x00\x00\x00\xe9*\x00\x00\x00\xe9:\x00\x00\x00\xe9\x1b\x00\x00\x00\xe9+\x00\x00\x00\xe9;\x00\x00\x00\xe9\x1c\x00\x00\x00\xe9,\x00\x00\x00\xe9&lt;\x00\x00\x00\xe9\x1d\x00\x00\x00\xe9-\x00\x00\x00\xe9=\x00\x00\x00\xe9\x1e\x00\x00\x00\xe9.\x00\x00\x00\xe9&gt;\x00\x00\x00\xe9\x1f\x00\x00\x00\xe9/\x00\x00\x00\xe9?\x00\x00\x00c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s\x16\x00\x00\x00g\x00|\x00]\x0e&#125;\x01t\x00\xa0\x01|\x01\xa1\x01\x91\x02q\x04S\x00r\x10\x00\x00\x00)\x02\xda\x04PBoxr\x12\x00\x00\x00r\x13\x00\x00\x00r\x10\x00\x00\x00r\x10\x00\x00\x00r\x16\x00\x00\x00r\x17\x00\x00\x00\t\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00\xe9@\x00\x00\x00s#\n\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00C\x00\x00\x00s\x08\x00\x00\x00|\x00|\x01A\x00S\x00)\x01N\xa9\x00)\x02\xda\x05stateZ\x08roundkeyr\x00\x00\x00\x00r\x00\x00\x00\x00\xda\x00\xda\x0baddRoundKey\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x03\x00\x00\x00s,\t\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00s6\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]$&#125;\x02|\x01t\x01|\x00|\x02d\x03\x14\x00?\x00d\x04@\x00\x19\x00|\x02d\x03\x14\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x05N\xe9\x00\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x04\x00\x00\x00\xe9\x0f\x00\x00\x00)\x02\xda\x05rangeZ\x04Sbox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x08\x00\x00\x00\xda\x00\xda\tsBoxLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01&quot;\x01r\n\x00\x00\x00s\xe4\x07\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s.\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]\x1c&#125;\x02|\x01|\x00|\x02?\x00d\x03@\x00t\x01|\x02\x19\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x04N\xe9\x00\x00\x00\x00\xe9@\x00\x00\x00\xe9\x01\x00\x00\x00)\x02\xda\x05rangeZ\x04PBox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x07\x00\x00\x00\xda\x00\xda\x06pLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01\x1a\x01r\t\x00\x00\x00s\xac\x06\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x03\x00\x00\x00s\x1a\x00\x00\x00t\x00\x87\x00f\x01d\x01d\x02\x84\x08t\x01d\x03\x83\x01D\x00\x83\x01\x83\x01S\x00)\x04Nc\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00\x13\x00\x00\x00s \x00\x00\x00g\x00|\x00]\x18&#125;\x01t\x00\x88\x00|\x01\x19\x00\x83\x01d\x00|\x01\x14\x00&gt;\x00\x91\x02q\x04S\x00)\x01\xe9\x08\x00\x00\x00)\x01\xda\x03ord)\x02\xda\x02.0\xda\x01c\xa9\x01\xda\x01i\xa9\x00\xda\x00\xda\n&lt;listcomp&gt;\x03\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00z!string2number.&lt;locals&gt;.&lt;listcomp&gt;r\x00\x00\x00\x00)\x02\xda\x03sum\xda\x05ranger\x04\x00\x00\x00r\x06\x00\x00\x00r\x04\x00\x00\x00r\x07\x00\x00\x00\xda\rstring2number\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x0b\x00\x00\x00s\x01\x05\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00st\x00\x00\x00g\x00&#125;\x02t\x00d\x01|\x01d\x01\x17\x00d\x01\x83\x03D\x00]Z&#125;\x03|\x02\xa0\x01|\x00d\x02?\x00\xa1\x01\x01\x00|\x00d\x03@\x00d\x04&gt;\x00|\x00d\x05?\x00\x17\x00&#125;\x00t\x02|\x00d\x06?\x00\x19\x00d\x06&gt;\x00|\x00d\x07d\x06\x13\x00d\x01\x18\x00@\x00\x17\x00&#125;\x00|\x00|\x03d\x08&gt;\x00|\x00d\x05?\x00A\x00N\x00&#125;\x00q\x14|\x02S\x00)\tN\xe9\x01\x00\x00\x00\xe9\x10\x00\x00\x00i\xff\xff\x07\x00\xe9=\x00\x00\x00\xe9\x13\x00\x00\x00\xe9L\x00\x00\x00\xe9\x02\x00\x00\x00\xe9\x0f\x00\x00\x00)\x03\xda\x05range\xda\x06appendZ\x04Sbox)\x04\xda\x03key\xda\x06roundsZ\troundkeys\xda\x01i\xa9\x00r\x0c\x00\x00\x00\xda\x00\xda\x13generateRoundkeys80\x02\x00\x00\x00s\x0e\x00\x00\x00\x00\x01\x04\x01\x14\x01\x0e\x01\x14\x01 \x01\x16\x01r\x0e\x00\x00\x00sF\x03\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00@\x00\x00\x00s\xa6\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01d\x02\x83\x01Z\x02e\x03e\x02\x83\x01d\x03k\x03r,e\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00e\x02d\x06d\x07\x85\x02\x19\x00e\x02d\x07d\x08\x85\x02\x19\x00e\x02d\x08d\t\x85\x02\x19\x00e\x02d\td\x03\x85\x02\x19\x00g\x04Z\x06d\nd\x0bd\x0cd\rg\x04Z\x07e\x00e\x06\x83\x01Z\x08e\td\x0e\x83\x01D\x00]$Z\ne\x07e\n\x19\x00e\x08e\n\x19\x00k\x03rte\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00qte\x04d\x0f\x83\x01\x01\x00d\x06S\x00)\x10c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00sp\x00\x00\x00d\x01&#125;\x01t\x00d\x02|\x01\x83\x02&#125;\x02g\x00&#125;\x03|\x00D\x00]T&#125;\x04t\x01|\x04\x83\x01&#125;\x05t\x02|\x01d\x03\x18\x00\x83\x01D\x00]&quot;&#125;\x06t\x03|\x05|\x02|\x06\x19\x00\x83\x02&#125;\x05t\x04|\x05\x83\x01&#125;\x05t\x05|\x05\x83\x01&#125;\x05q.t\x03|\x05|\x02d\x04\x19\x00\x83\x02&#125;\x07|\x03\xa0\x06|\x07\xa1\x01\x01\x00q\x16|\x03S\x00)\x05N\xe9 \x00\x00\x00l\x06\x00\x00\x00! 20\\X\xa8 1!\x02\x00\xe9\x01\x00\x00\x00\xe9\xff\xff\xff\xff)\x07Z\x13generateRoundkeys80Z\rstring2number\xda\x05rangeZ\x0baddRoundKeyZ\tsBoxLayerZ\x06pLayer\xda\x06append)\x08\xda\x06blocks\xda\x06roundsZ\troundkeysZ\x03outZ\x05block\xda\x05state\xda\x01iZ\x06cipher\xa9\x00r\t\x00\x00\x00\xda\x00\xda\x07encrypt\x02\x00\x00\x00s\x18\x00\x00\x00\x00\x01\x04\x01\n\x01\x04\x01\x08\x01\x08\x01\x10\x01\x0e\x01\x08\x01\n\x01\x0e\x01\x0c\x01r\x0b\x00\x00\x00z\x12pls input ur flag:r\x00\x00\x00\x00z\x0bwrong flag!\xe9\x00\x00\x00\x00N\xe9\x08\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x18\x00\x00\x00l\x04\x00\x00\x00\x9e\x1faH\xc4\x13d\rl\x05\x00\x00\x00b]t:\x94Z\x15\x18\x0e\x00l\x04\x00\x00\x000ek95\x04\xb2&quot;l\x05\x00\x00\x00\x88o\xeddY\x13\xb1L\x01\x00\xe9\x04\x00\x00\x00z\x08Correct!)\x0br\x0b\x00\x00\x00\xda\x05inputZ\x03inp\xda\x03len\xda\x05print\xda\x04exitr\x05\x00\x00\x00Z\x04cmpsZ\nout_blocksr\x03\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\n\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x18\x00\x00\x00\x08\x0e\x08\x01\x0c\x01\x08\x01\x08\x01,\x01\x0c\x01\x08\x01\x0c\x01\x10\x01\x08\x01\n\x01N)\x05r\x0e\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x0c\x00\x00\x00r\x0c\x00\x00\x00r\x0c\x00\x00\x00r\r\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\t\n\x01N)\x05r\x0b\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x06\x00\x00\x00r\x06\x00\x00\x00r\x06\x00\x00\x00r\x07\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01N)\x05r\t\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x07\x00\x00\x00r\x07\x00\x00\x00r\x07\x00\x00\x00r\x08\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\n\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x08\x00\x00\x00r\x08\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\x03\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x00\x00\x00\x00r\x00\x00\x00\x00r\x00\x00\x00\x00r\x02\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01N)\tr\x11\x00\x00\x00\xda\x05rangeZ\x08Sbox_invrH\x00\x00\x00Z\x08PBox_inv\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x10\x00\x00\x00r\x10\x00\x00\x00r\x10\x00\x00\x00r\x16\x00\x00\x00\xda\x08&lt;module&gt;\x03\x00\x00\x00sl\x00\x00\x00$\x01\x12\x01 \x01\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x01\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x01\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\xfd\x04\x04\x12\x02\n\x01&#x27;</span></span><br><span class="line"></span><br><span class="line">l = marshal.loads(code)</span><br><span class="line"><span class="built_in">exec</span>(l)</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥æ‰§è¡Œæ˜¯ä¼šæŠ¥é”™çš„ æ‹¿åˆ°è¿™ç§è¿˜æ˜¯å…ˆç”¨dis.disæŸ¥çœ‹ä¸‹å­—èŠ‚ç (æœ¬åœ°è·‘è¿˜ä¸€ç›´æŠ¥é”™ ç”¨åœ¨çº¿pythonè·‘å°±è¡Œäº†)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l = marshal.loads(code)</span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line">dis.dis(l)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°é‡Œé¢è¿˜åµŒäº†marshal</p>
<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  3           0 LOAD_CONST               0 (12)</span><br><span class="line">              2 LOAD_CONST               1 (5)</span><br><span class="line">              4 LOAD_CONST               2 (6)</span><br><span class="line">              6 LOAD_CONST               3 (11)</span><br><span class="line">              8 LOAD_CONST               4 (9)</span><br><span class="line">             10 LOAD_CONST               5 (0)</span><br><span class="line">             12 LOAD_CONST               6 (10)</span><br><span class="line">             14 LOAD_CONST               7 (13)</span><br><span class="line">             16 LOAD_CONST               8 (3)</span><br><span class="line">             18 LOAD_CONST               9 (14)</span><br><span class="line">             20 LOAD_CONST              10 (15)</span><br><span class="line">             22 LOAD_CONST              11 (8)</span><br><span class="line">             24 LOAD_CONST              12 (4)</span><br><span class="line">             26 LOAD_CONST              13 (7)</span><br><span class="line">             28 LOAD_CONST              14 (1)</span><br><span class="line">             30 LOAD_CONST              15 (2)</span><br><span class="line">             32 BUILD_LIST              16</span><br><span class="line">             34 STORE_NAME               0 (Sbox)</span><br><span class="line"></span><br><span class="line">  4          36 LOAD_CONST              16 (&lt;code object &lt;listcomp&gt; at 0x7fbf6f8f83a0, file &quot;&quot;, line 4&gt;)</span><br><span class="line">             38 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">             40 MAKE_FUNCTION            0</span><br><span class="line">             42 LOAD_NAME                1 (range)</span><br><span class="line">             44 LOAD_CONST              18 (16)</span><br><span class="line">             46 CALL_FUNCTION            1</span><br><span class="line">             48 GET_ITER</span><br><span class="line">             50 CALL_FUNCTION            1</span><br><span class="line">             52 STORE_NAME               2 (Sbox_inv)</span><br><span class="line"></span><br><span class="line">  5          54 LOAD_CONST               5 (0)</span><br><span class="line">             56 LOAD_CONST              18 (16)</span><br><span class="line">             58 LOAD_CONST              19 (32)</span><br><span class="line">             60 LOAD_CONST              20 (48)</span><br><span class="line">             62 LOAD_CONST              14 (1)</span><br><span class="line">             64 LOAD_CONST              21 (17)</span><br><span class="line">             66 LOAD_CONST              22 (33)</span><br><span class="line">             68 LOAD_CONST              23 (49)</span><br><span class="line">             70 LOAD_CONST              15 (2)</span><br><span class="line">             72 LOAD_CONST              24 (18)</span><br><span class="line">             74 LOAD_CONST              25 (34)</span><br><span class="line">             76 LOAD_CONST              26 (50)</span><br><span class="line">             78 LOAD_CONST               8 (3)</span><br><span class="line">             80 LOAD_CONST              27 (19)</span><br><span class="line">             82 LOAD_CONST              28 (35)</span><br><span class="line">             84 LOAD_CONST              29 (51)</span><br><span class="line"></span><br><span class="line">  6          86 LOAD_CONST              12 (4)</span><br><span class="line">             88 LOAD_CONST              30 (20)</span><br><span class="line">             90 LOAD_CONST              31 (36)</span><br><span class="line">             92 LOAD_CONST              32 (52)</span><br><span class="line">             94 LOAD_CONST               1 (5)</span><br><span class="line">             96 LOAD_CONST              33 (21)</span><br><span class="line">             98 LOAD_CONST              34 (37)</span><br><span class="line">            100 LOAD_CONST              35 (53)</span><br><span class="line">            102 LOAD_CONST               2 (6)</span><br><span class="line">            104 LOAD_CONST              36 (22)</span><br><span class="line">            106 LOAD_CONST              37 (38)</span><br><span class="line">            108 LOAD_CONST              38 (54)</span><br><span class="line">            110 LOAD_CONST              13 (7)</span><br><span class="line">            112 LOAD_CONST              39 (23)</span><br><span class="line">            114 LOAD_CONST              40 (39)</span><br><span class="line">            116 LOAD_CONST              41 (55)</span><br><span class="line"></span><br><span class="line">  7         118 LOAD_CONST              11 (8)</span><br><span class="line">            120 LOAD_CONST              42 (24)</span><br><span class="line">            122 LOAD_CONST              43 (40)</span><br><span class="line">            124 LOAD_CONST              44 (56)</span><br><span class="line">            126 LOAD_CONST               4 (9)</span><br><span class="line">            128 LOAD_CONST              45 (25)</span><br><span class="line">            130 LOAD_CONST              46 (41)</span><br><span class="line">            132 LOAD_CONST              47 (57)</span><br><span class="line">            134 LOAD_CONST               6 (10)</span><br><span class="line">            136 LOAD_CONST              48 (26)</span><br><span class="line">            138 LOAD_CONST              49 (42)</span><br><span class="line">            140 LOAD_CONST              50 (58)</span><br><span class="line">            142 LOAD_CONST               3 (11)</span><br><span class="line">            144 LOAD_CONST              51 (27)</span><br><span class="line">            146 LOAD_CONST              52 (43)</span><br><span class="line">            148 LOAD_CONST              53 (59)</span><br><span class="line"></span><br><span class="line">  8         150 LOAD_CONST               0 (12)</span><br><span class="line">            152 LOAD_CONST              54 (28)</span><br><span class="line">            154 LOAD_CONST              55 (44)</span><br><span class="line">            156 LOAD_CONST              56 (60)</span><br><span class="line">            158 LOAD_CONST               7 (13)</span><br><span class="line">            160 LOAD_CONST              57 (29)</span><br><span class="line">            162 LOAD_CONST              58 (45)</span><br><span class="line">            164 LOAD_CONST              59 (61)</span><br><span class="line">            166 LOAD_CONST               9 (14)</span><br><span class="line">            168 LOAD_CONST              60 (30)</span><br><span class="line">            170 LOAD_CONST              61 (46)</span><br><span class="line">            172 LOAD_CONST              62 (62)</span><br><span class="line">            174 LOAD_CONST              10 (15)</span><br><span class="line">            176 LOAD_CONST              63 (31)</span><br><span class="line">            178 LOAD_CONST              64 (47)</span><br><span class="line">            180 LOAD_CONST              65 (63)</span><br><span class="line"></span><br><span class="line">  5         182 BUILD_LIST              64</span><br><span class="line">            184 STORE_NAME               3 (PBox)</span><br><span class="line"></span><br><span class="line">  9         186 LOAD_CONST              66 (&lt;code object &lt;listcomp&gt; at 0x7fbf6f8f8660, file &quot;&quot;, line 9&gt;)</span><br><span class="line">            188 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">            190 MAKE_FUNCTION            0</span><br><span class="line">            192 LOAD_NAME                1 (range)</span><br><span class="line">            194 LOAD_CONST              67 (64)</span><br><span class="line">            196 CALL_FUNCTION            1</span><br><span class="line">            198 GET_ITER</span><br><span class="line">            200 CALL_FUNCTION            1</span><br><span class="line">            202 STORE_NAME               4 (PBox_inv)</span><br><span class="line"></span><br><span class="line"> 11         204 LOAD_NAME                5 (marshal)</span><br><span class="line">            206 LOAD_METHOD              6 (loads)</span><br><span class="line">            208 LOAD_CONST              68 (b&#x27;c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00C\x00\x00\x00s\x08\x00\x00\x00|\x00|\x01A\x00S\x00)\x01N\xa9\x00)\x02\xda\x05stateZ\x08roundkeyr\x00\x00\x00\x00r\x00\x00\x00\x00\xda\x00\xda\x0baddRoundKey\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x03\x00\x00\x00s,\t\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00s6\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]$&#125;\x02|\x01t\x01|\x00|\x02d\x03\x14\x00?\x00d\x04@\x00\x19\x00|\x02d\x03\x14\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x05N\xe9\x00\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x04\x00\x00\x00\xe9\x0f\x00\x00\x00)\x02\xda\x05rangeZ\x04Sbox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x08\x00\x00\x00\xda\x00\xda\tsBoxLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01&quot;\x01r\n\x00\x00\x00s\xe4\x07\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s.\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]\x1c&#125;\x02|\x01|\x00|\x02?\x00d\x03@\x00t\x01|\x02\x19\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x04N\xe9\x00\x00\x00\x00\xe9@\x00\x00\x00\xe9\x01\x00\x00\x00)\x02\xda\x05rangeZ\x04PBox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x07\x00\x00\x00\xda\x00\xda\x06pLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01\x1a\x01r\t\x00\x00\x00s\xac\x06\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x03\x00\x00\x00s\x1a\x00\x00\x00t\x00\x87\x00f\x01d\x01d\x02\x84\x08t\x01d\x03\x83\x01D\x00\x83\x01\x83\x01S\x00)\x04Nc\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00\x13\x00\x00\x00s \x00\x00\x00g\x00|\x00]\x18&#125;\x01t\x00\x88\x00|\x01\x19\x00\x83\x01d\x00|\x01\x14\x00&gt;\x00\x91\x02q\x04S\x00)\x01\xe9\x08\x00\x00\x00)\x01\xda\x03ord)\x02\xda\x02.0\xda\x01c\xa9\x01\xda\x01i\xa9\x00\xda\x00\xda\n&lt;listcomp&gt;\x03\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00z!string2number.&lt;locals&gt;.&lt;listcomp&gt;r\x00\x00\x00\x00)\x02\xda\x03sum\xda\x05ranger\x04\x00\x00\x00r\x06\x00\x00\x00r\x04\x00\x00\x00r\x07\x00\x00\x00\xda\rstring2number\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x0b\x00\x00\x00s\x01\x05\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00st\x00\x00\x00g\x00&#125;\x02t\x00d\x01|\x01d\x01\x17\x00d\x01\x83\x03D\x00]Z&#125;\x03|\x02\xa0\x01|\x00d\x02?\x00\xa1\x01\x01\x00|\x00d\x03@\x00d\x04&gt;\x00|\x00d\x05?\x00\x17\x00&#125;\x00t\x02|\x00d\x06?\x00\x19\x00d\x06&gt;\x00|\x00d\x07d\x06\x13\x00d\x01\x18\x00@\x00\x17\x00&#125;\x00|\x00|\x03d\x08&gt;\x00|\x00d\x05?\x00A\x00N\x00&#125;\x00q\x14|\x02S\x00)\tN\xe9\x01\x00\x00\x00\xe9\x10\x00\x00\x00i\xff\xff\x07\x00\xe9=\x00\x00\x00\xe9\x13\x00\x00\x00\xe9L\x00\x00\x00\xe9\x02\x00\x00\x00\xe9\x0f\x00\x00\x00)\x03\xda\x05range\xda\x06appendZ\x04Sbox)\x04\xda\x03key\xda\x06roundsZ\troundkeys\xda\x01i\xa9\x00r\x0c\x00\x00\x00\xda\x00\xda\x13generateRoundkeys80\x02\x00\x00\x00s\x0e\x00\x00\x00\x00\x01\x04\x01\x14\x01\x0e\x01\x14\x01 \x01\x16\x01r\x0e\x00\x00\x00sF\x03\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00@\x00\x00\x00s\xa6\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01d\x02\x83\x01Z\x02e\x03e\x02\x83\x01d\x03k\x03r,e\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00e\x02d\x06d\x07\x85\x02\x19\x00e\x02d\x07d\x08\x85\x02\x19\x00e\x02d\x08d\t\x85\x02\x19\x00e\x02d\td\x03\x85\x02\x19\x00g\x04Z\x06d\nd\x0bd\x0cd\rg\x04Z\x07e\x00e\x06\x83\x01Z\x08e\td\x0e\x83\x01D\x00]$Z\ne\x07e\n\x19\x00e\x08e\n\x19\x00k\x03rte\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00qte\x04d\x0f\x83\x01\x01\x00d\x06S\x00)\x10c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00sp\x00\x00\x00d\x01&#125;\x01t\x00d\x02|\x01\x83\x02&#125;\x02g\x00&#125;\x03|\x00D\x00]T&#125;\x04t\x01|\x04\x83\x01&#125;\x05t\x02|\x01d\x03\x18\x00\x83\x01D\x00]&quot;&#125;\x06t\x03|\x05|\x02|\x06\x19\x00\x83\x02&#125;\x05t\x04|\x05\x83\x01&#125;\x05t\x05|\x05\x83\x01&#125;\x05q.t\x03|\x05|\x02d\x04\x19\x00\x83\x02&#125;\x07|\x03\xa0\x06|\x07\xa1\x01\x01\x00q\x16|\x03S\x00)\x05N\xe9 \x00\x00\x00l\x06\x00\x00\x00! 20\\X\xa8 1!\x02\x00\xe9\x01\x00\x00\x00\xe9\xff\xff\xff\xff)\x07Z\x13generateRoundkeys80Z\rstring2number\xda\x05rangeZ\x0baddRoundKeyZ\tsBoxLayerZ\x06pLayer\xda\x06append)\x08\xda\x06blocks\xda\x06roundsZ\troundkeysZ\x03outZ\x05block\xda\x05state\xda\x01iZ\x06cipher\xa9\x00r\t\x00\x00\x00\xda\x00\xda\x07encrypt\x02\x00\x00\x00s\x18\x00\x00\x00\x00\x01\x04\x01\n\x01\x04\x01\x08\x01\x08\x01\x10\x01\x0e\x01\x08\x01\n\x01\x0e\x01\x0c\x01r\x0b\x00\x00\x00z\x12pls input ur flag:r\x00\x00\x00\x00z\x0bwrong flag!\xe9\x00\x00\x00\x00N\xe9\x08\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x18\x00\x00\x00l\x04\x00\x00\x00\x9e\x1faH\xc4\x13d\rl\x05\x00\x00\x00b]t:\x94Z\x15\x18\x0e\x00l\x04\x00\x00\x000ek95\x04\xb2&quot;l\x05\x00\x00\x00\x88o\xeddY\x13\xb1L\x01\x00\xe9\x04\x00\x00\x00z\x08Correct!)\x0br\x0b\x00\x00\x00\xda\x05inputZ\x03inp\xda\x03len\xda\x05print\xda\x04exitr\x05\x00\x00\x00Z\x04cmpsZ\nout_blocksr\x03\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\n\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x18\x00\x00\x00\x08\x0e\x08\x01\x0c\x01\x08\x01\x08\x01,\x01\x0c\x01\x08\x01\x0c\x01\x10\x01\x08\x01\n\x01N)\x05r\x0e\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x0c\x00\x00\x00r\x0c\x00\x00\x00r\x0c\x00\x00\x00r\r\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\t\n\x01N)\x05r\x0b\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x06\x00\x00\x00r\x06\x00\x00\x00r\x06\x00\x00\x00r\x07\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01N)\x05r\t\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x07\x00\x00\x00r\x07\x00\x00\x00r\x07\x00\x00\x00r\x08\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\n\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x08\x00\x00\x00r\x08\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\x03\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x00\x00\x00\x00r\x00\x00\x00\x00r\x00\x00\x00\x00r\x02\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01&#x27;)</span><br><span class="line">            210 CALL_METHOD              1</span><br><span class="line">            212 STORE_NAME               7 (co)</span><br><span class="line"></span><br><span class="line"> 12         214 LOAD_NAME                8 (exec)</span><br><span class="line">            216 LOAD_NAME                7 (co)</span><br><span class="line">            218 CALL_FUNCTION            1</span><br><span class="line">            220 POP_TOP</span><br><span class="line">            222 LOAD_CONST              69 (None)</span><br><span class="line">            224 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7fbf6f8f83a0, file &quot;&quot;, line 4&gt;:</span><br><span class="line">  4           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (Sbox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7fbf6f8f8660, file &quot;&quot;, line 9&gt;:</span><br><span class="line">  9           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (PBox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<p>æ³¨æ„åˆ°æœ‰å‡ ä¸ªæ˜¾çœ¼ç‰¹å¾:</p>
<ul>
<li>Sbox</li>
<li>PBox</li>
<li>generateRoundkeys80<br>æœç´¢å¯ä»¥å¾—åˆ°:</li>
</ul>
<p><img src="https://s2.loli.net/2023/12/03/QR6G7gCuYtfhc1P.png" alt="B68_Z___PC67M0HVVJ2_DA8.png"></p>
<p>è¯´æ˜æ˜¯presentç®—æ³•<br>é‚£æˆ‘ä»¬æ€ä¹ˆå¾—åˆ°é‚£å‡ ä¸ªå…³é”®å˜é‡çš„å€¼å‘¢ï¼Ÿ<br>è¿™é‡Œè·Ÿç€å®˜æ–¹WPå­¦ä¹ äº†ä¸€æ‰‹å…¨å±€hookçš„æ€æƒ³<br>![&#96;BEPIHG0_C8_CY_@7@6~1L1.png](<a href="https://s2.loli.net/2023/12/03/4wQCeFy9LIT2jms.png">https://s2.loli.net/2023/12/03/4wQCeFy9LIT2jms.png</a>)<br>ä½†æ˜¯å®é™…ç”¨çš„æ—¶å€™ä¼šå‘ç° åœ¨execåç”¨çš„è¯ ç¨‹åºä¼šç›´æ¥é€€å‡º(è°ƒç”¨äº†exit())<br><img src="https://s2.loli.net/2023/12/03/GPh2KRF5AdOcoBj.png" alt="O_DK_VOF3HP@PW0_O@RGN1Q.png"><br>è€Œæˆ‘ä»¬åœ¨execæ‰§è¡Œå‰å®šä¹‰ä¸€ä¸ªexit ç›¸å½“äºæŠŠç³»ç»Ÿçš„exitç»™è¦†ç›–æ‰ (åˆ©ç”¨å…¨å±€ç‰¹æ€§ ç±»ä¼¼web get&#x2F;postä¿®æ”¹å…¨å±€å˜é‡)<br>ä½†æ˜¯è¿™æ ·è¿è¡Œè¿˜æ˜¯æŠ¥é”™ æˆ‘ä»¬å†åŠ ä¸ªtry exceptå—æ¥ä¿è¯èƒ½å¾—åˆ°globals()<br><img src="https://s2.loli.net/2023/12/03/6zMsQ3kjYfnLX52.png" alt="HY65JZD_HH__3_U6_X1YF@L.png"></p>
<p>å¯ä»¥çœ‹åˆ°è¿™æ—¶å·²ç»èƒ½å¾—åˆ°ä¸€äº›å…³é”®å€¼äº†<br>æ€»ç»“ä¸€ä¸‹ : ç°åœ¨å¾—åˆ°äº†</p>
<ul>
<li>sbox</li>
<li>sbox_inv</li>
<li>pbox</li>
<li>pbox_inv</li>
<li>cmps</li>
</ul>
<p>å‘ç°è¿™é‡Œè¿˜å°‘äº† keyçš„å€¼<br>è¯´æ˜keyä¸åœ¨globalsé‡Œ è¿™é‡Œå†æ¬¡åˆ©ç”¨å…¨å±€hookçš„æŠ€å·§<br>keyåœ¨<code>generateRoundkeys80</code>ä¸­è¢«è°ƒç”¨</p>
<p><img src="https://s2.loli.net/2023/12/03/1iHt5M7uEXzVw4A.png" alt="img"></p>
<p>æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹generateRoundkeys80 ä½¿å®ƒè¾“å‡ºä¼ å…¥çš„ä¸¤ä¸ªå˜é‡çš„å€¼å³å¯(ä½¿ç”¨lambda <del>pythoné«˜çº§ç‰¹å¾å­¦åˆ°äº†</del>)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">generateRoundkeys80 = <span class="keyword">lambda</span> x1,x2: <span class="built_in">print</span>(x1,x2)</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/12/03/lEFAxXu9cnajroK.png" alt="_G0380___9__SM1E_1O~LD0.png"><br>è¿™å°±å¾—åˆ°äº†key!<br>ä½†æ˜¯ç›´æ¥å¥—ä¼šå‘ç°è§£å‡ºæ¥ä¸å¯¹â€¦<br>é‚£å°±åªèƒ½çœ‹å­—èŠ‚ç  æ‰‹åŠ¨è„±marshal(5,6æ¬¡å§)<br>å¾—åˆ°å…³é”®çš„generatekey80çš„å­—èŠ‚ç (æœ€åä¸€å±‚æ‰è„±å‡ºæ¥ è¯´æ˜å…³é”®åº”è¯¥åœ¨è¿™é‡Œ)</p>
<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  2           0 LOAD_CONST               0 (&lt;code object generateRoundkeys80 at 0x7fb5577493a0, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;generateRoundkeys80&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (generateRoundkeys80)</span><br><span class="line"></span><br><span class="line"> 11           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">             12 LOAD_CONST                 2           0 LOAD_CONST               0 (&lt;code object encrypt at 0x7f7a22c7c660, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;encrypt&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (encrypt)</span><br><span class="line"></span><br><span class="line"> 16           8 LOAD_NAME                1 (input)</span><br><span class="line">             10 LOAD_CONST               2 (&#x27;pls input ur flag:&#x27;)</span><br><span class="line">             12 CALL_FUNCTION            1</span><br><span class="line">             14 STORE_NAME               2 (inp)</span><br><span class="line"></span><br><span class="line"> 17          16 LOAD_NAME                3 (len)</span><br><span class="line">             18 LOAD_NAME                2 (inp)</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 LOAD_CONST               3 (32)</span><br><span class="line">             24 COMPARE_OP               3 (!=)</span><br><span class="line">             26 POP_JUMP_IF_FALSE       44</span><br><span class="line"></span><br><span class="line"> 18          28 LOAD_NAME                4 (print)</span><br><span class="line">             30 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">             32 CALL_FUNCTION            1</span><br><span class="line">             34 POP_TOP</span><br><span class="line"></span><br><span class="line"> 19          36 LOAD_NAME                5 (exit)</span><br><span class="line">             38 LOAD_CONST               5 (0)</span><br><span class="line">             40 CALL_FUNCTION            1</span><br><span class="line">             42 POP_TOP</span><br><span class="line"></span><br><span class="line"> 20     &gt;&gt;   44 LOAD_NAME                2 (inp)</span><br><span class="line">             46 LOAD_CONST               6 (None)</span><br><span class="line">             48 LOAD_CONST               7 (8)</span><br><span class="line">             50 BUILD_SLICE              2</span><br><span class="line">             52 BINARY_SUBSCR</span><br><span class="line">             54 LOAD_NAME                2 (inp)</span><br><span class="line">             56 LOAD_CONST               7 (8)</span><br><span class="line">             58 LOAD_CONST               8 (16)</span><br><span class="line">             60 BUILD_SLICE              2</span><br><span class="line">             62 BINARY_SUBSCR</span><br><span class="line">             64 LOAD_NAME                2 (inp)</span><br><span class="line">             66 LOAD_CONST               8 (16)</span><br><span class="line">             68 LOAD_CONST               9 (24)</span><br><span class="line">             70 BUILD_SLICE              2</span><br><span class="line">             72 BINARY_SUBSCR</span><br><span class="line">             74 LOAD_NAME                2 (inp)</span><br><span class="line">             76 LOAD_CONST               9 (24)</span><br><span class="line">             78 LOAD_CONST               3 (32)</span><br><span class="line">             80 BUILD_SLICE              2</span><br><span class="line">             82 BINARY_SUBSCR</span><br><span class="line">             84 BUILD_LIST               4</span><br><span class="line">             86 STORE_NAME               6 (blocks)</span><br><span class="line"></span><br><span class="line"> 21          88 LOAD_CONST              10 (120617461261311902)</span><br><span class="line">             90 LOAD_CONST              11 (16357837616839286114)</span><br><span class="line">             92 LOAD_CONST              12 (312508749794633008)</span><br><span class="line">             94 LOAD_CONST              13 (1843701600916795272)</span><br><span class="line">             96 BUILD_LIST               4</span><br><span class="line">             98 STORE_NAME               7 (cmps)</span><br><span class="line"></span><br><span class="line"> 22         100 LOAD_NAME                0 (encrypt)</span><br><span class="line">            102 LOAD_NAME                6 (blocks)</span><br><span class="line">            104 CALL_FUNCTION            1</span><br><span class="line">            106 STORE_NAME               8 (out_blocks)</span><br><span class="line"></span><br><span class="line"> 23         108 LOAD_NAME                9 (range)</span><br><span class="line">            110 LOAD_CONST              14 (4)</span><br><span class="line">            112 CALL_FUNCTION            1</span><br><span class="line">            114 GET_ITER</span><br><span class="line">        &gt;&gt;  116 FOR_ITER                36 (to 154)</span><br><span class="line">            118 STORE_NAME              10 (i)</span><br><span class="line"></span><br><span class="line"> 24         120 LOAD_NAME                7 (cmps)</span><br><span class="line">            122 LOAD_NAME               10 (i)</span><br><span class="line">            124 BINARY_SUBSCR</span><br><span class="line">            126 LOAD_NAME                8 (out_blocks)</span><br><span class="line">            128 LOAD_NAME               10 (i)</span><br><span class="line">            130 BINARY_SUBSCR</span><br><span class="line">            132 COMPARE_OP               3 (!=)</span><br><span class="line">            134 POP_JUMP_IF_FALSE      116</span><br><span class="line"></span><br><span class="line"> 25         136 LOAD_NAME                4 (print)</span><br><span class="line">            138 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">            140 CALL_FUNCTION            1</span><br><span class="line">            142 POP_TOP</span><br><span class="line"></span><br><span class="line"> 26         144 LOAD_NAME                5 (exit)</span><br><span class="line">            146 LOAD_CONST               5 (0)</span><br><span class="line">            148 CALL_FUNCTION            1</span><br><span class="line">            150 POP_TOP</span><br><span class="line">            152 JUMP_ABSOLUTE          116</span><br><span class="line"></span><br><span class="line"> 27     &gt;&gt;  154 LOAD_NAME                4 (print)</span><br><span class="line">            156 LOAD_CONST              15 (&#x27;Correct!&#x27;)</span><br><span class="line">            158 CALL_FUNCTION            1</span><br><span class="line">            160 POP_TOP</span><br><span class="line">            162 LOAD_CONST               6 (None)</span><br><span class="line">            164 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object encrypt at 0x7f7a22c7c660, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (32)</span><br><span class="line">              2 STORE_FAST               1 (rounds)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (generateRoundkeys80)</span><br><span class="line">              6 LOAD_CONST               2 (85354531916197809168417)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 CALL_FUNCTION            2</span><br><span class="line">             12 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  5          14 BUILD_LIST               0</span><br><span class="line">             16 STORE_FAST               3 (out)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_FAST                0 (blocks)</span><br><span class="line">             20 GET_ITER</span><br><span class="line">        &gt;&gt;   22 FOR_ITER                84 (to 108)</span><br><span class="line">             24 STORE_FAST               4 (block)</span><br><span class="line"></span><br><span class="line">  7          26 LOAD_GLOBAL              1 (string2number)</span><br><span class="line">             28 LOAD_FAST                4 (block)</span><br><span class="line">             30 CALL_FUNCTION            1</span><br><span class="line">             32 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line">  8          34 LOAD_GLOBAL              2 (range)</span><br><span class="line">             36 LOAD_FAST                1 (rounds)</span><br><span class="line">             38 LOAD_CONST               3 (1)</span><br><span class="line">             40 BINARY_SUBTRACT</span><br><span class="line">             42 CALL_FUNCTION            1</span><br><span class="line">             44 GET_ITER</span><br><span class="line">        &gt;&gt;   46 FOR_ITER                34 (to 82)</span><br><span class="line">             48 STORE_FAST               6 (i)</span><br><span class="line"></span><br><span class="line">  9          50 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             52 LOAD_FAST                5 (state)</span><br><span class="line">             54 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             56 LOAD_FAST                6 (i)</span><br><span class="line">             58 BINARY_SUBSCR</span><br><span class="line">             60 CALL_FUNCTION            2</span><br><span class="line">             62 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 10          64 LOAD_GLOBAL              4 (sBoxLayer)</span><br><span class="line">             66 LOAD_FAST                5 (state)</span><br><span class="line">             68 CALL_FUNCTION            1</span><br><span class="line">             70 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 11          72 LOAD_GLOBAL              5 (pLayer)</span><br><span class="line">             74 LOAD_FAST                5 (state)</span><br><span class="line">             76 CALL_FUNCTION            1</span><br><span class="line">             78 STORE_FAST               5 (state)</span><br><span class="line">             80 JUMP_ABSOLUTE           46</span><br><span class="line"></span><br><span class="line"> 12     &gt;&gt;   82 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             84 LOAD_FAST                5 (state)</span><br><span class="line">             86 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             88 LOAD_CONST               4 (-1)</span><br><span class="line">             90 BINARY_SUBSCR</span><br><span class="line">             92 CALL_FUNCTION            2</span><br><span class="line">             94 STORE_FAST               7 (cipher)</span><br><span class="line"></span><br><span class="line"> 13          96 LOAD_FAST                3 (out)</span><br><span class="line">             98 LOAD_METHOD              6 (append)</span><br><span class="line">            100 LOAD_FAST                7 (cipher)</span><br><span class="line">            102 CALL_METHOD              1</span><br><span class="line">            104 POP_TOP</span><br><span class="line">            106 JUMP_ABSOLUTE           22</span><br><span class="line"></span><br><span class="line"> 14     &gt;&gt;  108 LOAD_FAST                3 (out)</span><br><span class="line">            110 RETURN_VALUE</span><br><span class="line">None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line"> 12          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object generateRoundkeys80 at 0x7fb5577493a0, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 BUILD_LIST               0</span><br><span class="line">              2 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               1 (1)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 LOAD_CONST               1 (1)</span><br><span class="line">             12 BINARY_ADD</span><br><span class="line">             14 LOAD_CONST               1 (1)</span><br><span class="line">             16 CALL_FUNCTION            3</span><br><span class="line">             18 GET_ITER</span><br><span class="line">        &gt;&gt;   20 FOR_ITER                90 (to 112)</span><br><span class="line">             22 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line">  5          24 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             26 LOAD_METHOD              1 (append)</span><br><span class="line">             28 LOAD_FAST                0 (key)</span><br><span class="line">             30 LOAD_CONST               2 (16)</span><br><span class="line">             32 BINARY_RSHIFT</span><br><span class="line">             34 CALL_METHOD              1</span><br><span class="line">             36 POP_TOP</span><br><span class="line"></span><br><span class="line">  6          38 LOAD_FAST                0 (key)</span><br><span class="line">             40 LOAD_CONST               3 (524287)</span><br><span class="line">             42 BINARY_AND</span><br><span class="line">             44 LOAD_CONST               4 (61)</span><br><span class="line">             46 BINARY_LSHIFT</span><br><span class="line">             48 LOAD_FAST                0 (key)</span><br><span class="line">             50 LOAD_CONST               5 (19)</span><br><span class="line">             52 BINARY_RSHIFT</span><br><span class="line">             54 BINARY_ADD</span><br><span class="line">             56 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  7          58 LOAD_GLOBAL              2 (Sbox)</span><br><span class="line">             60 LOAD_FAST                0 (key)</span><br><span class="line">             62 LOAD_CONST               6 (76)</span><br><span class="line">             64 BINARY_RSHIFT</span><br><span class="line">             66 BINARY_SUBSCR</span><br><span class="line">             68 LOAD_CONST               6 (76)</span><br><span class="line">             70 BINARY_LSHIFT</span><br><span class="line">             72 LOAD_FAST                0 (key)</span><br><span class="line">             74 LOAD_CONST               7 (2)</span><br><span class="line">             76 LOAD_CONST               6 (76)</span><br><span class="line">             78 BINARY_POWER</span><br><span class="line">             80 LOAD_CONST               1 (1)</span><br><span class="line">             82 BINARY_SUBTRACT</span><br><span class="line">             84 BINARY_AND</span><br><span class="line">             86 BINARY_ADD</span><br><span class="line">             88 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  8          90 LOAD_FAST                0 (key)</span><br><span class="line">             92 LOAD_FAST                3 (i)</span><br><span class="line">             94 LOAD_CONST               8 (15)</span><br><span class="line">             96 BINARY_LSHIFT</span><br><span class="line">             98 LOAD_FAST                0 (key)</span><br><span class="line">            100 LOAD_CONST               5 (19)</span><br><span class="line">            102 BINARY_RSHIFT</span><br><span class="line">            104 BINARY_XOR</span><br><span class="line">            106 INPLACE_XOR</span><br><span class="line">            108 STORE_FAST               0 (key)</span><br><span class="line">            110 JUMP_ABSOLUTE           20</span><br><span class="line"></span><br><span class="line">  9     &gt;&gt;  112 LOAD_FAST                2 (roundkeys)</span><br><span class="line">            114 RETURN_VALUE</span><br><span class="line">None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<p><img src="https://s2.loli.net/2023/12/03/IOML12SXx45RyFU.png" alt="img"></p>
<p>è¿™é‡Œä¹Ÿèƒ½è§£é‡Šä¸ºä»€ä¹ˆå‰é¢å…¨å±€hookåè°ƒç”¨encrypt(xxx)<br>ç»“åˆæ ‡å‡†roundkeysç”Ÿæˆç®—æ³•<br><img src="https://s2.loli.net/2023/12/03/Rusgx94JzwmIdvU.png" alt="img"></p>
<p>å†å¯¹æ¯”å­—èŠ‚ç (é€šè¿‡ç‰¹å¾å‚æ•°å®šä½)<br><img src="https://s2.loli.net/2023/12/03/OEBXFZSzy8VUcGt.png" alt="img"><br>å¯ä»¥å‘ç°åœ¨ <code>key ^= i &lt;&lt; 15</code> çš„åŸºç¡€ä¸Šå˜æˆäº†<br><code>key ^= (i&lt;&lt;15) ^ (key &gt;&gt; 19)</code><br>æ‰€ä»¥åœ¨æ ‡å‡†ä»£ç ä¸Šç¨ä½œä¿®æ”¹:(ç›´æ¥æ¬å®˜æ–¹çš„äº† åº”è¯¥æ˜¯å¯¹ç€å­—èŠ‚ç å†™çš„å§ ç½‘ä¸Šæ‰¾çš„éƒ½ä¸å¥½ç›´æ¥æ”¹ <del>è¿˜ä¸å¦‚è‡ªå·±æ‰‹æ“å­—èŠ‚ç </del>)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sBoxLayer_dec</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            output += Sbox_inv[( state &gt;&gt; (i*<span class="number">4</span>)) &amp; <span class="number">0xF</span>] &lt;&lt; (i*<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pLayer_dec</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            output += ((state &gt;&gt; i) &amp; <span class="number">0x01</span>) &lt;&lt; PBox_inv[i]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateRoundkeys80</span>(<span class="params">key,rounds</span>):</span><br><span class="line">    roundkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,rounds+<span class="number">1</span>,<span class="number">1</span>): </span><br><span class="line">            roundkeys.append(key &gt;&gt;<span class="number">16</span>)</span><br><span class="line">            key = ((key &amp; (<span class="number">2</span>**<span class="number">19</span>-<span class="number">1</span>)) &lt;&lt; <span class="number">61</span>) + (key &gt;&gt; <span class="number">19</span>)</span><br><span class="line">            key = (Sbox[key &gt;&gt; <span class="number">76</span>] &lt;&lt; <span class="number">76</span>)+(key &amp; (<span class="number">2</span>**<span class="number">76</span>-<span class="number">1</span>))</span><br><span class="line">            key ^= (i &lt;&lt; <span class="number">15</span>)^(key &gt;&gt; <span class="number">19</span>)</span><br><span class="line">    <span class="keyword">return</span> roundkeys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2number</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>([<span class="built_in">ord</span>(i[c])&lt;&lt;(<span class="number">8</span>*c) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment">#        0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f</span></span><br><span class="line">Sbox= [<span class="number">0xc</span>,<span class="number">0x5</span>,<span class="number">0x6</span>,<span class="number">0xb</span>,<span class="number">0x9</span>,<span class="number">0x0</span>,<span class="number">0xa</span>,<span class="number">0xd</span>,<span class="number">0x3</span>,<span class="number">0xe</span>,<span class="number">0xf</span>,<span class="number">0x8</span>,<span class="number">0x4</span>,<span class="number">0x7</span>,<span class="number">0x1</span>,<span class="number">0x2</span>]</span><br><span class="line">Sbox_inv = [Sbox.index(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">PBox = [<span class="number">0</span>,<span class="number">16</span>,<span class="number">32</span>,<span class="number">48</span>,<span class="number">1</span>,<span class="number">17</span>,<span class="number">33</span>,<span class="number">49</span>,<span class="number">2</span>,<span class="number">18</span>,<span class="number">34</span>,<span class="number">50</span>,<span class="number">3</span>,<span class="number">19</span>,<span class="number">35</span>,<span class="number">51</span>,</span><br><span class="line">        <span class="number">4</span>,<span class="number">20</span>,<span class="number">36</span>,<span class="number">52</span>,<span class="number">5</span>,<span class="number">21</span>,<span class="number">37</span>,<span class="number">53</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">38</span>,<span class="number">54</span>,<span class="number">7</span>,<span class="number">23</span>,<span class="number">39</span>,<span class="number">55</span>,</span><br><span class="line">        <span class="number">8</span>,<span class="number">24</span>,<span class="number">40</span>,<span class="number">56</span>,<span class="number">9</span>,<span class="number">25</span>,<span class="number">41</span>,<span class="number">57</span>,<span class="number">10</span>,<span class="number">26</span>,<span class="number">42</span>,<span class="number">58</span>,<span class="number">11</span>,<span class="number">27</span>,<span class="number">43</span>,<span class="number">59</span>,</span><br><span class="line">        <span class="number">12</span>,<span class="number">28</span>,<span class="number">44</span>,<span class="number">60</span>,<span class="number">13</span>,<span class="number">29</span>,<span class="number">45</span>,<span class="number">61</span>,<span class="number">14</span>,<span class="number">30</span>,<span class="number">46</span>,<span class="number">62</span>,<span class="number">15</span>,<span class="number">31</span>,<span class="number">47</span>,<span class="number">63</span>]</span><br><span class="line">PBox_inv = [PBox.index(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addRoundKey</span>(<span class="params">state,roundkey</span>):</span><br><span class="line">    <span class="keyword">return</span> state ^ roundkey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">blocks</span>):</span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    roundkeys = generateRoundkeys80(<span class="number">85354531916197809168417</span>, rounds)</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">        state = block</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds-<span class="number">1</span>):</span><br><span class="line">                state = addRoundKey(state, roundkeys[-i-<span class="number">1</span>])</span><br><span class="line">                state = pLayer_dec(state)</span><br><span class="line">                state = sBoxLayer_dec(state)</span><br><span class="line">        decipher = addRoundKey(state, roundkeys[<span class="number">0</span>])</span><br><span class="line">        flag += <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(decipher&gt;&gt;(c*<span class="number">8</span>) &amp; <span class="number">0xff</span>) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">cmps = [<span class="number">120617461261311902</span>, <span class="number">16357837616839286114</span>, <span class="number">312508749794633008</span>, <span class="number">1843701600916795272</span>]</span><br><span class="line">decrypt(cmps)</span><br><span class="line"><span class="comment"># 83ab766012aef9934c95ed93e9822a91</span></span><br></pre></td></tr></table></figure>

<p>æƒ³äº†æƒ³è¿˜æ˜¯è‡ªå·±æ‰‹æ“ä¸€ä¸‹(ç»ƒä¹ ä¸‹å­—èŠ‚ç ) æŠŠåŠ å¯†ä»£ç å†™äº†ä¸‹:<br>è¿˜å¤ä¹ äº†å‡ ä¸ªç‚¹:</p>
<ul>
<li>INPLACE_ADD: output +&#x3D;</li>
<li>BINARY_SUBSCR ç”¨æ¥åˆ’åˆ†å— é¿å…å­—èŠ‚ç äº§ç”Ÿæ­§ä¹‰</li>
</ul>
<p>è‡ªå·±å†™çš„æ—¶å€™ å‘ç°string2numberç›´æ¥çœ‹å­—èŠ‚ç æ˜¯ä¸å¤ªèƒ½å†™å‡ºæ¥çš„ ä½†çŸ¥é“åŸç†è‡ªå·±å†™ä¸€ä¸‹ä¹Ÿå·®ä¸äº†å¤šå°‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    generateRoundkeys80(<span class="number">85354531916197809168417</span>,rounds)</span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">        state = string2number(block)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds-<span class="number">1</span>):</span><br><span class="line">            state = addRoundKey(state,roundkeys[i]) <span class="comment"># roundkeysæ˜¯æ•°ç»„</span></span><br><span class="line">            state = sBoxLayer(state)</span><br><span class="line">            state = pLayer(state)</span><br><span class="line">        cipher = addRoundKey(state,roundkeys[-<span class="number">1</span>])</span><br><span class="line">        out.append(cipher)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addRoundKey</span>(<span class="params">state,roundkey</span>):</span><br><span class="line">    <span class="keyword">return</span> state^roundkey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2number</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>([<span class="built_in">ord</span>(i[c])&lt;&lt;(<span class="number">8</span>*c) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sBoxLayer</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        output += Sbox[(<span class="number">4</span>*i&gt;&gt;<span class="number">15</span>)&amp;<span class="number">15</span>]&lt;&lt;(<span class="number">4</span>*i)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pLayer</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        output += ((state&gt;&gt;i)&amp;<span class="number">1</span>)&lt;&lt;PBox[i]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateRoundkeys80</span>(<span class="params">key, rounds</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate the roundkeys for a 80-bit key</span></span><br><span class="line"><span class="string">    Input:</span></span><br><span class="line"><span class="string">            key:    the key as a 80-bit integer</span></span><br><span class="line"><span class="string">            rounds: the number of rounds as an integer</span></span><br><span class="line"><span class="string">    Output: list of 64-bit roundkeys as integers&quot;&quot;&quot;</span></span><br><span class="line">    roundkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>, rounds + <span class="number">1</span>):  <span class="comment"># (K1 ... K32)</span></span><br><span class="line">        <span class="comment"># rawkey: used in comments to show what happens at bitlevel</span></span><br><span class="line">        <span class="comment"># rawKey[0:64]</span></span><br><span class="line">        roundkeys.append(key &gt;&gt; <span class="number">16</span>)</span><br><span class="line">        <span class="comment"># 1. Shift</span></span><br><span class="line">        <span class="comment"># rawKey[19:len(rawKey)]+rawKey[0:19]</span></span><br><span class="line">        key = ((key &amp; (<span class="number">2</span> ** <span class="number">19</span> - <span class="number">1</span>)) &lt;&lt; <span class="number">61</span>) + (key &gt;&gt; <span class="number">19</span>)</span><br><span class="line">        <span class="comment"># 2. SBox</span></span><br><span class="line">        <span class="comment"># rawKey[76:80] = S(rawKey[76:80])</span></span><br><span class="line">        key = (Sbox[key &gt;&gt; <span class="number">76</span>] &lt;&lt; <span class="number">76</span>) + (key &amp; (<span class="number">2</span> ** <span class="number">76</span> - <span class="number">1</span>))</span><br><span class="line">        <span class="comment">#3. Salt</span></span><br><span class="line">        <span class="comment">#rawKey[15:20] ^ i</span></span><br><span class="line">        key ^= (i &lt;&lt; <span class="number">15</span>)^(key&gt;&gt;<span class="number">19</span>)</span><br><span class="line">    <span class="keyword">return</span> roundkeys</span><br></pre></td></tr></table></figure>

<p>æœ€åæ”¾ä¸€ä»½æ‰‹è„±marshalçš„å¤§è‡´å­—èŠ‚ç :</p>
<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  3           0 LOAD_CONST               0 (12)</span><br><span class="line">              2 LOAD_CONST               1 (5)</span><br><span class="line">              4 LOAD_CONST               2 (6)</span><br><span class="line">              6 LOAD_CONST               3 (11)</span><br><span class="line">              8 LOAD_CONST               4 (9)</span><br><span class="line">             10 LOAD_CONST               5 (0)</span><br><span class="line">             12 LOAD_CONST               6 (10)</span><br><span class="line">             14 LOAD_CONST               7 (13)</span><br><span class="line">             16 LOAD_CONST               8 (3)</span><br><span class="line">             18 LOAD_CONST               9 (14)</span><br><span class="line">             20 LOAD_CONST              10 (15)</span><br><span class="line">             22 LOAD_CONST              11 (8)</span><br><span class="line">             24 LOAD_CONST              12 (4)</span><br><span class="line">             26 LOAD_CONST              13 (7)</span><br><span class="line">             28 LOAD_CONST              14 (1)</span><br><span class="line">             30 LOAD_CONST              15 (2)</span><br><span class="line">             32 BUILD_LIST              16</span><br><span class="line">             34 STORE_NAME               0 (Sbox)</span><br><span class="line"></span><br><span class="line">  4          36 LOAD_CONST              16 (&lt;code object &lt;listcomp&gt; at 0x7f7b29b00a80, file &quot;&quot;, line 4&gt;)</span><br><span class="line">             38 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">             40 MAKE_FUNCTION            0</span><br><span class="line">             42 LOAD_NAME                1 (range)</span><br><span class="line">             44 LOAD_CONST              18 (16)</span><br><span class="line">             46 CALL_FUNCTION            1</span><br><span class="line">             48 GET_ITER</span><br><span class="line">             50 CALL_FUNCTION            1</span><br><span class="line">             52 STORE_NAME               2 (Sbox_inv)</span><br><span class="line"></span><br><span class="line">  5          54 LOAD_CONST               5 (0)</span><br><span class="line">             56 LOAD_CONST              18 (16)</span><br><span class="line">             58 LOAD_CONST              19 (32)</span><br><span class="line">             60 LOAD_CONST              20 (48)</span><br><span class="line">             62 LOAD_CONST              14 (1)</span><br><span class="line">             64 LOAD_CONST              21 (17)</span><br><span class="line">             66 LOAD_CONST              22 (33)</span><br><span class="line">             68 LOAD_CONST              23 (49)</span><br><span class="line">             70 LOAD_CONST              15 (2)</span><br><span class="line">             72 LOAD_CONST              24 (18)</span><br><span class="line">             74 LOAD_CONST              25 (34)</span><br><span class="line">             76 LOAD_CONST              26 (50)</span><br><span class="line">             78 LOAD_CONST               8 (3)</span><br><span class="line">             80 LOAD_CONST              27 (19)</span><br><span class="line">             82 LOAD_CONST              28 (35)</span><br><span class="line">             84 LOAD_CONST              29 (51)</span><br><span class="line"></span><br><span class="line">  6          86 LOAD_CONST              12 (4)</span><br><span class="line">             88 LOAD_CONST              30 (20)</span><br><span class="line">             90 LOAD_CONST              31 (36)</span><br><span class="line">             92 LOAD_CONST              32 (52)</span><br><span class="line">             94 LOAD_CONST               1 (5)</span><br><span class="line">             96 LOAD_CONST              33 (21)</span><br><span class="line">             98 LOAD_CONST              34 (37)</span><br><span class="line">            100 LOAD_CONST              35 (53)</span><br><span class="line">            102 LOAD_CONST               2 (6)</span><br><span class="line">            104 LOAD_CONST              36 (22)</span><br><span class="line">            106 LOAD_CONST              37 (38)</span><br><span class="line">            108 LOAD_CONST              38 (54)</span><br><span class="line">            110 LOAD_CONST              13 (7)</span><br><span class="line">            112 LOAD_CONST              39 (23)</span><br><span class="line">            114 LOAD_CONST              40 (39)</span><br><span class="line">            116 LOAD_CONST              41 (55)</span><br><span class="line"></span><br><span class="line">  7         118 LOAD_CONST              11 (8)</span><br><span class="line">            120 LOAD_CONST              42 (24)</span><br><span class="line">            122 LOAD_CONST              43 (40)</span><br><span class="line">            124 LOAD_CONST              44 (56)</span><br><span class="line">            126 LOAD_CONST               4 (9)</span><br><span class="line">            128 LOAD_CONST              45 (25)</span><br><span class="line">            130 LOAD_CONST              46 (41)</span><br><span class="line">            132 LOAD_CONST              47 (57)</span><br><span class="line">            134 LOAD_CONST               6 (10)</span><br><span class="line">            136 LOAD_CONST              48 (26)</span><br><span class="line">            138 LOAD_CONST              49 (42)</span><br><span class="line">            140 LOAD_CONST              50 (58)</span><br><span class="line">            142 LOAD_CONST               3 (11)</span><br><span class="line">            144 LOAD_CONST              51 (27)</span><br><span class="line">            146 LOAD_CONST              52 (43)</span><br><span class="line">            148 LOAD_CONST              53 (59)</span><br><span class="line"></span><br><span class="line">  8         150 LOAD_CONST               0 (12)</span><br><span class="line">            152 LOAD_CONST              54 (28)</span><br><span class="line">            154 LOAD_CONST              55 (44)</span><br><span class="line">            156 LOAD_CONST              56 (60)</span><br><span class="line">            158 LOAD_CONST               7 (13)</span><br><span class="line">            160 LOAD_CONST              57 (29)</span><br><span class="line">            162 LOAD_CONST              58 (45)</span><br><span class="line">            164 LOAD_CONST              59 (61)</span><br><span class="line">            166 LOAD_CONST               9 (14)</span><br><span class="line">            168 LOAD_CONST              60 (30)</span><br><span class="line">            170 LOAD_CONST              61 (46)</span><br><span class="line">            172 LOAD_CONST              62 (62)</span><br><span class="line">            174 LOAD_CONST              10 (15)</span><br><span class="line">            176 LOAD_CONST              63 (31)</span><br><span class="line">            178 LOAD_CONST              64 (47)</span><br><span class="line">            180 LOAD_CONST              65 (63)</span><br><span class="line"></span><br><span class="line">  5         182 BUILD_LIST              64</span><br><span class="line">            184 STORE_NAME               3 (PBox)</span><br><span class="line"></span><br><span class="line">  9         186 LOAD_CONST              66 (&lt;code object &lt;listcomp&gt; at 0x7f7b29a76a80, file &quot;&quot;, line 9&gt;)</span><br><span class="line">            188 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">            190 MAKE_FUNCTION            0</span><br><span class="line">            192 LOAD_NAME                1 (range)</span><br><span class="line">            194 LOAD_CONST              67 (64)</span><br><span class="line">            196 CALL_FUNCTION            1</span><br><span class="line">            198 GET_ITER</span><br><span class="line">            200 CALL_FUNCTION            1</span><br><span class="line">            202 STORE_NAME               4 (PBox_inv)</span><br><span class="line"></span><br><span class="line"> 11         204 LOAD_NAME                5 (marshal)</span><br><span class="line">            206 LOAD_METHOD              6 (loads)</span><br><span class="line">              2           0 LOAD_CONST               0 (&lt;code object addRoundKey at 0x7f5223878a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;addRoundKey&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (addRoundKey)</span><br><span class="line"></span><br><span class="line">  5           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object sBoxLayer at 0x7fab1d117a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;sBoxLayer&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (sBoxLayer)</span><br><span class="line"></span><br><span class="line">  8           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object pLayer at 0x7f023882ba80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;pLayer&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (pLayer)</span><br><span class="line"></span><br><span class="line">  8           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object string2number at 0x7f7370421a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;string2number&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (string2number)</span><br><span class="line"></span><br><span class="line">  5           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object generateRoundkeys80 at 0x7f133db26a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;generateRoundkeys80&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (generateRoundkeys80)</span><br><span class="line"></span><br><span class="line"> 11           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object encrypt at 0x7f57c4c3aa80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;encrypt&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (encrypt)</span><br><span class="line"></span><br><span class="line"> 16           8 LOAD_NAME                1 (input)</span><br><span class="line">             10 LOAD_CONST               2 (&#x27;pls input ur flag:&#x27;)</span><br><span class="line">             12 CALL_FUNCTION            1</span><br><span class="line">             14 STORE_NAME               2 (inp)</span><br><span class="line"></span><br><span class="line"> 17          16 LOAD_NAME                3 (len)</span><br><span class="line">             18 LOAD_NAME                2 (inp)</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 LOAD_CONST               3 (32)</span><br><span class="line">             24 COMPARE_OP               3 (!=)</span><br><span class="line">             26 POP_JUMP_IF_FALSE       44</span><br><span class="line"></span><br><span class="line"> 18          28 LOAD_NAME                4 (print)</span><br><span class="line">             30 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">             32 CALL_FUNCTION            1</span><br><span class="line">             34 POP_TOP</span><br><span class="line"></span><br><span class="line"> 19          36 LOAD_NAME                5 (exit)</span><br><span class="line">             38 LOAD_CONST               5 (0)</span><br><span class="line">             40 CALL_FUNCTION            1</span><br><span class="line">             42 POP_TOP</span><br><span class="line"></span><br><span class="line"> 20     &gt;&gt;   44 LOAD_NAME                2 (inp)</span><br><span class="line">             46 LOAD_CONST               6 (None)</span><br><span class="line">             48 LOAD_CONST               7 (8)</span><br><span class="line">             50 BUILD_SLICE              2</span><br><span class="line">             52 BINARY_SUBSCR</span><br><span class="line">             54 LOAD_NAME                2 (inp)</span><br><span class="line">             56 LOAD_CONST               7 (8)</span><br><span class="line">             58 LOAD_CONST               8 (16)</span><br><span class="line">             60 BUILD_SLICE              2</span><br><span class="line">             62 BINARY_SUBSCR</span><br><span class="line">             64 LOAD_NAME                2 (inp)</span><br><span class="line">             66 LOAD_CONST               8 (16)</span><br><span class="line">             68 LOAD_CONST               9 (24)</span><br><span class="line">             70 BUILD_SLICE              2</span><br><span class="line">             72 BINARY_SUBSCR</span><br><span class="line">             74 LOAD_NAME                2 (inp)</span><br><span class="line">             76 LOAD_CONST               9 (24)</span><br><span class="line">             78 LOAD_CONST               3 (32)</span><br><span class="line">             80 BUILD_SLICE              2</span><br><span class="line">             82 BINARY_SUBSCR</span><br><span class="line">             84 BUILD_LIST               4</span><br><span class="line">             86 STORE_NAME               6 (blocks)</span><br><span class="line"></span><br><span class="line"> 21          88 LOAD_CONST              10 (120617461261311902)</span><br><span class="line">             90 LOAD_CONST              11 (16357837616839286114)</span><br><span class="line">             92 LOAD_CONST              12 (312508749794633008)</span><br><span class="line">             94 LOAD_CONST              13 (1843701600916795272)</span><br><span class="line">             96 BUILD_LIST               4</span><br><span class="line">             98 STORE_NAME               7 (cmps)</span><br><span class="line"></span><br><span class="line"> 22         100 LOAD_NAME                0 (encrypt)</span><br><span class="line">            102 LOAD_NAME                6 (blocks)</span><br><span class="line">            104 CALL_FUNCTION            1</span><br><span class="line">            106 STORE_NAME               8 (out_blocks)</span><br><span class="line"></span><br><span class="line"> 23         108 LOAD_NAME                9 (range)</span><br><span class="line">            110 LOAD_CONST              14 (4)</span><br><span class="line">            112 CALL_FUNCTION            1</span><br><span class="line">            114 GET_ITER</span><br><span class="line">        &gt;&gt;  116 FOR_ITER                36 (to 154)</span><br><span class="line">            118 STORE_NAME              10 (i)</span><br><span class="line"></span><br><span class="line"> 24         120 LOAD_NAME                7 (cmps)</span><br><span class="line">            122 LOAD_NAME               10 (i)</span><br><span class="line">            124 BINARY_SUBSCR</span><br><span class="line">            126 LOAD_NAME                8 (out_blocks)</span><br><span class="line">            128 LOAD_NAME               10 (i)</span><br><span class="line">            130 BINARY_SUBSCR</span><br><span class="line">            132 COMPARE_OP               3 (!=)</span><br><span class="line">            134 POP_JUMP_IF_FALSE      116</span><br><span class="line"></span><br><span class="line"> 25         136 LOAD_NAME                4 (print)</span><br><span class="line">            138 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">            140 CALL_FUNCTION            1</span><br><span class="line">            142 POP_TOP</span><br><span class="line"></span><br><span class="line"> 26         144 LOAD_NAME                5 (exit)</span><br><span class="line">            146 LOAD_CONST               5 (0)</span><br><span class="line">            148 CALL_FUNCTION            1</span><br><span class="line">            150 POP_TOP</span><br><span class="line">            152 JUMP_ABSOLUTE          116</span><br><span class="line"></span><br><span class="line"> 27     &gt;&gt;  154 LOAD_NAME                4 (print)</span><br><span class="line">            156 LOAD_CONST              15 (&#x27;Correct!&#x27;)</span><br><span class="line">            158 CALL_FUNCTION            1</span><br><span class="line">            160 POP_TOP</span><br><span class="line">            162 LOAD_CONST               6 (None)</span><br><span class="line">            164 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object encrypt at 0x7f57c4c3aa80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (32)</span><br><span class="line">              2 STORE_FAST               1 (rounds)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (generateRoundkeys80)</span><br><span class="line">              6 LOAD_CONST               2 (85354531916197809168417)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 CALL_FUNCTION            2</span><br><span class="line">             12 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  5          14 BUILD_LIST               0</span><br><span class="line">             16 STORE_FAST               3 (out)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_FAST                0 (blocks)</span><br><span class="line">             20 GET_ITER</span><br><span class="line">        &gt;&gt;   22 FOR_ITER                84 (to 108)</span><br><span class="line">             24 STORE_FAST               4 (block)</span><br><span class="line"></span><br><span class="line">  7          26 LOAD_GLOBAL              1 (string2number)</span><br><span class="line">             28 LOAD_FAST                4 (block)</span><br><span class="line">             30 CALL_FUNCTION            1</span><br><span class="line">             32 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line">  8          34 LOAD_GLOBAL              2 (range)</span><br><span class="line">             36 LOAD_FAST                1 (rounds)</span><br><span class="line">             38 LOAD_CONST               3 (1)</span><br><span class="line">             40 BINARY_SUBTRACT</span><br><span class="line">             42 CALL_FUNCTION            1</span><br><span class="line">             44 GET_ITER</span><br><span class="line">        &gt;&gt;   46 FOR_ITER                34 (to 82)</span><br><span class="line">             48 STORE_FAST               6 (i)</span><br><span class="line"></span><br><span class="line">  9          50 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             52 LOAD_FAST                5 (state)</span><br><span class="line">             54 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             56 LOAD_FAST                6 (i)</span><br><span class="line">             58 BINARY_SUBSCR</span><br><span class="line">             60 CALL_FUNCTION            2</span><br><span class="line">             62 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 10          64 LOAD_GLOBAL              4 (sBoxLayer)</span><br><span class="line">             66 LOAD_FAST                5 (state)</span><br><span class="line">             68 CALL_FUNCTION            1</span><br><span class="line">             70 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 11          72 LOAD_GLOBAL              5 (pLayer)</span><br><span class="line">             74 LOAD_FAST                5 (state)</span><br><span class="line">             76 CALL_FUNCTION            1</span><br><span class="line">             78 STORE_FAST               5 (state)</span><br><span class="line">             80 JUMP_ABSOLUTE           46</span><br><span class="line"></span><br><span class="line"> 12     &gt;&gt;   82 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             84 LOAD_FAST                5 (state)</span><br><span class="line">             86 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             88 LOAD_CONST               4 (-1)</span><br><span class="line">             90 BINARY_SUBSCR</span><br><span class="line">             92 CALL_FUNCTION            2</span><br><span class="line">             94 STORE_FAST               7 (cipher)</span><br><span class="line"></span><br><span class="line"> 13          96 LOAD_FAST                3 (out)</span><br><span class="line">             98 LOAD_METHOD              6 (append)</span><br><span class="line">            100 LOAD_FAST                7 (cipher)</span><br><span class="line">            102 CALL_METHOD              1</span><br><span class="line">            104 POP_TOP</span><br><span class="line">            106 JUMP_ABSOLUTE           22</span><br><span class="line"></span><br><span class="line"> 14     &gt;&gt;  108 LOAD_FAST                3 (out)</span><br><span class="line">            110 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line"> 12          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object generateRoundkeys80 at 0x7f133db26a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 BUILD_LIST               0</span><br><span class="line">              2 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               1 (1)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 LOAD_CONST               1 (1)</span><br><span class="line">             12 BINARY_ADD</span><br><span class="line">             14 LOAD_CONST               1 (1)</span><br><span class="line">             16 CALL_FUNCTION            3</span><br><span class="line">             18 GET_ITER</span><br><span class="line">        &gt;&gt;   20 FOR_ITER                90 (to 112)</span><br><span class="line">             22 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line">  5          24 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             26 LOAD_METHOD              1 (append)</span><br><span class="line">             28 LOAD_FAST                0 (key)</span><br><span class="line">             30 LOAD_CONST               2 (16)</span><br><span class="line">             32 BINARY_RSHIFT</span><br><span class="line">             34 CALL_METHOD              1</span><br><span class="line">             36 POP_TOP</span><br><span class="line"></span><br><span class="line">  6          38 LOAD_FAST                0 (key)</span><br><span class="line">             40 LOAD_CONST               3 (524287)</span><br><span class="line">             42 BINARY_AND</span><br><span class="line">             44 LOAD_CONST               4 (61)</span><br><span class="line">             46 BINARY_LSHIFT</span><br><span class="line">             48 LOAD_FAST                0 (key)</span><br><span class="line">             50 LOAD_CONST               5 (19)</span><br><span class="line">             52 BINARY_RSHIFT</span><br><span class="line">             54 BINARY_ADD</span><br><span class="line">             56 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  7          58 LOAD_GLOBAL              2 (Sbox)</span><br><span class="line">             60 LOAD_FAST                0 (key)</span><br><span class="line">             62 LOAD_CONST               6 (76)</span><br><span class="line">             64 BINARY_RSHIFT</span><br><span class="line">             66 BINARY_SUBSCR</span><br><span class="line">             68 LOAD_CONST               6 (76)</span><br><span class="line">             70 BINARY_LSHIFT</span><br><span class="line">             72 LOAD_FAST                0 (key)</span><br><span class="line">             74 LOAD_CONST               7 (2)</span><br><span class="line">             76 LOAD_CONST               6 (76)</span><br><span class="line">             78 BINARY_POWER</span><br><span class="line">             80 LOAD_CONST               1 (1)</span><br><span class="line">             82 BINARY_SUBTRACT</span><br><span class="line">             84 BINARY_AND</span><br><span class="line">             86 BINARY_ADD</span><br><span class="line">             88 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  8          90 LOAD_FAST                0 (key)</span><br><span class="line">             92 LOAD_FAST                3 (i)</span><br><span class="line">             94 LOAD_CONST               8 (15)</span><br><span class="line">             96 BINARY_LSHIFT</span><br><span class="line">             98 LOAD_FAST                0 (key)</span><br><span class="line">            100 LOAD_CONST               5 (19)</span><br><span class="line">            102 BINARY_RSHIFT</span><br><span class="line">            104 BINARY_XOR</span><br><span class="line">            106 INPLACE_XOR</span><br><span class="line">            108 STORE_FAST               0 (key)</span><br><span class="line">            110 JUMP_ABSOLUTE           20</span><br><span class="line"></span><br><span class="line">  9     &gt;&gt;  112 LOAD_FAST                2 (roundkeys)</span><br><span class="line">            114 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object string2number at 0x7f7370421a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_GLOBAL              0 (sum)</span><br><span class="line">              2 LOAD_CLOSURE             0 (i)</span><br><span class="line">              4 BUILD_TUPLE              1</span><br><span class="line">              6 LOAD_CONST               1 (&lt;code object &lt;listcomp&gt; at 0x7f73704aba80, file &quot;&quot;, line 3&gt;)</span><br><span class="line">              8 LOAD_CONST               2 (&#x27;string2number.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)</span><br><span class="line">             10 MAKE_FUNCTION            8 (closure)</span><br><span class="line">             12 LOAD_GLOBAL              1 (range)</span><br><span class="line">             14 LOAD_CONST               3 (8)</span><br><span class="line">             16 CALL_FUNCTION            1</span><br><span class="line">             18 GET_ITER</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f73704aba80, file &quot;&quot;, line 3&gt;:</span><br><span class="line">  3           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                24 (to 30)</span><br><span class="line">              6 STORE_FAST               1 (c)</span><br><span class="line">              8 LOAD_GLOBAL              0 (ord)</span><br><span class="line">             10 LOAD_DEREF               0 (i)</span><br><span class="line">             12 LOAD_FAST                1 (c)</span><br><span class="line">             14 BINARY_SUBSCR</span><br><span class="line">             16 CALL_FUNCTION            1</span><br><span class="line">             18 LOAD_CONST               0 (8)</span><br><span class="line">             20 LOAD_FAST                1 (c)</span><br><span class="line">             22 BINARY_MULTIPLY</span><br><span class="line">             24 BINARY_LSHIFT</span><br><span class="line">             26 LIST_APPEND              2</span><br><span class="line">             28 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   30 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  9          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object pLayer at 0x7f023882ba80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (0)</span><br><span class="line">              2 STORE_FAST               1 (output)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               2 (64)</span><br><span class="line">              8 CALL_FUNCTION            1</span><br><span class="line">             10 GET_ITER</span><br><span class="line">        &gt;&gt;   12 FOR_ITER                28 (to 42)</span><br><span class="line">             14 STORE_FAST               2 (i)</span><br><span class="line"></span><br><span class="line">  5          16 LOAD_FAST                1 (output)</span><br><span class="line">             18 LOAD_FAST                0 (state)</span><br><span class="line">             20 LOAD_FAST                2 (i)</span><br><span class="line">             22 BINARY_RSHIFT</span><br><span class="line">             24 LOAD_CONST               3 (1)</span><br><span class="line">             26 BINARY_AND</span><br><span class="line">             28 LOAD_GLOBAL              1 (PBox)</span><br><span class="line">             30 LOAD_FAST                2 (i)</span><br><span class="line">             32 BINARY_SUBSCR</span><br><span class="line">             34 BINARY_LSHIFT</span><br><span class="line">             36 INPLACE_ADD</span><br><span class="line">             38 STORE_FAST               1 (output)</span><br><span class="line">             40 JUMP_ABSOLUTE           12</span><br><span class="line"></span><br><span class="line">  6     &gt;&gt;   42 LOAD_FAST                1 (output)</span><br><span class="line">             44 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  9          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object sBoxLayer at 0x7fab1d117a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (0)</span><br><span class="line">              2 STORE_FAST               1 (output)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               2 (16)</span><br><span class="line">              8 CALL_FUNCTION            1</span><br><span class="line">             10 GET_ITER</span><br><span class="line">        &gt;&gt;   12 FOR_ITER                36 (to 50)</span><br><span class="line">             14 STORE_FAST               2 (i)</span><br><span class="line"></span><br><span class="line">  5          16 LOAD_FAST                1 (output)</span><br><span class="line">             18 LOAD_GLOBAL              1 (Sbox)</span><br><span class="line">             20 LOAD_FAST                0 (state)</span><br><span class="line">             22 LOAD_FAST                2 (i)</span><br><span class="line">             24 LOAD_CONST               3 (4)</span><br><span class="line">             26 BINARY_MULTIPLY</span><br><span class="line">             28 BINARY_RSHIFT</span><br><span class="line">             30 LOAD_CONST               4 (15)</span><br><span class="line">             32 BINARY_AND</span><br><span class="line">             34 BINARY_SUBSCR</span><br><span class="line">             36 LOAD_FAST                2 (i)</span><br><span class="line">             38 LOAD_CONST               3 (4)</span><br><span class="line">             40 BINARY_MULTIPLY</span><br><span class="line">             42 BINARY_LSHIFT</span><br><span class="line">             44 INPLACE_ADD</span><br><span class="line">             46 STORE_FAST               1 (output)</span><br><span class="line">             48 JUMP_ABSOLUTE           12</span><br><span class="line"></span><br><span class="line">  6     &gt;&gt;   50 LOAD_FAST                1 (output)</span><br><span class="line">             52 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object addRoundKey at 0x7f5223878a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_FAST                0 (state)</span><br><span class="line">              2 LOAD_FAST                1 (roundkey)</span><br><span class="line">              4 BINARY_XOR</span><br><span class="line">              6 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            210 CALL_METHOD              1</span><br><span class="line">            212 STORE_NAME               7 (co)</span><br><span class="line"></span><br><span class="line"> 12         214 LOAD_NAME                8 (exec)</span><br><span class="line">            216 LOAD_NAME                7 (co)</span><br><span class="line">            218 CALL_FUNCTION            1</span><br><span class="line">            220 POP_TOP</span><br><span class="line">            222 LOAD_CONST              69 (None)</span><br><span class="line">            224 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f7b29b00a80, file &quot;&quot;, line 4&gt;:</span><br><span class="line">  4           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (Sbox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f7b29a76a80, file &quot;&quot;, line 9&gt;:</span><br><span class="line">  9           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (PBox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>
]]></content>
      <categories>
        <category>CTF-WP</category>
      </categories>
  </entry>
  <entry>
    <title>12.3 KasakiNozomi&#39;s Birthday!</title>
    <url>/2023/12/02/12-3-KasakiNozomi-s-Birthday/</url>
    <content><![CDATA[<p><strong>ä»Šå¤©æ˜¯ä¼å“¥å“¥çš„ç”Ÿæ—¥å•Šï¼</strong></p>
<span id="more"></span>
<p><img src="https://s2.loli.net/2023/12/03/uknXZsdHrz42wPN.jpg" alt="3092507-20230224232909457-349401112.jpg"></p>
<p>æˆ‘æœ€æœ€æœ€æœ€æœ€æœ€æœ€å–œæ¬¢çš„è§’è‰²å•Šï¼ï¼ï¼<br>æ„Ÿè°¢äº¬é˜¿å°¼ æ„Ÿè°¢äº¬å¹ æ„Ÿè°¢åˆ©å…¹ä¸é’é¸Ÿ~<br>è¿™ä¹Ÿå·®ä¸å¤šæ˜¯å…¥å‘äºŒæ¬¡å…ƒä¸€å¹´å§~ è¿™ä¸€å¹´æ¥ä¹Ÿæ”¹å˜äº†è®¸è®¸å¤šå¤š~<br>å€Ÿéœ™çš„è¯å§~<br>å–œæ¬¢å¸Œç¾çš„ç¬‘å£°        å–œæ¬¢å¸Œç¾çš„ä¸€è¨€ä¸€è¯­<br>å–œæ¬¢å¸Œç¾çš„è„šæ­¥å£°      å–œæ¬¢å¸Œç¾çš„å¤´å‘<br>å–œæ¬¢â€¦â€¦<br>å¸Œç¾çš„ä¸€åˆ‡~<br>ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚</p>
]]></content>
  </entry>
</search>
